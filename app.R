# app.R
library(shiny)
library(ggplot2)
library(dplyr)
library(bslib)
library(gridExtra)
library(moments)
library(car)  # ุจุฑุง ุขุฒููู ููู ู ANOVA
library(userfriendlyscience)  # ุจุฑุง ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
library(MASS)  # ุจุฑุง ุฑฺฏุฑุณูู
library(broom)  # ุจุฑุง ุฒุจุง ฺฉุฑุฏู ุฎุฑูุฌ ุฑฺฏุฑุณูู
library(survival)
library(survminer)

# ุชุนุฑู UI ุจุง ุชุฑุงุฒ ุฑุงุณุช ุจุฑุง ุชูุงู ุจุฎุดโูุง
ui <- fluidPage(
  theme = bs_theme(version = 5, bootswatch = "flatly"),
  tags$head(
    tags$style(HTML("
      /* ุงุณุชุงูโูุง ูุจู */
      .rtl-text {
        text-align: right;
        direction: rtl;
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
      .rtl-list {
        text-align: right;
        direction: rtl;
      }
      .farsi-font {
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
      .table-rtl {
        text-align: right;
        direction: rtl;
      }
      .center-content {
        text-align: center;
      }
      .rtl-input {
        text-align: right;
        direction: rtl;
      }
      .sticky-header {
        position: sticky;
        top: 0;
        background-color: white;
        z-index: 100;
        padding: 10px;
        border-bottom: 2px solid #007bff;
        margin-bottom: 15px;
      }
      .highlight-box {
        background-color: #f8f9fa;
        border-right: 4px solid #007bff;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .warning-box {
        background-color: #fff3cd;
        border-right: 4px solid #ffc107;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .success-box {
        background-color: #d1edff;
        border-right: 4px solid #0dcaf0;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .info-box {
        background-color: #f8f9fa;
        border-right: 4px solid #17a2b8;
        padding: 12px;
        margin: 8px 0;
        border-radius: 5px;
        font-size: 14px;
      }
      
      /* ุงุณุชุงูโูุง ุฌุฏุฏ ุจุฑุง ููุฑุณุช ุฒุจุงุชุฑ */
      .sidebar-custom {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        padding: 15px;
        margin: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }
      
      .nav-custom .nav-link {
        color: #333 !important;
        border-radius: 8px;
        margin: 5px 0;
        transition: all 0.3s ease;
        border-right: 3px solid transparent;
        text-align: right;
        direction: rtl;
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
      
      .nav-custom .nav-link:hover {
        background-color: #e3f2fd;
        border-right: 3px solid #007bff;
        transform: translateX(-5px);
      }
      
      .nav-custom .nav-link.active {
        background-color: #007bff !important;
        color: white !important;
        border-right: 3px solid #0056b3;
        font-weight: bold;
      }
      
      .section-header {
        background: linear-gradient(45deg, #007bff, #0056b3);
        color: white;
        padding: 10px 15px;
        border-radius: 8px;
        margin: 15px 0;
        text-align: center;
        font-weight: bold;
        font-size: 16px;
      }
      
      .logo-container {
        text-align: center;
        padding: 20px 10px;
        background: white;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      
      .logo-text {
        font-size: 24px;
        font-weight: bold;
        color: #007bff;
        margin-bottom: 5px;
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
      
      .logo-subtext {
        font-size: 14px;
        color: #6c757d;
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
      
      .nav-icon {
        margin-left: 8px;
        font-size: 16px;
      }
      
      .header-title {
        font-size: 28px;
        font-weight: bold;
        color: #007bff;
        text-align: right;
        padding: 15px 0;
        font-family: 'Tahoma', 'Arial', sans-serif;
      }
    "))
  ),
  
  # ูุฏุฑ ุจุง ููฺฏู - ูุณุฎู ุณุงุฏูโุชุฑ
  div(class = "sticky-header",
      fluidRow(
        column(2,
               div(class = "logo-container",
                   div(class = "logo-text", "๐ ุขูุงุฑูพุฒุดฺฉ")
                   # ุฒุฑููุณ ุญุฐู ุดุฏู ุงุณุช
               )
        ),
        column(10,
               div(class = "header-title", 
                   "ุขููุฒุด ุขูุงุฑ ููุฏูุงุช ุจุฑุง ุฏุงูุดุฌูุงู ูพุฒุดฺฉ")
        )
      )
  ),
  
  sidebarLayout(
    sidebarPanel(
      width = 3,
      class = "sidebar-custom",
      
      # ููุฑุณุช ุณุฑูุตูโูุง ุจูุจูุฏ ุงูุชู
      div(class = "nav-custom",
          h4("๐ฏ ููุฑุณุช ุณุฑูุตูโูุง", style = "color: white; text-align: center;"),
          
          # ุจุฎุด ูุจุงุญุซ ุขูุงุฑ
          div(class = "section-header", "๐ ูุจุงุญุซ ุขูุงุฑ"),
          navlistPanel(
            id = "tabs",
            widths = c(12, 12),
            "",
            tabPanel("๐ ููุฏูู ู ุงููุช ุขูุงุฑ", 
                     value = "intro",
                     icon = icon("home")),
            tabPanel("๐ข ุงููุงุน ูุชุบุฑูุง ู ูููููโฺฏุฑ", 
                     value = "variables",
                     icon = icon("chart-bar")),
            tabPanel("๐ ุขูุงุฑ ุชูุตู", 
                     value = "descriptive",
                     icon = icon("chart-line")),
            tabPanel("๐ ุชูุฒุนโูุง ุขูุงุฑ", 
                     value = "distributions",
                     icon = icon("bell")),
            tabPanel("๐ฏ ุขุฒููู ูุฑุถ ู ูุงุตูู ุงุทููุงู", 
                     value = "tests_ci",
                     icon = icon("check-circle")),
            tabPanel("๐ ุขุฒูููโูุง ฺฉ ู ุฏู ฺฏุฑูู", 
                     value = "statistical_tests",
                     icon = icon("vial")),
            tabPanel("๐ฅ ุขุฒูููโูุง ฺูุฏ ฺฏุฑูู ูุณุชูู", 
                     value = "multiple_groups",
                     icon = icon("users")),
            tabPanel("๐ ุขุฒูููโูุง ูุชุบุฑูุง ฺฉู", 
                     value = "categorical_tests",
                     icon = icon("list-alt")),
            tabPanel("๐ ุขูุงูุฒ ฺฉููุงุฑุงูุณ (ANCOVA)", 
                     value = "ancova",
                     icon = icon("sliders-h")),
            tabPanel("๐ ููุงุณู ฺฏุฑููโูุง ูุงุจุณุชู", 
                     value = "repeated_measures",
                     icon = icon("sync")),
            tabPanel("๐ ููุจุณุชฺฏ", 
                     value = "correlation",
                     icon = icon("link")),
            tabPanel("๐ ุฑฺฏุฑุณูู ุฎุท", 
                     value = "linear_regression",
                     icon = icon("line-chart")),
            tabPanel("๐ฒ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ", 
                     value = "logistic_regression",
                     icon = icon("project-diagram")),
            tabPanel("๐ข ุฑฺฏุฑุณูู ุดูุงุฑุด", 
                     value = "count_regression",
                     icon = icon("calculator")),
            tabPanel("โฑ๏ธ ุชุญูู ุจูุง", 
                     value = "survival_analysis",
                     icon = icon("heartbeat")),
            tabPanel("๐ก ูฺฉุงุช ฺฉุงุฑุจุฑุฏ", 
                     value = "tips",
                     icon = icon("lightbulb"))
          ),
          
          # ุจุฎุด ุงุจุฒุงุฑูุง
          div(class = "section-header", "๐๏ธ ุงุจุฒุงุฑูุง ุชุนุงูู"),
          navlistPanel(
            id = "tools_tabs",
            widths = c(12, 12),
            "",
            tabPanel("๐ฒ ุดุจูโุณุงุฒ ุชูุฒุน ูุฑูุงู", 
                     value = "normal_sim",
                     icon = icon("dice")),
            tabPanel("๐งฎ ูุงุดูโุญุณุงุจ t-test", 
                     value = "ttest_calc",
                     icon = icon("calculator")),
            tabPanel("๐ ุดุจูโุณุงุฒ ูุงุตูู ุงุทููุงู", 
                     value = "ci_sim",
                     icon = icon("ruler")),
            tabPanel("๐ ุดุจูโุณุงุฒ ANOVA", 
                     value = "anova_sim",
                     icon = icon("chart-bar")),
            tabPanel("๐ข ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู", 
                     value = "regression_sim",
                     icon = icon("line-chart"))
          )
      )
    ),
    
    mainPanel(
      width = 9,
      uiOutput("main_content")
    )
  )
)


# ุชุนุฑู ุณุฑูุฑ
server <- function(input, output, session) {
  
  output$main_content <- renderUI({
    selected_tab <- input$tabs
    
    switch(selected_tab,
           
           "intro" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ููุฏูู ู ุงููุช ุขูุงุฑ ุฏุฑ ูพุฒุดฺฉ"),
                 p("ุขูุงุฑ (Statistics) ุนูู ุฌูุนโุขูุฑุ ุชุญููุ ุชูุณุฑ ู ุงุฑุงุฆู ุฏุงุฏูโูุง ุงุณุช. ุฏุฑ ูพุฒุดฺฉ ูุฏุฑูุ ูฺ ุชุตูู ุจุฏูู ูพุดุชูุงูู ุขูุงุฑ ฺฏุฑูุชู ููโุดูุฏ."),
                 h3("ุชุนุฑู ุขูุงุฑ"),
                 p("ุขูุงุฑ ุฑุง ูโุชูุงู ุจู ุฏู ุจุฎุด ุงุตู ุชูุณู ฺฉุฑุฏ:"),
                 tags$ul(
                   tags$li(tags$b("ุขูุงุฑ ุชูุตู (Descriptive Statistics):"), "ุฎูุงุตูโุณุงุฒ ู ููุงุด ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูููุฏุงุฑูุง ู ุดุงุฎุตโูุง."),
                   tags$li(tags$b("ุขูุงุฑ ุงุณุชูุจุงุท (Inferential Statistics):"), "ุงุณุชูุงุฏู ุงุฒ ูููููโูุง ุจุฑุง ูุชุฌูโฺฏุฑ ุฏุฑุจุงุฑู ุฌุงูุนู ุจุฒุฑฺฏุชุฑ.")
                 ),
                 h3("ฺฉุงุฑุจุฑุฏูุง ุขูุงุฑ ุฏุฑ ูุทุงูุนุงุช ุจุงูู ู ุชุญููุงุช ูพุฒุดฺฉ"),
                 tags$ul(
                   tags$li("ุชุนู ุงุซุฑุจุฎุด ุฏุงุฑููุง ุฌุฏุฏ (ฺฉุงุฑุขุฒูุงโูุง ุจุงูู)"),
                   tags$li("ุจุฑุฑุณ ุดูุน ุจูุงุฑโูุง ุฏุฑ ุฌูุนุชโูุง ูุฎุชูู"),
                   tags$li("ุดูุงุณุง ุนูุงูู ุฎุทุฑ (Risk Factors) ุจุฑุง ุจูุงุฑโูุง"),
                   tags$li("ุงุฑุฒุงุจ ุฏูุช ุชุณุชโูุง ุชุดุฎุต (ุญุณุงุณุช ู ูฺฺฏ)"),
                   tags$li("ุชุนู ูพุฑูุชฺฉูโูุง ุฏุฑูุงู ุจุฑ ุงุณุงุณ ุดูุงูุฏ"),
                   tags$li("ูพุงุด ฺฉูุช ุฎุฏูุงุช ุณูุงูุช"),
                   tags$li("ุชุญูู ูุฒูู-ุงุซุฑุจุฎุด ูุฏุงุฎูุงุช ุฏุฑูุงู")
                 )
             )
           ),
           
           "variables" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุงููุงุน ูุชุบุฑูุง ู ูููููโฺฏุฑ"),
                 
                 h3("๐๏ธ ููุงูู ูพุงู: ุฌุงูุนู ู ููููู"),
                 div(class = "highlight-box",
                     h4("ุฌุงูุนู (Population)"),
                     p("ุฌุงูุนู ุจู ฺฉู ูุฌููุนู ุงูุฑุงุฏุ ุงุดุงุก ุง ุฑูุฏุงุฏูุง ฺฏูุชู ูโุดูุฏ ฺฉู ูโุฎูุงูู ุฏุฑุจุงุฑู ุขููุง ูุทุงูุนู ฺฉูู."),
                     tags$ul(
                       tags$li(tags$b("ุฌุงูุนู ูุฏู (Target Population):"), "ุฌุงูุนูโุง ฺฉู ูโุฎูุงูู ูุชุงุฌ ูุทุงูุนู ุฑุง ุจู ุขู ุชุนูู ุฏูู"),
                       tags$li(tags$b("ุฌุงูุนู ุฏุฑ ุฏุณุชุฑุณ (Accessible Population):"), "ุจุฎุด ุงุฒ ุฌุงูุนู ฺฉู ูุงูุนุงู ูโุชูุงูู ุจู ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ุชูุงู ุจูุงุฑุงู ุฏุงุจุช ุฏุฑ ุงุฑุงู"),
                                 tags$li("ููู ุฒูุงู ุจุงุฑุฏุงุฑ ุฏุฑ ฺฉ ุงุณุชุงู"),
                                 tags$li("ุชูุงู ูพุฑููุฏูโูุง ูพุฒุดฺฉ ฺฉ ุจูุงุฑุณุชุงู ุฏุฑ ต ุณุงู ฺฏุฐุดุชู")
                               )
                       )
                     )
                 ),
                 
                 div(class = "success-box",
                     h4("ููููู (Sample)"),
                     p("ููููู ุฒุฑูุฌููุนูโุง ุงุฒ ุฌุงูุนู ุงุณุช ฺฉู ุจุฑุง ูุทุงูุนู ุงูุชุฎุงุจ ูโุดูุฏ."),
                     tags$ul(
                       tags$li(tags$b("ููููู ููุงูุฏู (Representative Sample):"), "ูููููโุง ฺฉู ูฺฺฏโูุง ุฌุงูุนู ุฑุง ุจู ุฎูุจ ููุนฺฉุณ ฺฉูุฏ"),
                       tags$li(tags$b("ุญุฌู ููููู (Sample Size):"), "ุชุนุฏุงุฏ ุงุนุถุง ููููู"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ฒฐฐ ุจูุงุฑ ุฏุงุจุช ุงุฒ ต ุจูุงุฑุณุชุงู ูุฎุชูู"),
                                 tags$li("ตฐ ุฒู ุจุงุฑุฏุงุฑ ุงุฒ ูุฑุงฺฉุฒ ุจูุฏุงุดุช ฺฉ ุดูุฑ"),
                                 tags$li("ฑฐฐ ูพุฑููุฏู ูพุฒุดฺฉ ุจู ุตูุฑุช ุชุตุงุฏู ุงูุชุฎุงุจ ุดุฏู")
                               )
                       )
                     )
                 ),
                 
                 div(class = "warning-box",
                     h4("ุณุฑุดูุงุฑ (Census) ุฏุฑ ููุงุจู ูููููโฺฏุฑ"),
                     fluidRow(
                       column(6,
                              h5("๐ฏ ุณุฑุดูุงุฑ (Census)"),
                              tags$ul(
                                tags$li("ูุทุงูุนู ุชูุงู ุงุนุถุง ุฌุงูุนู"),
                                tags$li(tags$b("ูุฒุงุง:"),
                                        tags$ul(
                                          tags$li("ุฏูุช ุจุณุงุฑ ุจุงูุง"),
                                          tags$li("ุจุฏูู ุฎุทุง ูููููโฺฏุฑ")
                                        )),
                                tags$li(tags$b("ูุนุงุจ:"),
                                        tags$ul(
                                          tags$li("ูุฒูู ู ุฒูุงู ุฒุงุฏ"),
                                          tags$li("ุงูฺฉุงูโูพุฐุฑ ูุจูุฏู ุจุฑุง ุฌุงูุนูโูุง ุจุณุงุฑ ุจุฒุฑฺฏ"),
                                          tags$li("ูุซุงู: ุณุฑุดูุงุฑ ูู ูุฑ ฑฐ ุณุงู ฺฉุจุงุฑ")
                                        ))
                              )
                       ),
                       column(6,
                              h5("๐ ูููููโฺฏุฑ (Sampling)"),
                              tags$ul(
                                tags$li("ูุทุงูุนู ุจุฎุด ุงุฒ ุฌุงูุนู"),
                                tags$li(tags$b("ูุฒุงุง:"),
                                        tags$ul(
                                          tags$li("ุตุฑููโุฌู ุฏุฑ ูุฒูู ู ุฒูุงู"),
                                          tags$li("ุงูฺฉุงู ูุทุงูุนู ุฌุงูุนูโูุง ุจุฒุฑฺฏ"),
                                          tags$li("ุฏูุช ฺฉุงู ุจุง ุฑูุดโูุง ุตุญุญ")
                                        )),
                                tags$li(tags$b("ูุนุงุจ:"),
                                        tags$ul(
                                          tags$li("ุฎุทุง ูููููโฺฏุฑ"),
                                          tags$li("ูุงุฒ ุจู ุฑูุดโูุง ุฏูู ุจุฑุง ููุงุง ุจูุฏู")
                                        ))
                              )
                       )
                     )
                 ),
                 
                 h3("๐ ุงููุงุน ูุชุบุฑูุง (Variables)"),
                 tableOutput("variables_table"),
                 
                 h3("๐ฏ ุฏุณุชูโุจูุฏ ูุชุบุฑูุง"),
                 fluidRow(
                   column(4,
                          h4("ูุชุบุฑูุง ฺฉู (Qualitative)"),
                          tags$ul(
                            tags$li(tags$b("ุงุณู (Nominal):"), "ุจุฏูู ุชุฑุชุจ ุทุจุน - ูุซุงู: ฺฏุฑูู ุฎููุ ุฌูุณุช"),
                            tags$li(tags$b("ุชุฑุชุจ (Ordinal):"), "ุจุง ุชุฑุชุจ ุทุจุน - ูุซุงู: ุฏุฑุฌู ุณุฑุทุงูุ ุณุทุญ ุฏุฑุฏ")
                          )
                   ),
                   column(4,
                          h4("ูุชุบุฑูุง ฺฉู ูุงุตููโุง (Interval)"),
                          tags$ul(
                            tags$li("ููุงุฏุฑ ุนุฏุฏ ุจุง ูุงุตููโูุง ูุนูโุฏุงุฑ"),
                            tags$li("ุตูุฑ ูุงูุน ูุฏุงุฑุฏ"),
                            tags$li(tags$b("ูุซุงู:"), "ุฏูุง ุณุงูุชฺฏุฑุงุฏุ ููุฑู IQ")
                          )
                   ),
                   column(4,
                          h4("ูุชุบุฑูุง ฺฉู ูุณุจ (Ratio)"),
                          tags$ul(
                            tags$li("ููุงุฏุฑ ุนุฏุฏ ุจุง ุตูุฑ ูุทูู"),
                            tags$li("ูุณุจุชโูุง ูุนูโุฏุงุฑ ูุณุชูุฏ"),
                            tags$li(tags$b("ูุซุงู:"), "ูุฏุ ูุฒูุ ูุดุงุฑ ุฎูู")
                          )
                   )
                 ),
                 
                 h3("๐ ูุซุงูโูุง ูพุฒุดฺฉ"),
                 fluidRow(
                   column(3,
                          h5("ูุชุบุฑูุง ฺฉู ุงุณู"),
                          tags$ul(
                            tags$li("ฺฏุฑูู ุฎูู"),
                            tags$li("ุฌูุณุช"),
                            tags$li("ููุน ุจูุงุฑ")
                          )
                   ),
                   column(3,
                          h5("ูุชุบุฑูุง ฺฉู ุชุฑุชุจ"),
                          tags$ul(
                            tags$li("ุฏุฑุฌู ุณุฑุทุงู"),
                            tags$li("ุณุทุญ ุฏุฑุฏ"),
                            tags$li("ุฑุถุงุช ุจูุงุฑ")
                          )
                   ),
                   column(3,
                          h5("ูุชุบุฑูุง ฺฉู ูุงุตููโุง"),
                          tags$ul(
                            tags$li("ููุฑู ุขูพฺฏุงุฑ"),
                            tags$li("ุงูุชุงุฒ ฺฉูุช ุฒูุฏฺฏ"),
                            tags$li("ุฏูุง ุจุฏู")
                          )
                   ),
                   column(3,
                          h5("ูุชุบุฑูุง ฺฉู ูุณุจ"),
                          tags$ul(
                            tags$li("ุณู ุจูุงุฑ"),
                            tags$li("ูุดุงุฑ ุฎูู"),
                            tags$li("ุณุทุญ ููุฏ ุฎูู")
                          )
                   )
                 ),
                 
                 h3("๐ ุฑูุดโูุง ูููููโฺฏุฑ (Sampling Methods)"),
                 div(class = "highlight-box",
                     h4("ูููููโฺฏุฑ ุงุญุชูุงู (Probability Sampling)"),
                     tags$ul(
                       tags$li(tags$b("ุชุตุงุฏู ุณุงุฏู (Simple Random):"), "ูุฑ ุนุถู ุฌุงูุนู ุดุงูุณ ุจุฑุงุจุฑ ุจุฑุง ุงูุชุฎุงุจ ุฏุงุฑุฏ"),
                       tags$li(tags$b("ุทุจููโุง (Stratified):"), "ุฌุงูุนู ุจู ุทุจูุงุช ุชูุณู ู ุงุฒ ูุฑ ุทุจูู ููููู ฺฏุฑูุชู ูโุดูุฏ"),
                       tags$li(tags$b("ุฎูุดูโุง (Cluster):"), "ุฎูุดูโูุง ุงูุชุฎุงุจ ู ุชูุงู ุงุนุถุง ุฎูุดู ุจุฑุฑุณ ูโุดููุฏ"),
                       tags$li(tags$b("ุณุณุชูุงุชฺฉ (Systematic):"), "ุงูุชุฎุงุจ ูููููโูุง ุจุง ูุงุตูู ูุนู ุงุฒ ูุณุช")
                     ),
                     p(tags$b("โ ูุฒุช:"), "ุงูฺฉุงู ุชุนูู ูุชุงุฌ ุจู ุฌุงูุนู ุงุตู")
                 ),
                 
                 div(class = "warning-box",
                     h4("ูููููโฺฏุฑ ุบุฑุงุญุชูุงู (Non-Probability Sampling)"),
                     tags$ul(
                       tags$li(tags$b("ุฏุฑ ุฏุณุชุฑุณ (Convenience):"), "ูููููโูุง ุฏุฑ ุฏุณุชุฑุณ ุงูุชุฎุงุจ ูโุดููุฏ"),
                       tags$li(tags$b("ูุฏูููุฏ (Purposive):"), "ูููููโูุง ุจุง ูฺฺฏโูุง ุฎุงุต ุงูุชุฎุงุจ ูโุดููุฏ"),
                       tags$li(tags$b("ฺฏูููู ุจุฑู (Snowball):"), "ุงุฒ ุทุฑู ูุนุฑู ูููููโูุง ููุฌูุฏ")
                     ),
                     p(tags$b("โ๏ธ ูุดุฏุงุฑ:"), "ูููููโฺฏุฑ ุบุฑุงุญุชูุงู ููฺฉู ุงุณุช ุจุงุนุซ ุณูฺฏุฑ (Bias) ุดูุฏ"),
                     p(tags$b("๐ฏ ฺฉุงุฑุจุฑุฏ:"), "ูุทุงูุนุงุช ฺฉูุ ูพฺููุดโูุง ููุฏูุงุช")
                 ),
                 
                 h3("๐ ูุซุงู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 div(class = "info-box",
                     h4("ูุทุงูุนู ุดูุน ูุดุงุฑ ุฎูู ุฏุฑ ุชูุฑุงู"),
                     tags$ul(
                       tags$li(tags$b("ุฌุงูุนู ูุฏู:"), "ุชูุงู ุณุงฺฉูู ุจุงูุง ฑธ ุณุงู ุชูุฑุงู"),
                       tags$li(tags$b("ุฌุงูุนู ุฏุฑ ุฏุณุชุฑุณ:"), "ูุฑุงุฌุนูโฺฉููุฏฺฏุงู ุจู ูุฑุงฺฉุฒ ุจูุฏุงุดุช ุฏุฑูุงู ุชูุฑุงู"),
                       tags$li(tags$b("ุฑูุด ูููููโฺฏุฑ:"), "ูููููโฺฏุฑ ุฎูุดูโุง ุชุตุงุฏู"),
                       tags$li(tags$b("ุญุฌู ููููู:"), "ฒฐฐฐ ููุฑ"),
                       tags$li(tags$b("ูุชุบุฑูุง:"),
                               tags$ul(
                                 tags$li("ูุดุงุฑ ุฎูู (ฺฉู ูุณุจ)"),
                                 tags$li("ุณู (ฺฉู ูุณุจ)"),
                                 tags$li("ุฌูุณุช (ฺฉู ุงุณู)"),
                                 tags$li("ุณุงุจูู ุฎุงููุงุฏฺฏ (ฺฉู ุงุณู)")
                               )
                       )
                     )
                 )
             )
           ),
           
           "descriptive" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขูุงุฑ ุชูุตู (Descriptive Statistics)"),
                 
                 h3("๐ ููุฏูู ุขูุงุฑ ุชูุตู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุขูุงุฑ ุชูุตู"),
                     p("ุขูุงุฑ ุชูุตู ุจู ูุฌููุนู ุฑูุดโูุง ฺฏูุชู ูโุดูุฏ ฺฉู ุจุฑุง ุฎูุงุตูโุณุงุฒุ ุณุงุฒูุงูุฏู ู ููุงุด ุฏุงุฏูโูุง ุจู ฺฉุงุฑ ูโุฑููุฏ. ูุฏู ุงุตู ุขูุงุฑ ุชูุตูุ ุชูุตู ูฺฺฏโูุง ุงุตู ุฏุงุฏูโูุง ุจู ุตูุฑุช ุฑูุดู ู ูุนูุงุฏุงุฑ ุงุณุช."),
                     tags$ul(
                       tags$li(tags$b("ุฎูุงุตูโุณุงุฒ ุฏุงุฏูโูุง:"), "ุงุณุชูุงุฏู ุงุฒ ุดุงุฎุตโูุง ูุฑฺฉุฒ ู ูพุฑุงฺฉูุฏฺฏ"),
                       tags$li(tags$b("ููุงุด ุฏุงุฏูโูุง:"), "ุงุณุชูุงุฏู ุงุฒ ูููุฏุงุฑูุง ู ุฌุฏุงูู"),
                       tags$li(tags$b("ุณุงุฒูุงูุฏู ุฏุงุฏูโูุง:"), "ุฏุณุชูโุจูุฏ ู ูุฑุชุจโุณุงุฒ ุฏุงุฏูโูุง")
                     )
                 ),
                 
                 h3("๐ฏ ุฌุฏุงูู ู ูููุฏุงุฑูุง ุชูุตู"),
                 
                 h4("๐ ุฌุฏุงูู ูุฑุงูุงู"),
                 div(class = "highlight-box",
                     h4("ุฌุฏูู ูุฑุงูุงู ุจุฑุง ุฏุงุฏูโูุง ฺฉู"),
                     p("ุจุฑุง ูุชุบุฑูุง ฺฉูุ ุฌุฏูู ูุฑุงูุงู ุดุงูู ููุงุฑุฏ ุฒุฑ ุงุณุช:"),
                     tags$ul(
                       tags$li(tags$b("ูุฑุงูุงู ูุทูู (Absolute Frequency):"), "ุชุนุฏุงุฏ ูุดุงูุฏู ูุฑ ุฏุณุชู"),
                       tags$li(tags$b("ูุฑุงูุงู ูุณุจ (Relative Frequency):"), "ูุณุจุช ูุฑ ุฏุณุชู ุจู ฺฉู ุฏุงุฏูโูุง"),
                       tags$li(tags$b("ูุฑุงูุงู ุฏุฑุตุฏ (Percentage Frequency):"), "ูุฑุงูุงู ูุณุจ ุถุฑุจ ุฏุฑ ฑฐฐ"),
                       tags$li(tags$b("ูุฑุงูุงู ุชุฌูุน (Cumulative Frequency):"), "ุฌูุน ูุฑุงูุงูโูุง ุชุง ุฏุณุชู ููุฑุฏ ูุธุฑ")
                     ),
                     tableOutput("qualitative_freq_table"),
                     p(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุชูุฒุน ฺฏุฑููโูุง ุฎูู ุฏุฑ ฺฉ ููููู ฑฐฐ ููุฑู")
                 ),
                 
                 div(class = "success-box",
                     h4("ุฌุฏูู ูุฑุงูุงู ุจุฑุง ุฏุงุฏูโูุง ฺฉู"),
                     p("ุจุฑุง ูุชุบุฑูุง ฺฉูุ ุงุจุชุฏุง ุฏุงุฏูโูุง ุฑุง ุจู ุจุงุฒูโูุง ุชูุณู ูโฺฉูู:"),
                     tags$ul(
                       tags$li("ุชุนู ุชุนุฏุงุฏ ุจุงุฒูโูุง (ูุนูููุงู ต-ฑต ุจุงุฒู)"),
                       tags$li("ูุญุงุณุจู ุนุฑุถ ุจุงุฒูโูุง"),
                       tags$li("ุดูุงุฑุด ูุฑุงูุงู ูุฑ ุจุงุฒู"),
                       tags$li("ูุญุงุณุจู ููุทู ูุงู ูุฑ ุจุงุฒู")
                     ),
                     tableOutput("quantitative_freq_table"),
                     p(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุชูุฒุน ุณู ุจูุงุฑุงู ฺฉ ุจูุงุฑุณุชุงู")
                 ),
                 
                 h4("๐ ูููุฏุงุฑูุง ุชูุตู"),
                 fluidRow(
                   column(6,
                          h4("ูููุฏุงุฑูุง ุจุฑุง ุฏุงุฏูโูุง ฺฉู"),
                          div(class = "info-box",
                              h5("ูููุฏุงุฑ ูููโุง (Bar Chart)"),
                              p("ุจุฑุง ููุงุณู ูุฑุงูุงู ุฏุณุชูโูุง ูุฎุชูู"),
                              p(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ููุงุณู ุดูุน ุจูุงุฑโูุงุ ฺฏุฑููโูุง ุฎูู"),
                              plotOutput("bar_chart_demo", height = "200px")
                          ),
                          div(class = "info-box",
                              h5("ูููุฏุงุฑ ุฏุงุฑูโุง (Pie Chart)"),
                              p("ุจุฑุง ููุงุด ุณูู ูุฑ ุฏุณุชู ุงุฒ ฺฉู"),
                              p(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ููุงุด ุชุฑฺฉุจ ุฌูุนุชุ ุชูุฒุน ุนูุงูู ุฎุทุฑ"),
                              plotOutput("pie_chart_demo", height = "200px")
                          )
                   ),
                   column(6,
                          h4("ูููุฏุงุฑูุง ุจุฑุง ุฏุงุฏูโูุง ฺฉู"),
                          div(class = "info-box",
                              h5("ูุณุชูฺฏุฑุงู (Histogram)"),
                              p("ููุงุด ุชูุฒุน ูุฑุงูุงู ุฏุงุฏูโูุง ฺฉู"),
                              p(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ุชูุฒุน ูุดุงุฑ ุฎููุ ุณูุ ูุฒู"),
                              plotOutput("histogram_demo", height = "200px")
                          ),
                          div(class = "info-box",
                              h5("ูููุฏุงุฑ ุฌุนุจูโุง (Boxplot)"),
                              p("ููุงุด ฺุงุฑฺฉโูุงุ ูุงูู ู ููุงุฏุฑ ูพุฑุช"),
                              p(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ููุงุณู ฺฏุฑููโูุงุ ุดูุงุณุง ููุงุฏุฑ ูพุฑุช"),
                              plotOutput("boxplot_demo", height = "200px")
                          )
                   )
                 ),
                 
                 h4("๐ ูุซุงู ฺฉุงุฑุจุฑุฏ: ุฏุงุฏูโูุง ูุดุงุฑ ุฎูู"),
                 fluidRow(
                   column(6,
                          div(class = "warning-box",
                              h5("ุฏุงุฏูโูุง ุฎุงู ูุดุงุฑ ุฎูู (ูููููโุง)"),
                              tableOutput("bp_raw_data_table"),
                              p("ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุฏุงุฏูโูุงุ ุฌุฏุงูู ู ูููุฏุงุฑูุง ุฒุฑ ุณุงุฎุชู ูโุดููุฏ:")
                          )
                   ),
                   column(6,
                          div(class = "success-box",
                              h5("ุฌุฏูู ูุฑุงูุงู ูุดุงุฑ ุฎูู"),
                              tableOutput("bp_freq_table"),
                              p("ุจุงุฒูโูุง: 10 mmHg intervals")
                          )
                   )
                 ),
                 
                 h3("๐ ุดุงุฎุตโูุง ูุฑฺฉุฒ (Measures of Central Tendency)"),
                 div(class = "highlight-box",
                     h4("ูุฏู ุดุงุฎุตโูุง ูุฑฺฉุฒ"),
                     p("ุดุงุฎุตโูุง ูุฑฺฉุฒ ููุฏุงุฑ ูุฑฺฉุฒ ุง ููุงูุฏูโุง ุจุฑุง ูุฌููุนู ุฏุงุฏูโูุง ุงุฑุงุฆู ูโุฏููุฏ. ุงู ุดุงุฎุตโูุง ูุดุงู ูโุฏููุฏ ฺฉู ุฏุงุฏูโูุง ุญูู ฺู ููุฏุงุฑ ูุชูุฑฺฉุฒ ุดุฏูโุงูุฏ.")
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h4("ูุงูฺฏู (Mean)"),
                              p("ูุฌููุน ููุงุฏุฑ ุชูุณู ุจุฑ ุชุนุฏุงุฏ ุขููุง"),
                              p(tags$b("ูุฑููู:"), "xฬ = ฮฃxแตข / n"),
                              tags$ul(
                                tags$li(tags$b("ูฺฺฏ:"), "ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช"),
                                tags$li(tags$b("ูุฒุงุง:"), "ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุฏุงุฏูโูุง"),
                                tags$li(tags$b("ูุนุงุจ:"), "ุชุญุช ุชุฃุซุฑ ููุงุฏุฑๆ็ซฏ"),
                                tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ูุงูฺฏู ูุดุงุฑ ุฎูู 120 ุจูุงุฑ")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("mean_plot", height = "300px")
                   )
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h4("ูุงูู (Median)"),
                              p("ููุฏุงุฑ ูุณุท ููุช ุฏุงุฏูโูุง ุจู ุชุฑุชุจ ูุฑุชุจ ุดุฏู ุจุงุดูุฏ"),
                              tags$ul(
                                tags$li(tags$b("ูฺฺฏ:"), "ููุงูู ุจู ููุงุฏุฑ ูพุฑุช"),
                                tags$li(tags$b("ูุฒุงุง:"), "ููุงุณุจ ุจุฑุง ุฏุงุฏูโูุง skewed"),
                                tags$li(tags$b("ูุนุงุจ:"), "ุนุฏู ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุงุทูุงุนุงุช"),
                                tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ูุงูู ุฏุฑุขูุฏ ุจูุงุฑุงู ฺฉ ฺฉููฺฉ")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("median_plot", height = "300px")
                   )
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h4("ููุง (Mode)"),
                              p("ูพุฑุชฺฉุฑุงุฑุชุฑู ููุฏุงุฑ ุฏุฑ ูุฌููุนู ุฏุงุฏู"),
                              tags$ul(
                                tags$li(tags$b("ูฺฺฏ:"), "ุจุฑุง ุฏุงุฏูโูุง ฺฉู ู ฺฉู ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ"),
                                tags$li(tags$b("ูุฒุงุง:"), "ูุงุจู ุงุณุชูุงุฏู ุจุฑุง ุฏุงุฏูโูุง ุงุณู"),
                                tags$li(tags$b("ูุนุงุจ:"), "ููฺฉู ุงุณุช ฺูุฏู ููุง ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ"),
                                tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุดุงุนโุชุฑู ฺฏุฑูู ุฎูู ุฏุฑ ฺฉ ุฌุงูุนู")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("mode_plot", height = "300px")
                   )
                 ),
                 
                 h3("๐ ุดุงุฎุตโูุง ูพุฑุงฺฉูุฏฺฏ (Measures of Dispersion)"),
                 div(class = "success-box",
                     h4("ูุฏู ุดุงุฎุตโูุง ูพุฑุงฺฉูุฏฺฏ"),
                     p("ุดุงุฎุตโูุง ูพุฑุงฺฉูุฏฺฏ ูุฒุงู ุชุบุฑูพุฐุฑ ุง ูพุฑุงฺฉูุฏฺฏ ุฏุงุฏูโูุง ุญูู ููุฏุงุฑ ูุฑฺฉุฒ ุฑุง ูุดุงู ูโุฏููุฏ. ุงู ุดุงุฎุตโูุง ุจู ุฏุฑฺฉ homogeneity ุง heterogeneity ุฏุงุฏูโูุง ฺฉูฺฉ ูโฺฉููุฏ.")
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "warning-box",
                              h4("ุฏุงููู (Range)"),
                              p("ุชูุงูุช ุจู ุจุฒุฑฺฏุชุฑู ู ฺฉูฺฺฉุชุฑู ููุฏุงุฑ"),
                              p(tags$b("ูุฑููู:"), "R = Max - Min"),
                              tags$ul(
                                tags$li(tags$b("ูุฒุงุง:"), "ูุญุงุณุจู ุณุงุฏู"),
                                tags$li(tags$b("ูุนุงุจ:"), "ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช"),
                                tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ุจุฑุฑุณ ุงููู ูพุฑุงฺฉูุฏฺฏ")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("range_plot", height = "300px")
                   )
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "warning-box",
                              h4("ูุงุฑุงูุณ (Variance)"),
                              p("ูุงูฺฏู ูุฑุจุนุงุช ุงูุญุฑุงู ุงุฒ ูุงูฺฏู"),
                              p(tags$b("ูุฑููู:"), "sยฒ = ฮฃ(xแตข - xฬ)ยฒ / (n-1)"),
                              tags$ul(
                                tags$li(tags$b("ูฺฺฏ:"), "ุฏุฑ ูุงุญุฏ ูุฑุจุน ูุชุบุฑ ุจุงู ูโุดูุฏ"),
                                tags$li(tags$b("ูุฒุงุง:"), "ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุฏุงุฏูโูุง"),
                                tags$li(tags$b("ูุนุงุจ:"), "ูุงุญุฏ ุณูุฌุด ูุงูุฃููุณ")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("variance_plot", height = "300px")
                   )
                 ),
                 
                 fluidRow(
                   column(6,
                          div(class = "warning-box",
                              h4("ุงูุญุฑุงู ูุนุงุฑ (Standard Deviation)"),
                              p("ุฌุฐุฑ ูุงุฑุงูุณ - ูุดุงูโุฏููุฏู ูพุฑุงฺฉูุฏฺฏ ุญูู ูุงูฺฏู"),
                              p(tags$b("ูุฑููู:"), "s = โsยฒ"),
                              tags$ul(
                                tags$li(tags$b("ูุฒุงุง:"), "ูุงุญุฏ ุณูุฌุด ูุนูโุฏุงุฑ"),
                                tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ููุงุณู ูพุฑุงฺฉูุฏฺฏ ฺฏุฑููโูุง ูุฎุชูู"),
                                tags$li(tags$b("ูุซุงู:"), "ุงูุญุฑุงู ูุนุงุฑ ูุดุงุฑ ุฎูู = 15 mmHg")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("sd_plot", height = "300px")
                   )
                 ),
                 
                 h3("๐ ฺุงุฑฺฉโูุง ู ููุงุฏุฑ ูููุนุช"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h4("ฺุงุฑฺฉโูุง ู ุฏุงููู ูุงู ฺุงุฑฺฉ"),
                              h5("ฺุงุฑฺฉโูุง (Quartiles)"),
                              tags$ul(
                                tags$li(tags$b("ฺุงุฑฺฉ ุงูู (Q1):"), "25% ุฏุงุฏูโูุง ุฒุฑ ุงู ููุฏุงุฑ"),
                                tags$li(tags$b("ฺุงุฑฺฉ ุฏูู (Q2):"), "ูุงูู - 50% ุฏุงุฏูโูุง"),
                                tags$li(tags$b("ฺุงุฑฺฉ ุณูู (Q3):"), "75% ุฏุงุฏูโูุง ุฒุฑ ุงู ููุฏุงุฑ")
                              ),
                              h5("ุฏุงููู ูุงู ฺุงุฑฺฉ (IQR)"),
                              p(tags$b("ูุฑููู:"), "IQR = Q3 - Q1"),
                              p(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ุดูุงุณุง ููุงุฏุฑ ูพุฑุช ู ุชูุตู ูพุฑุงฺฉูุฏฺฏ")
                          )
                   ),
                   column(6,
                          plotOutput("quartile_plot", height = "300px")
                   )
                 ),
                 
                 h3("๐ฏ ุดูุงุณุง ููุงุฏุฑ ูพุฑุช (Outliers)"),
                 fluidRow(
                   column(6,
                          div(class = "highlight-box",
                              h4("ูุงุนุฏู IQR ุจุฑุง ุดูุงุณุง ููุงุฏุฑ ูพุฑุช"),
                              p("ููุงุฏุฑ ุฎุงุฑุฌ ุงุฒ ูุญุฏูุฏู ุฒุฑ ุจู ุนููุงู ูพุฑุช ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ:"),
                              p(tags$b("ุญุฏ ูพุงู:"), "Q1 - 1.5 ร IQR"),
                              p(tags$b("ุญุฏ ุจุงูุง:"), "Q3 + 1.5 ร IQR"),
                              p(tags$b("ูุซุงู:"), "ุฏุฑ ุฏุงุฏูโูุง ูุดุงุฑ ุฎูู:"),
                              tags$ul(
                                tags$li("Q1 = 115, Q3 = 135, IQR = 20"),
                                tags$li("ุญุฏ ูพุงู: 115 - 1.5ร20 = 85"),
                                tags$li("ุญุฏ ุจุงูุง: 135 + 1.5ร20 = 165"),
                                tags$li("ููุงุฏุฑ <85 ุง >165 ูพุฑุช ูุญุณูุจ ูโุดููุฏ")
                              ),
                              h5("ุฑูุดโูุง ุจุฑุฎูุฑุฏ ุจุง ููุงุฏุฑ ูพุฑุช"),
                              tags$ul(
                                tags$li("ุจุฑุฑุณ ุตุญุช ุฏุงุฏูโูุง"),
                                tags$li("ุญุฐู ุฏุฑ ุตูุฑุช ุฎุทุง ุงูุฏุงุฒูโฺฏุฑ"),
                                tags$li("ุฌุงฺฏุฒู ุจุง ููุงุฏุฑ ูุนููู"),
                                tags$li("ุงุณุชูุงุฏู ุงุฒ ุฑูุดโูุง ููุงูู")
                              )
                          )
                   ),
                   column(6,
                          plotOutput("outlier_detection_plot", height = "350px")
                   )
                 ),
                 
                 h3("๐ ูุซุงู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุฏุงุฏูโูุง ูุดุงุฑ ุฎูู 100 ุจูุงุฑ"),
                              tags$ul(
                                tags$li("ูุงูฺฏู: 125 mmHg"),
                                tags$li("ุงูุญุฑุงู ูุนุงุฑ: 15 mmHg"),
                                tags$li("ูุงูู: 122 mmHg"),
                                tags$li("ุฏุงููู: 90-180 mmHg"),
                                tags$li("ฺุงุฑฺฉ ุงูู (Q1): 115 mmHg"),
                                tags$li("ฺุงุฑฺฉ ุณูู (Q3): 135 mmHg"),
                                tags$li("ุฏุงููู ูุงู ฺุงุฑฺฉ (IQR): 20 mmHg"),
                                tags$li("ุถุฑุจ ุชุบุฑุงุช: 12%")
                              ),
                              h5("ุชูุณุฑ ูุชุงุฌ:"),
                              p("ูุดุงุฑ ุฎูู ุจูุงุฑุงู ุญูู ูุงูฺฏู 125 ุจุง ูพุฑุงฺฉูุฏฺฏ ูุชูุณุท ุชูุฒุน ุดุฏู ุงุณุช. ุฏุงููู ูุงู ฺุงุฑฺฉ 20 ูุงุญุฏ ูุดุงู ูโุฏูุฏ ฺฉู 50% ูุฑฺฉุฒ ุฏุงุฏูโูุง ุฏุฑ ูุญุฏูุฏู 20 ูุงุญุฏ ูุฑุงุฑ ุฏุงุฑูุฏ.")
                          )
                   ),
                   column(6,
                          plotOutput("bp_example_plot", height = "350px")
                   )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุดุงุฎุตโูุง ุขูุงุฑ ุชูุตู"),
                 tableOutput("descriptive_summary_table"),
                 
                 h3("โ๏ธ ูฺฉุงุช ููู ู ูุดุฏุงุฑูุง"),
                 div(class = "warning-box",
                     h4("ุงุดุชุจุงูุงุช ุฑุงุฌ ุฏุฑ ุขูุงุฑ ุชูุตู"),
                     tags$ul(
                       tags$li("ุงุณุชูุงุฏู ุงุฒ ูุงูฺฏู ุจุฑุง ุฏุงุฏูโูุง skewed"),
                       tags$li("ุชูุณุฑ ูุงุฏุฑุณุช ุงูุญุฑุงู ูุนุงุฑ"),
                       tags$li("ุจโุชูุฌู ุจู ููุงุฏุฑ ูพุฑุช"),
                       tags$li("ุงูุชุฎุงุจ ูุงุฏุฑุณุช ูููุฏุงุฑ ุจุฑุง ููุน ุฏุงุฏู"),
                       tags$li("ุนุฏู ฺฏุฒุงุฑุด ุดุงุฎุตโูุง ูพุฑุงฺฉูุฏฺฏ ููุฑุงู ุจุง ุดุงุฎุตโูุง ูุฑฺฉุฒ")
                     )
                 ),
                 
                 h3("๐ฏ ุฑุงูููุง ุงูุชุฎุงุจ ุดุงุฎุตโูุง ููุงุณุจ"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ุฏุงุฏูโูุง ูุฑูุงู"),
                              tags$ul(
                                tags$li("ูุงูฺฏู ยฑ ุงูุญุฑุงู ูุนุงุฑ"),
                                tags$li("ูุญุฏูุฏู (ุงุฎุชุงุฑ)"),
                                tags$li("ูุณุชูฺฏุฑุงู + ููุญู ูุฑูุงู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู"),
                              tags$ul(
                                tags$li("ูุงูู (ุฏุงููู ูุงู ฺุงุฑฺฉ)"),
                                tags$li("ููุงุฏุฑ ูููู ู ูุงฺฉุณูู"),
                                tags$li("ูููุฏุงุฑ ุฌุนุจูโุง")
                              )
                          )
                   )
                 )
             )
           ),
           
           "distributions" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุชูุฒุนโูุง ุขูุงุฑ (Statistical Distributions)"),
                 
                 h3("๐ ุชูุฒุน ุขูุงุฑ ฺุณุชุ"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุชูุฒุน ุขูุงุฑ"),
                     p("ุชูุฒุน ุขูุงุฑ ุชูุตู ูโฺฉูุฏ ฺฉู ฺฺฏููู ููุงุฏุฑ ฺฉ ูุชุบุฑ ุฏุฑ ุฌุงูุนู ุชูุฒุน ุดุฏูโุงูุฏ. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ุชูุฒุน ุขูุงุฑ ูุดุงู ูโุฏูุฏ ฺฉู ฺู ููุงุฏุฑ ุจุฑุง ฺฉ ูุชุบุฑ ููฺฉู ุงุณุช ุฑุฎ ุฏููุฏ ู ูุฑ ฺฉุฏุงู ุจุง ฺู ุงุญุชูุงู ุธุงูุฑ ูโุดููุฏ."),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ ุชุตุงุฏู (Random Variable):"), "ูุชุบุฑ ฺฉู ููุงุฏุฑ ุขู ุจู ุตูุฑุช ุชุตุงุฏู ุชุนู ูโุดูุฏ"),
                       tags$li(tags$b("ุชูุฒุน ุงุญุชูุงู (Probability Distribution):"), "ุชุงุจุน ฺฉู ุงุญุชูุงู ุฑุฎ ุฏุงุฏู ูุฑ ููุฏุงุฑ ุฑุง ูุดุฎุต ูโฺฉูุฏ"),
                       tags$li(tags$b("ูพุงุฑุงูุชุฑูุง ุชูุฒุน (Distribution Parameters):"), "ููุงุฏุฑ ฺฉู ุดฺฉู ู ูฺฺฏโูุง ุชูุฒุน ุฑุง ุชุนู ูโฺฉููุฏ")
                     )
                 ),
                 
                 h4("๐ฏ ฺุฑุง ุชูุฒุนโูุง ุขูุงุฑ ููู ูุณุชูุฏุ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h5("ุฏุฑ ุขูุงุฑ ุชูุตู"),
                              tags$ul(
                                tags$li("ุฎูุงุตูโุณุงุฒ ุฏุงุฏูโูุง"),
                                tags$li("ุชุดุฎุต ุงูฺฏููุง"),
                                tags$li("ุดูุงุณุง ููุงุฏุฑ ูพุฑุช"),
                                tags$li("ุฏุฑฺฉ ุฑูุชุงุฑ ูุชุบุฑูุง")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุฏุฑ ุขูุงุฑ ุงุณุชูุจุงุท"),
                              tags$ul(
                                tags$li("ุงูุฌุงู ุขุฒูููโูุง ูุฑุถู"),
                                tags$li("ูุญุงุณุจู ูุงุตูู ุงุทููุงู"),
                                tags$li("ูพุดโุจู ู ูุฏูโุณุงุฒ"),
                                tags$li("ุชุนูู ูุชุงุฌ ููููู ุจู ุฌุงูุนู")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุชูุฒุน ูุฑูุงู (Normal Distribution)"),
                 div(class = "highlight-box",
                     h4("ูฺฺฏโูุง ุชูุฒุน ูุฑูุงู"),
                     tags$ul(
                       tags$li("ุดฺฉู ุฒูฺฏูููโุง ู ูุชูุงุฑู (Bell-shaped and Symmetric)"),
                       tags$li("ูุงูฺฏู = ูุงูู = ููุง (Mean = Median = Mode)"),
                       tags$li("ุชูุณุท ุฏู ูพุงุฑุงูุชุฑ ูุงูฺฏู (ฮผ) ู ุงูุญุฑุงู ูุนุงุฑ (ฯ) ุชุนุฑู ูโุดูุฏ"),
                       tags$li("ูุงููู 68-95-99.7 (Empirical Rule):"),
                       tags$ul(
                         tags$li("68% ุฏุงุฏูโูุง ุฏุฑ ฮผ ยฑ ฯ"),
                         tags$li("95% ุฏุงุฏูโูุง ุฏุฑ ฮผ ยฑ 2ฯ"),
                         tags$li("99.7% ุฏุงุฏูโูุง ุฏุฑ ฮผ ยฑ 3ฯ")
                       )
                     )
                 ),
                 
                 h3("๐ฏ ุชูุฒุนโูุง ููู ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุชูุฒุน ูุฑูุงู (Normal Distribution)"),
                              tags$ul(
                                tags$li("ูุฏุ ูุฒู"),
                                tags$li("ูุดุงุฑ ุฎูู"),
                                tags$li("ุณุทุญ ููุฏ ุฎูู ูุงุดุชุง"),
                                tags$li("ูุฒุงู ฺฉูุณุชุฑูู"),
                                tags$li("ุฏูุง ุจุฏู ุฏุฑ ุงูุฑุงุฏ ุณุงูู"),
                                tags$li("ุถุฑุจุงู ููุจ ุฏุฑ ุญุงูุช ุงุณุชุฑุงุญุช")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุชูุฒุน ุฏูุฌูููโุง (Binomial Distribution)"),
                              tags$ul(
                                tags$li("ุชุนุฏุงุฏ ููููุชโูุง ุฏุฑ n ุขุฒูุงุด"),
                                tags$li("ูุซุงู: ุชุนุฏุงุฏ ุจูุงุฑุงู ุจูุจูุฏ ุงูุชู"),
                                tags$li("ูพุงุฑุงูุชุฑูุง: n (ุชุนุฏุงุฏ ุขุฒูุงุด) ู p (ุงุญุชูุงู ููููุช)"),
                                tags$li("ูุงูฺฏู: np"),
                                tags$li("ูุงุฑุงูุณ: np(1-p)"),
                                tags$li("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                                tags$ul(
                                  tags$li("ุชุนุฏุงุฏ ุจูุจูุฏ ูพุณ ุงุฒ ุฏุฑูุงู"),
                                  tags$li("ุชุนุฏุงุฏ ูพุงุณุฎ ูุซุจุช ุจู ุฏุงุฑู"),
                                  tags$li("ุชุนุฏุงุฏ ุชุดุฎุตโูุง ุตุญุญ")
                                )
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุชูุฒุน ูพูุงุณูู (Poisson Distribution)"),
                 div(class = "warning-box",
                     h4("ูฺฺฏโูุง ุชูุฒุน ูพูุงุณูู"),
                     tags$ul(
                       tags$li("ุจุฑุง ุฑูุฏุงุฏูุง ูุงุฏุฑ ุฏุฑ ูุงุญุฏ ุฒูุงู ุง ูฺฉุงู"),
                       tags$li("ูุงูฺฏู = ูุงุฑุงูุณ (ฮป)"),
                       tags$li("ุฑูุฏุงุฏูุง ูุณุชูู ุงุฒ ูู ุฑุฎ ูโุฏููุฏ"),
                       tags$li("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                       tags$ul(
                         tags$li("ุชุนุฏุงุฏ ุจูุงุฑุงู ุงูุฑฺุงูุณ ุฏุฑ ุณุงุนุช"),
                         tags$li("ุชุนุฏุงุฏ ุฎุทุงูุง ูพุฒุดฺฉ ุฏุฑ ูุงู"),
                         tags$li("ุชุนุฏุงุฏ ุชููุฏูุง ุฏูููู ุฏุฑ ฺฉ ุจูุงุฑุณุชุงู"),
                         tags$li("ุชุนุฏุงุฏ ููุงุฑุฏ ฺฉ ุจูุงุฑ ูุงุฏุฑ ุฏุฑ ุณุงู"),
                         tags$li("ุชุนุฏุงุฏ ุนูููุชโูุง ุจูุงุฑุณุชุงู ุฏุฑ ููุชู")
                       )
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุชูุฒุน ูุฑูุงู"),
                 fluidRow(
                   column(4,
                          sliderInput("norm_mean", "ูุงูฺฏู (ฮผ):", 
                                      min = 0, max = 200, value = 100),
                          sliderInput("norm_sd", "ุงูุญุฑุงู ูุนุงุฑ (ฯ):", 
                                      min = 1, max = 50, value = 15),
                          numericInput("norm_sample_size", "ุญุฌู ููููู:", 
                                       value = 1000, min = 100, max = 10000),
                          actionButton("plot_normal", "ููุงุด ุชูุฒุน")
                   ),
                   column(8,
                          plotOutput("normal_plot"),
                          verbatimTextOutput("normal_info")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุชูุฒุน ุฏูุฌูููโุง"),
                 fluidRow(
                   column(4,
                          sliderInput("binom_n", "ุชุนุฏุงุฏ ุขุฒูุงุด (n):", 
                                      min = 1, max = 100, value = 20),
                          sliderInput("binom_p", "ุงุญุชูุงู ููููุช (p):", 
                                      min = 0, max = 1, value = 0.5, step = 0.05),
                          numericInput("binom_sample_size", "ุชุนุฏุงุฏ ููููู:", 
                                       value = 1000, min = 100, max = 10000),
                          actionButton("plot_binomial", "ููุงุด ุชูุฒุน")
                   ),
                   column(8,
                          plotOutput("binomial_plot"),
                          verbatimTextOutput("binomial_info")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุชูุฒุน ูพูุงุณูู"),
                 fluidRow(
                   column(4,
                          sliderInput("pois_lambda", "ูุงูฺฏู (ฮป):", 
                                      min = 0.1, max = 20, value = 5, step = 0.5),
                          numericInput("pois_sample_size", "ุชุนุฏุงุฏ ููููู:", 
                                       value = 1000, min = 100, max = 10000),
                          actionButton("plot_poisson", "ููุงุด ุชูุฒุน")
                   ),
                   column(8,
                          plotOutput("poisson_plot"),
                          verbatimTextOutput("poisson_info")
                   )
                 ),
                 
                 h3("๐ฏ ฺฉุงุฑุจุฑุฏูุง ุจุงูู ุชูุฒุนโูุง ุขูุงุฑ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุชุดุฎุต ูุฑูุงู ุจูุฏู ุฏุงุฏูโูุง"),
                              tags$ul(
                                tags$li("ุขุฒููู ุดุงูพุฑู-ููฺฉ (Shapiro-Wilk test)"),
                                tags$li("ูููุฏุงุฑ Q-Q (Quantile-Quantile plot)"),
                                tags$li("ุจุฑุฑุณ ฺููฺฏ ู ฺฉุดุฏฺฏ (Skewness & Kurtosis)"),
                                tags$li("ูุซุงู: ุจุฑุฑุณ ูุฑูุงู ุจูุฏู ุณุทุญ ููุฏ ุฎูู ุจูุงุฑุงู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุงูุชุฎุงุจ ุขุฒููู ุขูุงุฑ ููุงุณุจ"),
                              tags$ul(
                                tags$li("ุฏุงุฏูโูุง ูุฑูุงู โ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ"),
                                tags$li("ุฏุงุฏูโูุง ุบุฑูุฑูุงู โ ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ"),
                                tags$li("ุฏุงุฏูโูุง ุฏูุญุงูุช โ ุขุฒูููโูุง ูุจุชู ุจุฑ ุชูุฒุน ุฏูุฌูููโุง"),
                                tags$li("ุฏุงุฏูโูุง ุดูุงุฑุด โ ุชูุฒุน ูพูุงุณูู")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ูุซุงู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 div(class = "warning-box",
                     h4("ูุทุงูุนู ุณุทุญ ฺฉูุณุชุฑูู ุฏุฑ ุจูุงุฑุงู ููุจ"),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ:"), "ุณุทุญ ฺฉูุณุชุฑูู LDL (ฺฉู)"),
                       tags$li(tags$b("ุชูุฒุน:"), "ูุฑูุงู (ุจุง ูุงูฺฏู 130 ู ุงูุญุฑุงู ูุนุงุฑ 25)"),
                       tags$li(tags$b("ุณูุงู:"), "ฺูุฏ ุฏุฑุตุฏ ุจูุงุฑุงู ฺฉูุณุชุฑูู ุจุงูุง 160 ุฏุงุฑูุฏุ"),
                       tags$li(tags$b("ูุญุงุณุจู:"), 
                               "Z = (160-130)/25 = 1.2 โ ุงุญุชูุงู = 11.5%"),
                       tags$li(tags$b("ูุชุฌู:"), "ุญุฏูุฏ ฑฑ.ตูช ุจูุงุฑุงู ฺฉูุณุชุฑูู ุฎุทุฑูุงฺฉ ุฏุงุฑูุฏ")
                     )
                 ),
                 
                 div(class = "info-box",
                     h4("ูุทุงูุนู ุงุซุฑ ุจุฎุด ฺฉ ุฏุงุฑู ุฌุฏุฏ"),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ:"), "ุชุนุฏุงุฏ ุจูุจูุฏ ุงูุชู (ุฏูุญุงูุช)"),
                       tags$li(tags$b("ุชูุฒุน:"), "ุฏูุฌูููโุง (n=100, p=0.7)"),
                       tags$li(tags$b("ุณูุงู:"), "ุงุญุชูุงู ุจูุจูุฏ ุญุฏุงูู ธฐ ุจูุงุฑ ฺูุฏุฑ ุงุณุชุ"),
                       tags$li(tags$b("ูุญุงุณุจู:"), 
                               "P(X โฅ 80) = 1 - P(X โค 79) = 0.016"),
                       tags$li(tags$b("ูุชุฌู:"), "ุงุญุชูุงู ุจูุจูุฏ ุญุฏุงูู ธฐ ุจูุงุฑ ุชููุง ฑ.ถูช ุงุณุช")
                     )
                 ),
                 
                 h3("โ๏ธ ูฺฉุงุช ููู"),
                 div(class = "highlight-box",
                     h4("ุงุดุชุจุงูุงุช ุฑุงุฌ"),
                     tags$ul(
                       tags$li("ูุฑุถ ูุฑูุงู ุจูุฏู ุจุฏูู ุจุฑุฑุณ"),
                       tags$li("ุงุณุชูุงุฏู ุงุฒ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู"),
                       tags$li("ุชูุณุฑ ูุงุฏุฑุณุช ูพุงุฑุงูุชุฑูุง ุชูุฒุน"),
                       tags$li("ุจโุชูุฌู ุจู ููุงุฏุฑ ูพุฑุช ุฏุฑ ุชุญูู ุชูุฒุน"),
                       tags$li("ุงูุชุฎุงุจ ูุงุฏุฑุณุช ุชูุฒุน ุจุฑุง ููุน ุฏุงุฏู")
                     )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุชูุฒุนโูุง ููู"),
                 tableOutput("distributions_summary_table")
             )
           ),
           
           "tests_ci" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขุฒููู ูุฑุถ ู ูุงุตูู ุงุทููุงู"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ูุฏู ุขุฒููู ูุฑุถ ู ูุงุตูู ุงุทููุงู"),
                     p("ุงู ุฏู ููููู ูพุงูโุง ุฏุฑ ุขูุงุฑ ุงุณุชูุจุงุท ูุณุชูุฏ ฺฉู ุจู ูุง ฺฉูฺฉ ูโฺฉููุฏ ุงุฒ ุฑู ูููููโูุง ุจู ูุชุฌูโฺฏุฑ ุฏุฑุจุงุฑู ุฌุงูุนู ุจูพุฑุฏุงุฒู:"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ูุฑุถ (Hypothesis Testing):"), "ุงุฑุฒุงุจ ุงุฏุนุงูุง ุฏุฑุจุงุฑู ูพุงุฑุงูุชุฑูุง ุฌุงูุนู"),
                       tags$li(tags$b("ูุงุตูู ุงุทููุงู (Confidence Interval):"), "ุชุฎูู ูุญุฏูุฏูโุง ฺฉู ูพุงุฑุงูุชุฑ ุฌุงูุนู ุฏุฑ ุขู ูุฑุงุฑ ุฏุงุฑุฏ")
                     )
                 ),
                 
                 h3("๐ฏ ููุงูู ูพุงู ุฏุฑ ุขุฒููู ูุฑุถ"),
                 div(class = "success-box",
                     h4("ูุฑุถูโูุง"),
                     tags$ul(
                       tags$li(tags$b("ูุฑุถ ุตูุฑ (Hโ - Null Hypothesis):"), 
                               "ูุฑุถูโุง ฺฉู ูโุฎูุงูู ุขู ุฑุง ุขุฒูุงุด ฺฉูู. ูุนูููุงู ุจุงูฺฏุฑ 'ุนุฏู ุชูุงูุช' ุง 'ุนุฏู ุงุซุฑ' ุงุณุช"),
                       tags$li(tags$b("ูุฑุถ ููุงุจู (Hโ - Alternative Hypothesis):"), 
                               "ูุฑุถูโุง ฺฉู ุฏุฑ ุตูุฑุช ุฑุฏ ูุฑุถ ุตูุฑุ ุขู ุฑุง ูโูพุฐุฑู. ุจุงูฺฏุฑ 'ุชูุงูุช' ุง 'ุงุซุฑ' ุงุณุช")
                     ),
                     h5("ูุซุงู ูพุฒุดฺฉ:"),
                     p("Hโ: ุฏุงุฑู ุฌุฏุฏ ุงุซุฑ ุจุฑ ูุดุงุฑ ุฎูู ูุฏุงุฑุฏ"),
                     p("Hโ: ุฏุงุฑู ุฌุฏุฏ ุจุฑ ูุดุงุฑ ุฎูู ุงุซุฑ ุฏุงุฑุฏ")
                 ),
                 
                 h3("โ๏ธ ุงููุงุน ุฎุทุง ุฏุฑ ุขุฒููู ูุฑุถ"),
                 fluidRow(
                   column(6,
                          div(class = "warning-box",
                              h4("ุฎุทุง ููุน ุงูู (Type I Error - ฮฑ)"),
                              tags$ul(
                                tags$li("ุฑุฏ ูุฑุถ ุตูุฑ ุฏุฑ ุญุงู ฺฉู ุฏุฑุณุช ุงุณุช"),
                                tags$li("ูุดุฎุต ุดุฏู ุจุง ฮฑ (ุขููุง)"),
                                tags$li(tags$b("ุณุทุญ ูุนูโุฏุงุฑ (Significance Level):"), "ุญุฏุงฺฉุซุฑ ุงุญุชูุงู ุฎุทุง ููุน ุงูู"),
                                tags$li("ูุนูููุงู 0.05 ุง 0.01 ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ"),
                                tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุชุดุฎุต ุจูุงุฑ ุฏุฑ ูุฑุฏ ุณุงูู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุฎุทุง ููุน ุฏูู (Type II Error - ฮฒ)"),
                              tags$ul(
                                tags$li("ูพุฐุฑุด ูุฑุถ ุตูุฑ ุฏุฑ ุญุงู ฺฉู ูุงุฏุฑุณุช ุงุณุช"),
                                tags$li("ูุดุฎุต ุดุฏู ุจุง ฮฒ (ุจุชุง)"),
                                tags$li(tags$b("ุชูุงู ุขุฒููู (Power):"), "1 - ฮฒ (ุงุญุชูุงู ุฑุฏ ูุฑุถ ุตูุฑ ูุงุฏุฑุณุช)"),
                                tags$li("ูุนูููุงู 0.2 ุง 0.1 ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ"),
                                tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุนุฏู ุชุดุฎุต ุจูุงุฑ ุฏุฑ ูุฑุฏ ุจูุงุฑ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุงููุงุน ุฎุทุง"),
                 tableOutput("error_types_table"),
                 
                 h3("๐ ูุฑุงุญู ุงูุฌุงู ุขุฒููู ูุฑุถ"),
                 div(class = "highlight-box",
                     h4("ูพูุฌ ูุฑุญูู ุงุตู ุขุฒููู ูุฑุถ"),
                     tags$ol(
                       tags$li(tags$b("ุชุนู ูุฑุถูโูุง:"), "Hโ ู Hโ ุฑุง ูุดุฎุต ฺฉูุฏ"),
                       tags$li(tags$b("ุชุนู ุณุทุญ ูุนูโุฏุงุฑ:"), "ฮฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ (ูุนูููุงู 0.05)"),
                       tags$li(tags$b("ูุญุงุณุจู ุขูุงุฑู ุขุฒููู:"), "ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ููููู"),
                       tags$li(tags$b("ุชุนู ูุงุญู ุจุญุฑุงู:"), "ููุงุฏุฑ ฺฉู ููุฌุฑ ุจู ุฑุฏ Hโ ูโุดููุฏ"),
                       tags$li(tags$b("ุชุตููโฺฏุฑ ู ูุชุฌูโฺฏุฑ:"), "ุฑุฏ ุง ุนุฏู ุฑุฏ Hโ ู ุชูุณุฑ ูุชุงุฌ")
                     )
                 ),
                 
                 h3("๐ ููููู p-value"),
                 div(class = "success-box",
                     h4("p-value ฺุณุชุ"),
                     p("p-value ุงุญุชูุงู ูุดุงูุฏู ูุชุงุฌ ููููู (ุง ูุชุงุฌๆ็ซฏุชุฑ) ุฑุง ุฏุฑ ุตูุฑุช ุตุญุญ ุจูุฏู ูุฑุถ ุตูุฑ ูุดุงู ูโุฏูุฏ."),
                     tags$ul(
                       tags$li(tags$b("p-value ฺฉูฺฺฉ:"), "ุดูุงูุฏ ูู ุนูู ูุฑุถ ุตูุฑ"),
                       tags$li(tags$b("p-value ุจุฒุฑฺฏ:"), "ุดูุงูุฏ ุถุนู ุนูู ูุฑุถ ุตูุฑ"),
                       tags$li(tags$b("ูุงุนุฏู ุชุตูู:"), "ุงฺฏุฑ p-value < ฮฑ ุจุงุดุฏุ Hโ ุฑุง ุฑุฏ ูโฺฉูู")
                     ),
                     h5("ุชูุณุฑ p-value:"),
                     tags$ul(
                       tags$li("p-value < 0.01: ุจุณุงุฑ ูุนูโุฏุงุฑ"),
                       tags$li("0.01 โค p-value < 0.05: ูุนูโุฏุงุฑ"),
                       tags$li("0.05 โค p-value < 0.1: ุญุงุดูโุง"),
                       tags$li("p-value โฅ 0.1: ุบุฑ ูุนูโุฏุงุฑ")
                     )
                 ),
                 
                 h3("๐ ูุงุตูู ุงุทููุงู"),
                 div(class = "info-box",
                     h4("ุชุนุฑู ูุงุตูู ุงุทููุงู"),
                     p("ูุงุตูู ุงุทููุงู ูุญุฏูุฏูโุง ุงุฒ ููุงุฏุฑ ุงุณุช ฺฉู ุจุง ุงุทููุงู ูุดุฎุต ุดุงูู ูพุงุฑุงูุชุฑ ูุงูุน ุฌุงูุนู ูโุดูุฏ."),
                     tags$ul(
                       tags$li(tags$b("ุณุทุญ ุงุทููุงู (Confidence Level):"), "ุงุญุชูุงู ุงูฺฉู ูุงุตูู ุงุทููุงู ูพุงุฑุงูุชุฑ ูุงูุน ุฑุง ุดุงูู ุดูุฏ"),
                       tags$li(tags$b("ุญุฏูุฏ ูุงุตูู:"), "ููุงุฏุฑ ุญุฏ ูพุงู ู ุญุฏ ุจุงูุง ูุงุตูู"),
                       tags$li(tags$b("ุนุฑุถ ูุงุตูู:"), "ูุดุงูโุฏููุฏู ุฏูุช ุจุฑุขูุฑุฏ")
                     )
                 ),
                 
                 h3("๐ฏ ุฑุงุจุทู ุขุฒููู ูุฑุถ ู ูุงุตูู ุงุทููุงู"),
                 div(class = "warning-box",
                     h4("ุงุฑุชุจุงุท ุงู ุฏู ููููู"),
                     p("ุขุฒููู ูุฑุถ ู ูุงุตูู ุงุทููุงู ุฏู ุฑู ฺฉ ุณฺฉู ูุณุชูุฏ:"),
                     tags$ul(
                       tags$li("ุงฺฏุฑ ูุงุตูู ุงุทููุงู 95% ุดุงูู ููุฏุงุฑ ูุฑุถ ุตูุฑ ูุจุงุดุฏุ ุขุฒููู ูุฑุถ ุฏุฑ ุณุทุญ 0.05 ูุนูโุฏุงุฑ ุงุณุช"),
                       tags$li("ุงฺฏุฑ ูุงุตูู ุงุทููุงู ุดุงูู ููุฏุงุฑ ูุฑุถ ุตูุฑ ุจุงุดุฏุ ุขุฒููู ูุฑุถ ูุนูโุฏุงุฑ ูุณุช"),
                       tags$li("ูุงุตูู ุงุทููุงู ุงุทูุงุนุงุช ุจุดุชุฑ ุงุฑุงุฆู ูโุฏูุฏ: ูู ูุนูโุฏุงุฑ ู ูู ุงูุฏุงุฒู ุงุซุฑ")
                     )
                 ),
                 
                 h3("๐ ูุซุงู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "highlight-box",
                              h4("ูุซุงู ฑ: ุขุฒููู ูุฑุถ"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุฏุงุฑู ุฌุฏุฏ ูุดุงุฑ ุฎูู ุฑุง ฺฉุงูุด ูโุฏูุฏุ"),
                                tags$li(tags$b("Hโ:"), "ฮผ = 130 (ูุงูฺฏู ูุดุงุฑ ุฎูู ุชุบุฑ ููโฺฉูุฏ)"),
                                tags$li(tags$b("Hโ:"), "ฮผ < 130 (ูุงูฺฏู ูุดุงุฑ ุฎูู ฺฉุงูุด ูโุงุจุฏ)"),
                                tags$li(tags$b("ฮฑ:"), "0.05"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p-value = 0.03"),
                                tags$li(tags$b("ูุชุฌู:"), "ุฑุฏ Hโ - ุฏุงุฑู ุงุซุฑ ูุนูโุฏุงุฑ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฒ: ูุงุตูู ุงุทููุงู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ูุงูฺฏู ูุดุงุฑ ุฎูู ุฌุงูุนู ฺูุฏุฑ ุงุณุชุ"),
                                tags$li(tags$b("ููููู:"), "ูุงูฺฏู = 125, ุงูุญุฑุงู ูุนุงุฑ = 15, n = 100"),
                                tags$li(tags$b("ูุงุตูู ุงุทููุงู 95%:"), "122.1 ุชุง 127.9"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุจุง ุงุทููุงู 95%ุ ูุงูฺฏู ูุดุงุฑ ุฎูู ุฌุงูุนู ุจู 122.1 ู 127.9 ุงุณุช")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ูุงุตูู ุงุทููุงู"),
                 fluidRow(
                   column(4,
                          numericInput("ci_mean", "ูุงูฺฏู ููููู:", value = 100),
                          numericInput("ci_sd", "ุงูุญุฑุงู ูุนุงุฑ ููููู:", value = 15),
                          numericInput("ci_n", "ุญุฌู ููููู:", value = 30),
                          selectInput("ci_level", "ุณุทุญ ุงุทููุงู:",
                                      choices = c("90%" = 0.90, "95%" = 0.95, "99%" = 0.99),
                                      selected = "0.95"),
                          actionButton("calc_ci", "ูุญุงุณุจู ูุงุตูู ุงุทููุงู")
                   ),
                   column(8,
                          plotOutput("ci_plot"),
                          verbatimTextOutput("ci_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู ูุฑุถ"),
                 fluidRow(
                   column(4,
                          numericInput("ht_sample_mean", "ูุงูฺฏู ููููู:", value = 102),
                          numericInput("ht_pop_mean", "ูุงูฺฏู ูุฑุถ ุตูุฑ:", value = 100),
                          numericInput("ht_sd", "ุงูุญุฑุงู ูุนุงุฑ:", value = 15),
                          numericInput("ht_n", "ุญุฌู ููููู:", value = 30),
                          selectInput("ht_alpha", "ุณุทุญ ูุนูโุฏุงุฑ:",
                                      choices = c("0.01" = 0.01, "0.05" = 0.05, "0.10" = 0.10),
                                      selected = "0.05"),
                          actionButton("calc_ht", "ุงูุฌุงู ุขุฒููู ูุฑุถ")
                   ),
                   column(8,
                          plotOutput("ht_plot"),
                          verbatimTextOutput("ht_results")
                   )
                 ),
                 
                 h3("โ๏ธ ูฺฉุงุช ููู ู ูุดุฏุงุฑูุง"),
                 div(class = "warning-box",
                     h4("ุงุดุชุจุงูุงุช ุฑุงุฌ"),
                     tags$ul(
                       tags$li("ุชูุณุฑ p-value ุจู ุนููุงู ุงุญุชูุงู ุฏุฑุณุช ุจูุฏู ูุฑุถ ุตูุฑ"),
                       tags$li("ูุนูโุฏุงุฑ ุจูุฏู ุขูุงุฑ โ ุงููุช ุจุงูู"),
                       tags$li("ุจโุชูุฌู ุจู ุฎุทุง ููุน ุฏูู ุฏุฑ ูุทุงูุนุงุช ุจุง ุญุฌู ููููู ฺฉูฺฺฉ"),
                       tags$li("ุงุณุชูุงุฏู ูุงุฏุฑุณุช ุงุฒ 'ูพุฐุฑุด ูุฑุถ ุตูุฑ' ุจู ุฌุง 'ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ'"),
                       tags$li("ุชฺฉู ุตุฑู ุจุฑ p-value ุจุฏูู ุชูุฌู ุจู ุงูุฏุงุฒู ุงุซุฑ")
                     )
                 ),
                 
                 h3("๐ฏ ุฑุงูููุง ุนูู"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ุฏุฑ ุทุฑุงุญ ูุทุงูุนู"),
                              tags$ul(
                                tags$li("ุณุทุญ ูุนูโุฏุงุฑ (ฮฑ) ุฑุง ุงุฒ ูุจู ูุดุฎุต ฺฉูุฏ"),
                                tags$li("ุชูุงู ุขุฒููู (1-ฮฒ) ููุงุณุจ ุงูุชุฎุงุจ ฺฉูุฏ"),
                                tags$li("ุญุฌู ููููู ฺฉุงู ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ"),
                                tags$li("ูุฑุถูโูุง ุฑุง ุจู ูุถูุญ ุชุนุฑู ฺฉูุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุฏุฑ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                              tags$ul(
                                tags$li("p-value ุฏูู ฺฏุฒุงุฑุด ุฏูุฏ"),
                                tags$li("ูุงุตูู ุงุทููุงู ุงุฑุงุฆู ุฏูุฏ"),
                                tags$li("ุงูุฏุงุฒู ุงุซุฑ ุฑุง ฺฏุฒุงุฑุด ฺฉูุฏ"),
                                tags$li("ูุชุงุฌ ุฑุง ุฏุฑ context ุจุงูู ุชูุณุฑ ฺฉูุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุฎูุงุตู ููุงูู ฺฉูุฏ"),
                 tableOutput("key_concepts_table")
             )
           ),
           
           "statistical_tests" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขุฒูููโูุง ุขูุงุฑ ุจุฑุง ฺฉ ู ุฏู ฺฏุฑูู"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุงููุงุน ุขุฒูููโูุง ุขูุงุฑ"),
                     p("ุขุฒูููโูุง ุขูุงุฑ ุจู ุฏู ุฏุณุชู ุงุตู ุชูุณู ูโุดููุฏ:"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒูููโูุง ูพุงุฑุงูุชุฑ (Parametric):"), 
                               "ุจุฑุง ุฏุงุฏูโูุง ฺฉู ุจุง ุชูุฒุน ูุฑูุงู - ูุฏุฑุช ุขูุงุฑ ุจุงูุงุชุฑ"),
                       tags$li(tags$b("ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ (Nonparametric):"), 
                               "ุจุฑุง ุฏุงุฏูโูุง ฺฉู ุง ฺฉู ุจุฏูู ูุฑุถ ูุฑูุงู ุจูุฏู - ุงูุนุทุงูโูพุฐุฑุชุฑ")
                     )
                 ),
                 
                 h3("๐ฏ ุขุฒูููโูุง ุจุฑุง ฺฉ ฺฏุฑูู"),
                 div(class = "success-box",
                     h4("ุขุฒููู t ุชฺฉ ูููููโุง (One-Sample t-test)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏู ฺฉ ฺฏุฑูู ุจุง ููุฏุงุฑ ุซุงุจุช"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ฮผ = ฮผโ (ูุงูฺฏู ุจุฑุงุจุฑ ููุฏุงุฑ ููุฑุฏ ุงูุชุธุงุฑ ุงุณุช)"),
                                 tags$li("Hโ: ฮผ โ ฮผโ (ูุงูฺฏู ุจุง ููุฏุงุฑ ููุฑุฏ ุงูุชุธุงุฑ ุชูุงูุช ุฏุงุฑุฏ)")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ู ูพูุณุชู ุจุงุดูุฏ"),
                                 tags$li("ุฏุงุฏูโูุง ุงุฒ ุชูุฒุน ูุฑูุงู ูพุฑู ฺฉููุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ูุงูฺฏู ูุดุงุฑ ุฎูู ุจูุงุฑุงู ุจุง ููุฏุงุฑ ูุฑูุงู 120 mmHg")
                     )
                 ),
                 
                 div(class = "warning-box",
                     h4("ุขุฒููู ุนูุงูุช (Sign Test) - ูุงูพุงุฑุงูุชุฑ"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูู ฺฉ ฺฏุฑูู ุจุง ููุฏุงุฑ ุซุงุจุช"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ูุงูู = ููุฏุงุฑ ููุฑุฏ ุงูุชุธุงุฑ"),
                                 tags$li("Hโ: ูุงูู โ ููุฏุงุฑ ููุฑุฏ ุงูุชุธุงุฑ")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ุจุงุดูุฏ"),
                                 tags$li("ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ูุงูู ุณุทุญ ุฏุฑุฏ ุจูุงุฑุงู ุจุง ููุฏุงุฑ ุขุณุชุงูู")
                     )
                 ),
                 
                 h3("๐ ุขุฒูููโูุง ุจุฑุง ุฏู ฺฏุฑูู ูุณุชูู"),
                 div(class = "info-box",
                     h4("ุขุฒููู t ูุณุชูู (Independent t-test)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏู ุฏู ฺฏุฑูู ูุณุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ฮผโ = ฮผโ (ูุงูฺฏู ุฏู ฺฏุฑูู ุจุฑุงุจุฑ ุงุณุช)"),
                                 tags$li("Hโ: ฮผโ โ ฮผโ (ูุงูฺฏู ุฏู ฺฏุฑูู ุชูุงูุช ุฏุงุฑุฏ)")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ู ูพูุณุชู ุจุงุดูุฏ"),
                                 tags$li("ุฏุงุฏูโูุง ุฏุฑ ูุฑ ฺฏุฑูู ูุฑูุงู ุจุงุดูุฏ"),
                                 tags$li("ูุงุฑุงูุณ ุฏู ฺฏุฑูู ุจุฑุงุจุฑ ุจุงุดุฏ (ููฺฏู ูุงุฑุงูุณ)"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ูุงูฺฏู ูุดุงุฑ ุฎูู ุจู ุฒูุงู ู ูุฑุฏุงู")
                     )
                 ),
                 
                 div(class = "warning-box",
                     h4("ุขุฒููู ูู-ูุชู (Mann-Whitney U Test)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ุชูุฒุน ุฏู ฺฏุฑูู ูุณุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ุชูุฒุน ุฏู ฺฏุฑูู ฺฉุณุงู ุงุณุช"),
                                 tags$li("Hโ: ุชูุฒุน ุฏู ฺฏุฑูู ุชูุงูุช ุฏุงุฑุฏ")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ุง ุชุฑุชุจ ุจุงุดูุฏ"),
                                 tags$li("ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ุณุทุญ ุฏุฑุฏ ุจู ุฏู ุฑูุด ุฏุฑูุงู")
                     )
                 ),
                 
                 h3("๐ ุขุฒูููโูุง ุจุฑุง ุฏู ฺฏุฑูู ูุงุจุณุชู"),
                 div(class = "success-box",
                     h4("ุขุฒููู t ุฒูุฌ (Paired t-test)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏู ฺฉ ฺฏุฑูู ุฏุฑ ุฏู ุฒูุงู ูุฎุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ฮผโ = ฮผโ (ูุงูฺฏู ุฏู ุงูุฏุงุฒูโฺฏุฑ ุจุฑุงุจุฑ ุงุณุช)"),
                                 tags$li("Hโ: ฮผโ โ ฮผโ (ูุงูฺฏู ุฏู ุงูุฏุงุฒูโฺฏุฑ ุชูุงูุช ุฏุงุฑุฏ)")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ู ูพูุณุชู ุจุงุดูุฏ"),
                                 tags$li("ุชูุงุถู ุฌูุชโูุง ูุฑูุงู ุจุงุดุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุงุจุณุชู ุจุงุดูุฏ (ุฌูุชโุดุฏู)")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ูุดุงุฑ ุฎูู ุจูุงุฑุงู ูุจู ู ุจุนุฏ ุงุฒ ุฏุฑูุงู")
                     )
                 ),
                 
                 div(class = "info-box",
                     h4("ุขุฒููู ููฺฉุงฺฉุณูู (Wilcoxon Signed-Rank Test)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ุชูุฒุน ฺฉ ฺฏุฑูู ุฏุฑ ุฏู ุฒูุงู ูุฎุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ุชูุฒุน ุฏู ุงูุฏุงุฒูโฺฏุฑ ฺฉุณุงู ุงุณุช"),
                                 tags$li("Hโ: ุชูุฒุน ุฏู ุงูุฏุงุฒูโฺฏุฑ ุชูุงูุช ุฏุงุฑุฏ")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ุง ุชุฑุชุจ ุจุงุดูุฏ"),
                                 tags$li("ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุงุจุณุชู ุจุงุดูุฏ"),
                                 tags$li("ุชูุฒุน ุชูุงุถูโูุง ูุชูุงุฑู ุจุงุดุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ุณุทุญ ุฏุฑุฏ ุจูุงุฑุงู ูุจู ู ุจุนุฏ ุงุฒ ุฏุงุฑู")
                     )
                 ),
                 
                 h3("๐ ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู ููุงุณุจ"),
                 tableOutput("test_selection_guide"),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู t ูุณุชูู"),
                 fluidRow(
                   column(4,
                          h4("ฺฏุฑูู ฑ"),
                          numericInput("group1_mean", "ูุงูฺฏู:", value = 100),
                          numericInput("group1_sd", "ุงูุญุฑุงู ูุนุงุฑ:", value = 15),
                          numericInput("group1_n", "ุญุฌู ููููู:", value = 30),
                          
                          h4("ฺฏุฑูู ฒ"),
                          numericInput("group2_mean", "ูุงูฺฏู:", value = 110),
                          numericInput("group2_sd", "ุงูุญุฑุงู ูุนุงุฑ:", value = 15),
                          numericInput("group2_n", "ุญุฌู ููููู:", value = 30),
                          
                          selectInput("test_alpha", "ุณุทุญ ูุนูโุฏุงุฑ:",
                                      choices = c("0.01" = 0.01, "0.05" = 0.05, "0.10" = 0.10),
                                      selected = "0.05"),
                          actionButton("run_ttest", "ุงูุฌุงู ุขุฒููู t")
                   ),
                   column(8,
                          plotOutput("ttest_plot"),
                          verbatimTextOutput("ttest_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู ูู-ูุชู"),
                 fluidRow(
                   column(4,
                          h4("ุฏุงุฏูโูุง ฺฏุฑููโูุง"),
                          p("ูุงูฺฏู ุฑุชุจูโูุง ุฑุง ูุงุฑุฏ ฺฉูุฏ:"),
                          numericInput("mw_group1_rank", "ูุงูฺฏู ุฑุชุจู ฺฏุฑูู ฑ:", value = 25),
                          numericInput("mw_group2_rank", "ูุงูฺฏู ุฑุชุจู ฺฏุฑูู ฒ:", value = 35),
                          numericInput("mw_n1", "ุญุฌู ููููู ฺฏุฑูู ฑ:", value = 30),
                          numericInput("mw_n2", "ุญุฌู ููููู ฺฏุฑูู ฒ:", value = 30),
                          actionButton("run_mwtest", "ุงูุฌุงู ุขุฒููู ูู-ูุชู")
                   ),
                   column(8,
                          plotOutput("mwtest_plot"),
                          verbatimTextOutput("mwtest_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "highlight-box",
                              h4("ูุซุงู ฑ: ููุงุณู ุฏู ุฑูุด ุฏุฑูุงู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุฑูุด ุฏุฑูุงู A ุงุฒ ุฑูุด B ุจูุชุฑ ุงุณุชุ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุณุทุญ ุจูุจูุฏ ุจูุงุฑุงู (ฺฉู)"),
                                tags$li(tags$b("ุชูุฒุน:"), "ูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู:"), "t ูุณุชูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p-value = 0.02"),
                                tags$li(tags$b("ูุชุฌู:"), "ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏู ุฑูุด ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ูุซุงู ฒ: ุงุซุฑ ุฏุงุฑู ุจุฑ ูุดุงุฑ ุฎูู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุฏุงุฑู ุฌุฏุฏ ูุดุงุฑ ุฎูู ุฑุง ฺฉุงูุด ูโุฏูุฏุ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ูุดุงุฑ ุฎูู ูุจู ู ุจุนุฏ ุงุฒ ุฏุฑูุงู"),
                                tags$li(tags$b("ุชูุฒุน:"), "ุบุฑูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู:"), "ููฺฉุงฺฉุณูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p-value = 0.03"),
                                tags$li(tags$b("ูุชุฌู:"), "ุฏุงุฑู ุงุซุฑ ูุนูโุฏุงุฑ ุฏุงุฑุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุจุฑุฑุณ ูพุดโูุฑุถโูุง ุขุฒูููโูุง ูพุงุฑุงูุชุฑ"),
                 div(class = "warning-box",
                     h4("ุฑูุดโูุง ุจุฑุฑุณ ูุฑูุงู ุจูุฏู ุฏุงุฏูโูุง"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ุดุงูพุฑู-ููฺฉ (Shapiro-Wilk):"),
                               tags$ul(
                                 tags$li("ููุงุณุจ ุจุฑุง ูููููโูุง ฺฉูฺฺฉ (n < 50)"),
                                 tags$li("Hโ: ุฏุงุฏูโูุง ุงุฒ ุชูุฒุน ูุฑูุงู ูพุฑู ูโฺฉููุฏ"),
                                 tags$li("p-value > 0.05 โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ"),
                                 tags$li("โ ูุฏุฑุช ุชุดุฎุต ุจุงูุง ุจุฑุง ูููููโูุง ฺฉูฺฺฉ")
                               )),
                       tags$li(tags$b("ุขุฒููู ฺฉููููฺฏุฑูู-ุงุณูุฑููู (Kolmogorov-Smirnov):"),
                               tags$ul(
                                 tags$li("ููุงุณุจ ุจุฑุง ูููููโูุง ุจุฒุฑฺฏ (n > 50)"),
                                 tags$li("Hโ: ุฏุงุฏูโูุง ุงุฒ ุชูุฒุน ูุฑูุงู ูุดุฎุต ูพุฑู ูโฺฉููุฏ"),
                                 tags$li("ููุงุณู ุชูุฒุน ุชุฌุฑุจ ุจุง ุชูุฒุน ูุฑูุงู ูุธุฑ"),
                                 tags$li("p-value > 0.05 โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ"),
                                 tags$li("โ ููุงุณุจ ุจุฑุง ูููููโูุง ุจุฒุฑฺฏ")
                               )),
                       tags$li(tags$b("ูููุฏุงุฑ Q-Q (Quantile-Quantile):"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ุฑู ุฎุท ุฑุงุณุช โ ูุฑูุงู ุจูุฏู"),
                                 tags$li("ุงูุญุฑุงู ุงุฒ ุฎุท โ ููุถ ูุฑูุงู ุจูุฏู"),
                                 tags$li("โ ุฑูุด ฺฏุฑุงูฺฉ ู ุจุตุฑ"),
                                 tags$li("ููุงุณุจ ุจุฑุง ุชุดุฎุต ุงูฺฏููุง ุบุฑูุฑูุงู")
                               )),
                       tags$li(tags$b("ูุณุชูฺฏุฑุงู ู ููุญู ูุฑูุงู:"),
                               tags$ul(
                                 tags$li("ุดฺฉู ุฒูฺฏูููโุง โ ูุฑูุงู ุจูุฏู"),
                                 tags$li("ฺููฺฏ ุดุฏุฏ โ ููุถ ูุฑูุงู ุจูุฏู"),
                                 tags$li("โ ุฏุฑฺฉ ุดููุฏ ุงุฒ ุชูุฒุน ุฏุงุฏูโูุง")
                               ))
                     )
                 ),
                 
                 h4("๐ ููุงุณู ุขุฒูููโูุง ูุฑูุงูุช"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ุขุฒููู ุดุงูพุฑู-ููฺฉ"),
                              tags$ul(
                                tags$li("โ ูุฏุฑุช ุจุงูุง ุฏุฑ ูููููโูุง ฺฉูฺฺฉ"),
                                tags$li("โ ุญุณุงุณุช ุจู ุงููุงุน ุงูุญุฑุงู ุงุฒ ูุฑูุงู ุจูุฏู"),
                                tags$li("โ ูุญุฏูุฏ ุจู ูููููโูุง 3 ุชุง 5000 ุชุง"),
                                tags$li("โ ุชุญุช ุชุฃุซุฑ ููุงุฏุฑ ุชฺฉุฑุงุฑ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุขุฒููู ฺฉููููฺฏุฑูู-ุงุณูุฑููู"),
                              tags$ul(
                                tags$li("โ ููุงุณุจ ุจุฑุง ูููููโูุง ุจุฒุฑฺฏ"),
                                tags$li("โ ูุงุจูุช ุชุทุจู ุจุง ูุฑ ุชูุฒุน ูุธุฑ"),
                                tags$li("โ ูุฏุฑุช ฺฉูุชุฑ ุฏุฑ ูููููโูุง ฺฉูฺฺฉ"),
                                tags$li("โ ุญุณุงุณุช ฺฉูุชุฑ ุจู ุงูุญุฑุงูุงุช ุฏู ุชูุฒุน")
                              )
                          )
                   )
                 ),
                 
                 h4("๐ฏ ูุซุงู ฺฉุงุฑุจุฑุฏ ุจุฑุฑุณ ูุฑูุงู ุจูุฏู"),
                 div(class = "success-box",
                     h5("ุจุฑุฑุณ ูุฑูุงู ุจูุฏู ุณุทุญ ููุฏ ุฎูู ุจูุงุฑุงู"),
                     tags$ul(
                       tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุณุทุญ ููุฏ ุฎูู ูุงุดุชุง 60 ุจูุงุฑ"),
                       tags$li(tags$b("ุขุฒููู ุดุงูพุฑู-ููฺฉ:"), "W = 0.985, p-value = 0.650"),
                       tags$li(tags$b("ุขุฒููู ฺฉููููฺฏุฑูู-ุงุณูุฑููู:"), "D = 0.072, p-value = 0.200"),
                       tags$li(tags$b("ูุชุฌู:"), "ูุฑ ุฏู ุขุฒููู ูุดุงู ูโุฏููุฏ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p > 0.05)"),
                       tags$li(tags$b("ุชุตูู:"), "ูโุชูุงู ุงุฒ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ")
                     )
                 ),
                 
                 div(class = "warning-box",
                     h4("ุฑูุดโูุง ุจุฑุฑุณ ููฺฏู ูุงุฑุงูุณ"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ููู (Levene's Test):"),
                               tags$ul(
                                 tags$li("Hโ: ูุงุฑุงูุณ ฺฏุฑููโูุง ุจุฑุงุจุฑ ุงุณุช"),
                                 tags$li("p-value > 0.05 โ ูุงุฑุงูุณโูุง ุจุฑุงุจุฑ ูุณุชูุฏ"),
                                 tags$li("โ ููุงูู ุจู ููุถ ูุฑูุงู ุจูุฏู"),
                                 tags$li("ููุงุณุจ ุจุฑุง ุจุดุชุฑ ุดุฑุงุท")
                               )),
                       tags$li(tags$b("ุขุฒููู F (F-test):"),
                               tags$ul(
                                 tags$li("ููุงุณู ูุงุฑุงูุณ ุฏู ฺฏุฑูู"),
                                 tags$li("p-value > 0.05 โ ูุงุฑุงูุณโูุง ุจุฑุงุจุฑ ูุณุชูุฏ"),
                                 tags$li("โ ุญุณุงุณ ุจู ููุถ ูุฑูุงู ุจูุฏู"),
                                 tags$li("ููุท ุจุฑุง ุฏู ฺฏุฑูู ูุณุชูู")
                               )),
                       tags$li(tags$b("ุขุฒููู ุจุงุฑุชูุช (Bartlett's Test):"),
                               tags$ul(
                                 tags$li("Hโ: ูุงุฑุงูุณ ููู ฺฏุฑููโูุง ุจุฑุงุจุฑ ุงุณุช"),
                                 tags$li("p-value > 0.05 โ ูุงุฑุงูุณโูุง ุจุฑุงุจุฑ ูุณุชูุฏ"),
                                 tags$li("โ ุญุณุงุณ ุจู ููุถ ูุฑูุงู ุจูุฏู"),
                                 tags$li("ููุงุณุจ ุจุฑุง ฺูุฏู ฺฏุฑูู")
                               )),
                       tags$li(tags$b("ูููุฏุงุฑ ุฌุนุจูโุง (Boxplot):"),
                               tags$ul(
                                 tags$li("ุนุฑุถ ุฌุนุจูโูุง ูุดุงุจู โ ูุงุฑุงูุณ ุจุฑุงุจุฑ"),
                                 tags$li("ุนุฑุถ ุฌุนุจูโูุง ูุชูุงูุช โ ูุงุฑุงูุณ ูุงุจุฑุงุจุฑ"),
                                 tags$li("โ ุฑูุด ฺฏุฑุงูฺฉ ู ุจุตุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ง ุดุจูโุณุงุฒ ุจุฑุฑุณ ูุฑูุงู ุจูุฏู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง"),
                          sliderInput("norm_check_mean", "ูุงูฺฏู:", 
                                      min = 0, max = 200, value = 100),
                          sliderInput("norm_check_sd", "ุงูุญุฑุงู ูุนุงุฑ:", 
                                      min = 1, max = 50, value = 15),
                          sliderInput("norm_check_n", "ุญุฌู ููููู:", 
                                      min = 10, max = 500, value = 100),
                          sliderInput("norm_check_skew", "ุฏุฑุฌู ฺููฺฏ:", 
                                      min = -2, max = 2, value = 0, step = 0.1),
                          actionButton("run_norm_check", "ุจุฑุฑุณ ูุฑูุงู ุจูุฏู")
                   ),
                   column(8,
                          plotOutput("norm_check_plot"),
                          verbatimTextOutput("norm_check_results")
                   )
                 ),
                 
                 h4("๐ ุฑุงูููุง ุชูุณุฑ ูุชุงุฌ ูุฑูุงูุช"),
                 tableOutput("normality_guide_table"),
                 
                 h3("โ๏ธ ุงูุฏุงูุงุช ุฏุฑ ุตูุฑุช ููุถ ูพุดโูุฑุถโูุง"),
                 div(class = "warning-box",
                     h4("ุงฺฏุฑ ุฏุงุฏูโูุง ูุฑูุงู ูุจุงุดูุฏ:"),
                     tags$ul(
                       tags$li(tags$b("ุงุณุชูุงุฏู ุงุฒ ุขุฒููู ูุงูพุงุฑุงูุชุฑ:"), "ูุงููุฏ ูู-ูุชู ุจู ุฌุง t-test"),
                       tags$li(tags$b("ุชุจุฏู ุฏุงุฏูโูุง:"), 
                               tags$ul(
                                 tags$li("ูฺฏุงุฑุชู (Log)"),
                                 tags$li("ุฌุฐุฑ (Square Root)"),
                                 tags$li("ูุนฺฉูุณ (Reciprocal)")
                               )),
                       tags$li(tags$b("ุงุณุชูุงุฏู ุงุฒ ุจูุชโุงุณุชุฑูพ (Bootstrap):"), "ุจุฑุง ุชุฎูู ูพุงุฑุงูุชุฑูุง"),
                       tags$li(tags$b("ุญุฐู ููุงุฏุฑ ูพุฑุช:"), "ุฏุฑ ุตูุฑุช ุชูุฌู ุนูู")
                     )
                 ),
                 
                 div(class = "info-box",
                     h4("ุงฺฏุฑ ูุงุฑุงูุณโูุง ูุงุจุฑุงุจุฑ ุจุงุดูุฏ:"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู t ุจุง ูุงุฑุงูุณ ูุงุจุฑุงุจุฑ:"), "Welch's t-test"),
                       tags$li(tags$b("ุชุจุฏู ุฏุงุฏูโูุง:"), "ุจุฑุง ุชุซุจุช ูุงุฑุงูุณ"),
                       tags$li(tags$b("ุงุณุชูุงุฏู ุงุฒ ุขุฒููู ูุงูพุงุฑุงูุชุฑ:"), "ูุงููุฏ ูู-ูุชู"),
                       tags$li(tags$b("ุชุบุฑ ุณุทุญ ูุนูโุฏุงุฑ:"), "ุงุณุชูุงุฏู ุงุฒ ฮฑ ฺฉูฺฺฉุชุฑ")
                     )
                 ),
                 
                 h3("๐ ุงูุฏุงุฒู ุงุซุฑ (Effect Size)"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h5("ุจุฑุง ุขุฒููู t"),
                              tags$ul(
                                tags$li(tags$b("d ฺฉููู:"), "(ูุงูฺฏูฑ - ูุงูฺฏูฒ) / ุงูุญุฑุงู ูุนุงุฑ ุชุฑฺฉุจ"),
                                tags$li(tags$b("ุชูุณุฑ:"),
                                        tags$ul(
                                          tags$li("d = 0.2: ุงุซุฑ ฺฉูฺฺฉ"),
                                          tags$li("d = 0.5: ุงุซุฑ ูุชูุณุท"),
                                          tags$li("d = 0.8: ุงุซุฑ ุจุฒุฑฺฏ")
                                        ))
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ"),
                              tags$ul(
                                tags$li(tags$b("r:"), "Z / โN"),
                                tags$li(tags$b("ุชูุณุฑ:"),
                                        tags$ul(
                                          tags$li("r = 0.1: ุงุซุฑ ฺฉูฺฺฉ"),
                                          tags$li("r = 0.3: ุงุซุฑ ูุชูุณุท"),
                                          tags$li("r = 0.5: ุงุซุฑ ุจุฒุฑฺฏ")
                                        ))
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุขุฒูููโูุง"),
                 tableOutput("tests_summary_table"),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู ุจุฑุง ูพฺููุดฺฏุฑุงู"),
                 div(class = "warning-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ููุดู ูพุดโูุฑุถโูุง ุขุฒููู ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ุงุฒ ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุงูุฏุงุฒู ุงุซุฑ ุฑุง ููุฑุงู ุจุง p-value ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ุจุฑุง ูุทุงูุนุงุช ููุฏูุงุช ุงุฒ ุณุทุญ ูุนูโุฏุงุฑ 0.05 ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุญุฌู ููููู ฺฉุงู ุจุฑุง ุชุงูู ุชูุงู ุขูุงุฑ ูุงุฒู ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ"),
                       tags$li("ูุชุงุฌ ุฑุง ุฏุฑ context ุจุงูู ุชูุณุฑ ฺฉูุฏ")
                     )
                 )
             )
           ),
           
           "multiple_groups" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขุฒูููโูุง ุจุฑุง ุจุด ุงุฒ ุฏู ฺฏุฑูู ูุณุชูู"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ูุฏู ุขุฒูููโูุง ฺูุฏฺฏุฑูู"),
                     p("ุฒูุงู ฺฉู ูโุฎูุงูู ุชูุงูุช ุจู ูุงูฺฏูโูุง ุง ุชูุฒุนโูุง ุจุด ุงุฒ ุฏู ฺฏุฑูู ูุณุชูู ุฑุง ุจุฑุฑุณ ฺฉููุ ุงุฒ ุงู ุขุฒูููโูุง ุงุณุชูุงุฏู ูโฺฉูู."),
                     tags$ul(
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ููุงุณู ุงุซุฑ ุณู ุฏุงุฑู ูุฎุชูู ุจุฑ ูุดุงุฑ ุฎูู"),
                                 tags$li("ููุงุณู ุณุทุญ ููุฏ ุฎูู ุฏุฑ ฺูุงุฑ ฺฏุฑูู ุณู ูุฎุชูู"),
                                 tags$li("ููุงุณู ุฒูุงู ุจูุจูุฏ ุฏุฑ ุจูุงุฑุงู ุจุง ุฏุฑุฌุงุช ูุฎุชูู ุจูุงุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุจุฑุง ฺูุฏ ฺฏุฑูู"),
                 div(class = "success-box",
                     h4("ุขูุงูุฒ ูุงุฑุงูุณ ฺฉุทุฑูู (One-Way ANOVA)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏู ุณู ุง ฺูุฏ ฺฏุฑูู ูุณุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ฮผโ = ฮผโ = ฮผโ = ... (ููู ูุงูฺฏูโูุง ุจุฑุงุจุฑูุฏ)"),
                                 tags$li("Hโ: ุญุฏุงูู ุฏู ูุงูฺฏู ุจุง ูู ุชูุงูุช ุฏุงุฑูุฏ")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ู ูพูุณุชู ุจุงุดูุฏ"),
                                 tags$li("ุฏุงุฏูโูุง ุฏุฑ ูุฑ ฺฏุฑูู ูุฑูุงู ุจุงุดูุฏ"),
                                 tags$li("ูุงุฑุงูุณ ฺฏุฑููโูุง ุจุฑุงุจุฑ ุจุงุดุฏ (ููฺฏู ูุงุฑุงูุณ)"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ูุงูฺฏู ูุดุงุฑ ุฎูู ุฏุฑ ฺูุงุฑ ฺฏุฑูู ุฏุฑูุงู ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ููุงูู ูพุงู ุฏุฑ ANOVA"),
                 div(class = "info-box",
                     h4("ููุงุจุน ุชุบุฑูพุฐุฑ ุฏุฑ ANOVA"),
                     tags$ul(
                       tags$li(tags$b("ุชุบุฑูพุฐุฑ ุฏุฑููโฺฏุฑูู (Within-group):"), "ูพุฑุงฺฉูุฏฺฏ ุฏุงุฏูโูุง ุญูู ูุงูฺฏู ูุฑ ฺฏุฑูู"),
                       tags$li(tags$b("ุชุบุฑูพุฐุฑ ุจูโฺฏุฑูู (Between-group):"), "ูพุฑุงฺฉูุฏฺฏ ูุงูฺฏู ฺฏุฑููโูุง ุญูู ูุงูฺฏู ฺฉู"),
                       tags$li(tags$b("ุขูุงุฑู F:"), "ูุณุจุช ุชุบุฑูพุฐุฑ ุจูโฺฏุฑูู ุจู ุชุบุฑูพุฐุฑ ุฏุฑููโฺฏุฑูู"),
                       p("F = (ุจูโฺฏุฑูู / ุฏุฑุฌู ุขุฒุงุฏ ุจูโฺฏุฑูู) / (ุฏุฑููโฺฏุฑูู / ุฏุฑุฌู ุขุฒุงุฏ ุฏุฑููโฺฏุฑูู)")
                     )
                 ),
                 
                 h3("โ๏ธ ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ ุจุฑุง ฺูุฏ ฺฏุฑูู"),
                 div(class = "warning-box",
                     h4("ุขุฒููู ฺฉุฑุงุณฺฉุงู-ูุงูุณ (Kruskal-Wallis)"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ุชูุฒุน ุณู ุง ฺูุฏ ฺฏุฑูู ูุณุชูู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ุชูุฒุน ููู ฺฏุฑููโูุง ฺฉุณุงู ุงุณุช"),
                                 tags$li("Hโ: ุญุฏุงูู ุฏู ฺฏุฑูู ุชูุฒุน ูุชูุงูุช ุฏุงุฑูุฏ")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉู ุง ุชุฑุชุจ ุจุงุดูุฏ"),
                                 tags$li("ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ููุงุณู ุณุทุญ ุฏุฑุฏ ุฏุฑ ุจูุงุฑุงู ุจุง ุณู ุฑูุด ุฏุฑูุงู ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ุขุฒูููโูุง ุชุนูุจ (Post-hoc Tests)"),
                 div(class = "highlight-box",
                     h4("ูุฏู ุขุฒูููโูุง ุชุนูุจ"),
                     p("ุฒูุงู ฺฉู ANOVA ุง ฺฉุฑุงุณฺฉุงู-ูุงูุณ ูุนูโุฏุงุฑ ุจุงุดุฏุ ุงุฒ ุขุฒูููโูุง ุชุนูุจ ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ฺฉุฏุงู ฺฏุฑููโูุง ุจุง ูู ุชูุงูุช ุฏุงุฑูุฏ ุงุณุชูุงุฏู ูโฺฉูู."),
                     
                     h5("ุจุฑุง ANOVA (ูพุงุฑุงูุชุฑ):"),
                     tags$ul(
                       tags$li(tags$b("ุชูู (Tukey HSD):"), "ููุงุณู ุชูุงู ุฌูุช ฺฏุฑููโูุง ุจุง ฺฉูุชุฑู ุฎุทุง ููุน ุงูู"),
                       tags$li(tags$b("ุดูู (Scheffe):"), "ูุญุงูุธูโฺฉุงุฑุงููโุชุฑุ ููุงุณุจ ุจุฑุง ููุงุณูโูุง ุจุฑูุงููโุฑุฒ ูุดุฏู"),
                       tags$li(tags$b("ุจูููุฑูู (Bonferroni):"), "ุงุตูุงุญ ุณุงุฏู ุจุฑุง ููุงุณูโูุง ฺูุฏฺฏุงูู")
                     ),
                     
                     h5("ุจุฑุง ฺฉุฑุงุณฺฉุงู-ูุงูุณ (ูุงูพุงุฑุงูุชุฑ):"),
                     tags$ul(
                       tags$li(tags$b("ุฏุงู (Dunn's test):"), "ููุงุณู ุฌูุช ฺฏุฑููโูุง ุจุง ุงุตูุงุญ ุจูููุฑูู"),
                       tags$li(tags$b("ูู-ูู (Nemenyi test):"), "ูุดุงุจู ุชูฺฉ ุจุฑุง ุฏุงุฏูโูุง ูุงูพุงุฑุงูุชุฑ")
                     )
                 ),
                 
                 h3("๐ ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู"),
                 tableOutput("multi_group_test_guide"),
                 
                 h3("๐ง ุดุจูโุณุงุฒ ANOVA"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ฺฏุฑููโูุง"),
                          numericInput("anova_n_groups", "ุชุนุฏุงุฏ ฺฏุฑููโูุง:", 
                                       value = 3, min = 3, max = 6),
                          
                          conditionalPanel(
                            condition = "input.anova_n_groups >= 3",
                            h5("ูุงูฺฏู ฺฏุฑููโูุง:"),
                            numericInput("group1_mean", "ฺฏุฑูู ฑ:", value = 100),
                            numericInput("group2_mean", "ฺฏุฑูู ฒ:", value = 110),
                            numericInput("group3_mean", "ฺฏุฑูู ณ:", value = 105)
                          ),
                          
                          conditionalPanel(
                            condition = "input.anova_n_groups >= 4",
                            numericInput("group4_mean", "ฺฏุฑูู ด:", value = 115)
                          ),
                          
                          conditionalPanel(
                            condition = "input.anova_n_groups >= 5",
                            numericInput("group5_mean", "ฺฏุฑูู ต:", value = 95)
                          ),
                          
                          conditionalPanel(
                            condition = "input.anova_n_groups >= 6",
                            numericInput("group6_mean", "ฺฏุฑูู ถ:", value = 120)
                          ),
                          
                          numericInput("anova_sd", "ุงูุญุฑุงู ูุนุงุฑ (ฺฉุณุงู ุจุฑุง ููู ฺฏุฑููโูุง):", 
                                       value = 15),
                          numericInput("anova_n_per_group", "ุชุนุฏุงุฏ ููููู ุฏุฑ ูุฑ ฺฏุฑูู:", 
                                       value = 30),
                          selectInput("anova_alpha", "ุณุทุญ ูุนูโุฏุงุฑ:",
                                      choices = c("0.01" = 0.01, "0.05" = 0.05, "0.10" = 0.10),
                                      selected = "0.05"),
                          actionButton("run_anova", "ุงูุฌุงู ANOVA")
                   ),
                   column(8,
                          plotOutput("anova_plot"),
                          verbatimTextOutput("anova_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ฺฉุฑุงุณฺฉุงู-ูุงูุณ"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง"),
                          numericInput("kw_n_groups", "ุชุนุฏุงุฏ ฺฏุฑููโูุง:", 
                                       value = 3, min = 3, max = 6),
                          
                          conditionalPanel(
                            condition = "input.kw_n_groups >= 3",
                            h5("ูุงูฺฏู ุฑุชุจู ฺฏุฑููโูุง:"),
                            numericInput("kw_group1_rank", "ฺฏุฑูู ฑ:", value = 25),
                            numericInput("kw_group2_rank", "ฺฏุฑูู ฒ:", value = 35),
                            numericInput("kw_group3_rank", "ฺฏุฑูู ณ:", value = 30)
                          ),
                          
                          conditionalPanel(
                            condition = "input.kw_n_groups >= 4",
                            numericInput("kw_group4_rank", "ฺฏุฑูู ด:", value = 40)
                          ),
                          
                          conditionalPanel(
                            condition = "input.kw_n_groups >= 5",
                            numericInput("kw_group5_rank", "ฺฏุฑูู ต:", value = 20)
                          ),
                          
                          conditionalPanel(
                            condition = "input.kw_n_groups >= 6",
                            numericInput("kw_group6_rank", "ฺฏุฑูู ถ:", value = 45)
                          ),
                          
                          numericInput("kw_n_per_group", "ุชุนุฏุงุฏ ููููู ุฏุฑ ูุฑ ฺฏุฑูู:", 
                                       value = 30),
                          actionButton("run_kw", "ุงูุฌุงู ฺฉุฑุงุณฺฉุงู-ูุงูุณ")
                   ),
                   column(8,
                          plotOutput("kw_plot"),
                          verbatimTextOutput("kw_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ููุงุณู ุณู ุฑูุด ุฏุฑูุงู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุณู ุฑูุด ุฏุฑูุงู A, B, C ุจุฑ ุณุทุญ ููุฏ ุฎูู ุงุซุฑ ูุชูุงูุช ุฏุงุฑูุฏุ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุณุทุญ ููุฏ ุฎูู ุจูุงุฑุงู (ฺฉู)"),
                                tags$li(tags$b("ุชูุฒุน:"), "ูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู ุงุตู:"), "ANOVA"),
                                tags$li(tags$b("ุขุฒููู ุชุนูุจ:"), "ุชูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p-value = 0.02"),
                                tags$li(tags$b("ูุชุฌู:"), "ุญุฏุงูู ุฏู ุฑูุด ุจุง ูู ุชูุงูุช ุฏุงุฑูุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ูุซุงู ฒ: ููุงุณู ุณุทุญ ุฏุฑุฏ ุฏุฑ ฺูุงุฑ ฺฏุฑูู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุณุทุญ ุฏุฑุฏ ุฏุฑ ฺูุงุฑ ฺฏุฑูู ุณู ูุฎุชูู ุชูุงูุช ุฏุงุฑุฏุ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุณุทุญ ุฏุฑุฏ (ุชุฑุชุจ)"),
                                tags$li(tags$b("ุชูุฒุน:"), "ุบุฑูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู ุงุตู:"), "ฺฉุฑุงุณฺฉุงู-ูุงูุณ"),
                                tags$li(tags$b("ุขุฒููู ุชุนูุจ:"), "ุฏุงู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p-value = 0.03"),
                                tags$li(tags$b("ูุชุฌู:"), "ุชูุงูุช ูุนูโุฏุงุฑ ุจู ฺฏุฑููโูุง ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุงูุฏุงุฒู ุงุซุฑ ุฏุฑ ุขุฒูููโูุง ฺูุฏฺฏุฑูู"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ANOVA"),
                              tags$ul(
                                tags$li(tags$b("ุงุชุง ูุฑุจุน (ฮทยฒ):"), "ูุณุจุช ูุงุฑุงูุณ ุชุจูโุดุฏู ุจู ูุงุฑุงูุณ ฺฉู"),
                                tags$li(tags$b("ุชูุณุฑ:"),
                                        tags$ul(
                                          tags$li("ฮทยฒ = 0.01: ุงุซุฑ ฺฉูฺฺฉ"),
                                          tags$li("ฮทยฒ = 0.06: ุงุซุฑ ูุชูุณุท"),
                                          tags$li("ฮทยฒ = 0.14: ุงุซุฑ ุจุฒุฑฺฏ")
                                        ))
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ฺฉุฑุงุณฺฉุงู-ูุงูุณ"),
                              tags$ul(
                                tags$li(tags$b("ฮตยฒ (ุงูพุณููู ูุฑุจุน):"), "ุงูุฏุงุฒู ุงุซุฑ ูุจุชู ุจุฑ ุฑุชุจูโูุง"),
                                tags$li(tags$b("ุชูุณุฑ:"),
                                        tags$ul(
                                          tags$li("ฮตยฒ = 0.01: ุงุซุฑ ฺฉูฺฺฉ"),
                                          tags$li("ฮตยฒ = 0.08: ุงุซุฑ ูุชูุณุท"),
                                          tags$li("ฮตยฒ = 0.26: ุงุซุฑ ุจุฒุฑฺฏ")
                                        ))
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ุจุฑุฑุณ ูพุดโูุฑุถโูุง ANOVA"),
                 div(class = "warning-box",
                     h4("ุฑูุดโูุง ุจุฑุฑุณ ูพุดโูุฑุถโูุง"),
                     tags$ul(
                       tags$li(tags$b("ูุฑูุงู ุจูุฏู:"),
                               tags$ul(
                                 tags$li("ุขุฒููู ุดุงูพุฑู-ููฺฉ ุจุฑุง ูุฑ ฺฏุฑูู"),
                                 tags$li("ูููุฏุงุฑ Q-Q ุจุฑุง ูุฑ ฺฏุฑูู"),
                                 tags$li("ANOVA ูุณุจุชุงู ููุงูู ุจู ููุถ ุฌุฒุฆ ูุฑูุงู ุจูุฏู ุงุณุช")
                               )),
                       tags$li(tags$b("ููฺฏู ูุงุฑุงูุณ:"),
                               tags$ul(
                                 tags$li("ุขุฒููู ููู (Levene's test)"),
                                 tags$li("ุขุฒููู ุจุงุฑุชูุช (Bartlett's test)"),
                                 tags$li("ูููุฏุงุฑ ุฌุนุจูโุง ุจุฑุง ุจุฑุฑุณ ุจุตุฑ")
                               )),
                       tags$li(tags$b("ุงูุฏุงูุงุช ุฏุฑ ุตูุฑุช ููุถ ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุชุจุฏู ุฏุงุฏูโูุง (ูฺฏุงุฑุชูุ ุฌุฐุฑ)"),
                                 tags$li("ุงุณุชูุงุฏู ุงุฒ ุขุฒููู ูุงูพุงุฑุงูุชุฑ (ฺฉุฑุงุณฺฉุงู-ูุงูุณ)"),
                                 tags$li("ุงุณุชูุงุฏู ุงุฒ ANOVA ุจุง ุงุตูุงุญ ููฺ (Welch)")
                               ))
                     )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุขุฒูููโูุง ฺูุฏฺฏุฑูู"),
                 tableOutput("multi_group_summary_table"),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู ุจุฑุง ูพฺููุดฺฏุฑุงู"),
                 div(class = "highlight-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ููุดู ูพุดโูุฑุถโูุง ANOVA ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุงฺฏุฑ ANOVA ูุนูโุฏุงุฑ ุดุฏุ ุญุชูุงู ุงุฒ ุขุฒููู ุชุนูุจ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ุงุฒ ฺฉุฑุงุณฺฉุงู-ูุงูุณ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุงูุฏุงุฒู ุงุซุฑ ุฑุง ููุฑุงู ุจุง p-value ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ุฏุฑ ฺฏุฒุงุฑุด ูุชุงุฌุ ููุงุฏุฑ ุฏูู p-value ุฑุง ุฐฺฉุฑ ฺฉูุฏ"),
                       tags$li("ุงุฒ ูููุฏุงุฑูุง ููุงุณุจ ุจุฑุง ููุงุด ุชูุงูุช ฺฏุฑููโูุง ุงุณุชูุงุฏู ฺฉูุฏ")
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                 div(class = "info-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                     h5("ุจุฑุง ANOVA:"),
                     p("F(ุฏุฑุฌู ุขุฒุงุฏ ุจู, ุฏุฑุฌู ุขุฒุงุฏ ุฏุฑูู) = ููุฏุงุฑ F, p = ููุฏุงุฑ p, ฮทยฒ = ุงูุฏุงุฒู ุงุซุฑ"),
                     p("ูุซุงู: F(2, 87) = 5.43, p = 0.006, ฮทยฒ = 0.11"),
                     
                     h5("ุจุฑุง ฺฉุฑุงุณฺฉุงู-ูุงูุณ:"),
                     p("H(ุฏุฑุฌู ุขุฒุงุฏ) = ููุฏุงุฑ H, p = ููุฏุงุฑ p, ฮตยฒ = ุงูุฏุงุฒู ุงุซุฑ"),
                     p("ูุซุงู: H(2) = 8.76, p = 0.013, ฮตยฒ = 0.15"),
                     
                     h5("ุจุฑุง ุขุฒูููโูุง ุชุนูุจ:"),
                     p("ูุชุงุฌ ุขุฒููู ุชูฺฉ ูุดุงู ุฏุงุฏ ฺฉู ฺฏุฑูู A ุจู ุทูุฑ ูุนูโุฏุงุฑ ุงุฒ ฺฏุฑูู B ูุชูุงูุช ุงุณุช (p = 0.02)ุ ุงูุง ุชูุงูุช ุจู ฺฏุฑูู A ู C ูุนูโุฏุงุฑ ูุจูุฏ (p = 0.45).")
                 )
             )
           ),
           
           "categorical_tests" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขุฒูููโูุง ุขูุงุฑ ุจุฑุง ูุชุบุฑูุง ฺฉู"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ูุฏู ุขุฒูููโูุง ูุชุบุฑูุง ฺฉู"),
                     p("ุงู ุขุฒูููโูุง ุจุฑุง ุจุฑุฑุณ ุฑุงุจุทู ุจู ูุชุบุฑูุง ฺฉู (ุงุณู ู ุชุฑุชุจ) ุงุณุชูุงุฏู ูโุดููุฏ. ุฒูุงู ฺฉู ุฏุงุฏูโูุง ูุง ุจู ุตูุฑุช ุฏุณุชูโุง ูุณุชูุฏ ู ููโุชูุงู ุงุฒ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ฺฉุฑุฏุ ุงุฒ ุงู ุขุฒูููโูุง ุจูุฑู ูโฺฏุฑู."),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑูุง ฺฉู ุงุณู:"), "ฺฏุฑูู ุฎููุ ุฌูุณุชุ ููุน ุจูุงุฑ"),
                       tags$li(tags$b("ูุชุบุฑูุง ฺฉู ุชุฑุชุจ:"), "ุฏุฑุฌู ุณุฑุทุงูุ ุณุทุญ ุฏุฑุฏุ ูุฒุงู ุฑุถุงุช"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ุจุฑุฑุณ ุฑุงุจุทู ุจู ุฌูุณุช ู ููุน ุจูุงุฑ"),
                                 tags$li("ููุงุณู ุงุซุฑ ุจุฎุด ุฏุฑูุงูโูุง ุฏุฑ ฺฏุฑููโูุง ูุฎุชูู"),
                                 tags$li("ุจุฑุฑุณ ุงุฑุชุจุงุท ุนูุงูู ุฎุทุฑ ุจุง ุจุฑูุฒ ุจูุงุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุขุฒููู ฺฉุง-ุฏู (Chi-Square Test)"),
                 div(class = "success-box",
                     h4("ุขุฒููู ฺฉุง-ุฏู ุจุฑุง ุงุณุชููุงู"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ุจุฑุฑุณ ุงุณุชููุงู ุง ุฑุงุจุทู ุจู ุฏู ูุชุบุฑ ฺฉู"),
                       tags$li(tags$b("ูุฑุถูโูุง:"),
                               tags$ul(
                                 tags$li("Hโ: ุฏู ูุชุบุฑ ูุณุชูู ูุณุชูุฏ (ุงุฑุชุจุงุท ูุฏุงุฑูุฏ)"),
                                 tags$li("Hโ: ุฏู ูุชุบุฑ ูุงุจุณุชู ูุณุชูุฏ (ุงุฑุชุจุงุท ุฏุงุฑูุฏ)")
                               )),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ุฏุฑ ุฌุฏูู ุชูุงูู ูุฑุงุฑ ฺฏุฑูุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจุงุดูุฏ"),
                                 tags$li("ุญุฏุงูู ธฐูช ุฎุงููโูุง ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ โฅ ต ุฏุงุดุชู ุจุงุดูุฏ"),
                                 tags$li("ูฺ ุฎุงููโุง ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ ุตูุฑ ูุฏุงุดุชู ุจุงุดุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุจุฑุฑุณ ุฑุงุจุทู ุจู ุณฺฏุงุฑ ฺฉุดุฏู ู ุณุฑุทุงู ุฑู")
                     )
                 ),
                 
                 h3("โ๏ธ ุขุฒููู ูุดุฑ (Fisher's Exact Test)"),
                 div(class = "warning-box",
                     h4("ฺฉุงุฑุจุฑุฏ ุขุฒููู ูุดุฑ"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ุจุฑุฑุณ ุงุณุชููุงู ุฏู ูุชุบุฑ ฺฉู ุฏุฑ ูููููโูุง ฺฉูฺฺฉ"),
                       tags$li(tags$b("ููุงุฑุฏ ุงุณุชูุงุฏู:"),
                               tags$ul(
                                 tags$li("ุญุฌู ููููู ฺฉูฺฺฉ (n < 20)"),
                                 tags$li("ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ ุฏุฑ ุจุฑุฎ ุฎุงููโูุง ฺฉูุชุฑ ุงุฒ ต ุจุงุดุฏ"),
                                 tags$li("ุฌุฏูู ฒรฒ"),
                                 tags$li("ุฏุงุฏูโูุง ุจุณุงุฑ ูุงุฏุฑ ุง sparse")
                               )),
                       tags$li(tags$b("ูุฒุงุง:"),
                               tags$ul(
                                 tags$li("ูุงุฒ ุจู ูพุดโูุฑุถโูุง ฺฉูุชุฑ"),
                                 tags$li("ุฏูุช ุจุงูุง ุฏุฑ ูููููโูุง ฺฉูฺฺฉ"),
                                 tags$li("ููุงุณุจ ุจุฑุง ุฏุงุฏูโูุง ูุงุฏุฑ")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), "ุจุฑุฑุณ ุฑุงุจุทู ุจู ฺฉ ุจูุงุฑ ูุงุฏุฑ ู ฺฉ ุนุงูู ุฎุทุฑ")
                     )
                 ),
                 
                 h3("๐ ุขุฒููู ูุณุจุช (Proportion Test)"),
                 div(class = "info-box",
                     h4("ุขุฒูููโูุง ุจุฑุง ููุงุณู ูุณุจุชโูุง"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ูุณุจุช ฺฉ ูููููโุง:"), 
                               "ููุงุณู ูุณุจุช ูุดุงูุฏู ุดุฏู ุจุง ฺฉ ููุฏุงุฑ ูุฑุถ"),
                       tags$li(tags$b("ุขุฒููู ูุณุจุช ุฏู ูููููโุง:"), 
                               "ููุงุณู ุฏู ูุณุจุช ูุณุชูู ุงุฒ ูู"),
                       tags$li(tags$b("ุขุฒููู ูุณุจุช ฺูุฏ ูููููโุง:"), 
                               "ููุงุณู ฺูุฏ ูุณุจุช ุจุง ูู"),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), 
                               "ููุงุณู ูุฑุฎ ุจูุจูุฏ ุฏุฑ ุฏู ุฑูุด ุฏุฑูุงู ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ุขุฒููู ูฺฉ ููุงุฑ (McNemar's Test)"),
                 div(class = "highlight-box",
                     h4("ุขุฒููู ูฺฉ ููุงุฑ ุจุฑุง ุฏุงุฏูโูุง ูุงุจุณุชู"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), 
                               "ููุงุณู ุฏู ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ ุฑู ฺฉ ููููู"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"),
                               tags$ul(
                                 tags$li("ูุจู ู ุจุนุฏ ุงุฒ ุฏุฑูุงู"),
                                 tags$li("ุฏู ุฑูุด ุงูุฏุงุฒูโฺฏุฑ ุฑู ฺฉ ููููู"),
                                 tags$li("ุฏุงุฏูโูุง ุฌูุชโุดุฏู ฺฉู")
                               )),
                       tags$li(tags$b("ูุซุงู ูพุฒุดฺฉ:"), 
                               "ุจุฑุฑุณ ุชุบุฑ ูุถุนุช ุจูุงุฑุงู ูุจู ู ุจุนุฏ ุงุฒ ุฏุฑูุงู")
                     )
                 ),
                 
                 h3("๐ ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู"),
                 tableOutput("categorical_test_selection_guide"),
                 
                 h3("๐ง ุดุจูโุณุงุฒ ุขุฒููู ฺฉุง-ุฏู"),
                 fluidRow(
                   column(4,
                          h4("ุฏุงุฏูโูุง ุฌุฏูู ุชูุงูู"),
                          numericInput("chi2_row1_col1", "ุฑุฏู ฑ - ุณุชูู ฑ:", value = 30),
                          numericInput("chi2_row1_col2", "ุฑุฏู ฑ - ุณุชูู ฒ:", value = 20),
                          numericInput("chi2_row2_col1", "ุฑุฏู ฒ - ุณุชูู ฑ:", value = 25),
                          numericInput("chi2_row2_col2", "ุฑุฏู ฒ - ุณุชูู ฒ:", value = 25),
                          selectInput("chi2_alpha", "ุณุทุญ ูุนูโุฏุงุฑ:",
                                      choices = c("0.01" = 0.01, "0.05" = 0.05, "0.10" = 0.10),
                                      selected = "0.05"),
                          actionButton("run_chi2", "ุงูุฌุงู ุขุฒููู ฺฉุง-ุฏู")
                   ),
                   column(8,
                          plotOutput("chi2_plot"),
                          verbatimTextOutput("chi2_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู ูุดุฑ"),
                 fluidRow(
                   column(4,
                          h4("ุฏุงุฏูโูุง ุฌุฏูู ฒรฒ"),
                          numericInput("fisher_row1_col1", "ุฑุฏู ฑ - ุณุชูู ฑ:", value = 8),
                          numericInput("fisher_row1_col2", "ุฑุฏู ฑ - ุณุชูู ฒ:", value = 2),
                          numericInput("fisher_row2_col1", "ุฑุฏู ฒ - ุณุชูู ฑ:", value = 1),
                          numericInput("fisher_row2_col2", "ุฑุฏู ฒ - ุณุชูู ฒ:", value = 9),
                          actionButton("run_fisher", "ุงูุฌุงู ุขุฒููู ูุดุฑ")
                   ),
                   column(8,
                          plotOutput("fisher_plot"),
                          verbatimTextOutput("fisher_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ุฑุงุจุทู ุณฺฏุงุฑ ู ุณุฑุทุงู ุฑู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุณฺฏุงุฑ (ุจู/ุฎุฑ) ู ุณุฑุทุงู ุฑู (ุฏุงุฑุฏ/ูุฏุงุฑุฏ)"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุฌุฏูู ฒรฒ ุจุง ุญุฌู ููููู ุจุฒุฑฺฏ"),
                                tags$li(tags$b("ุขุฒููู:"), "ฺฉุง-ุฏู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ฯยฒ = 15.8, p < 0.001"),
                                tags$li(tags$b("ูุชุฌู:"), "ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุณฺฏุงุฑ ู ุณุฑุทุงู ุฑู ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ูุซุงู ฒ: ุงุซุฑ ุฏุงุฑู ุจุฑ ุจูุงุฑ ูุงุฏุฑ"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุฏุงุฑู (ุฌุฏุฏ/ูุฏู) ู ุจูุจูุฏ (ุจู/ุฎุฑ)"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุฌุฏูู ฒรฒ ุจุง ูุฑุงูุงู ฺฉู"),
                                tags$li(tags$b("ุขุฒููู:"), "ูุดุฑ"),
                                tags$li(tags$b("ูุชุงุฌ:"), "p = 0.045"),
                                tags$li(tags$b("ูุชุฌู:"), "ุฏุงุฑู ุฌุฏุฏ ุงุซุฑ ูุนูโุฏุงุฑ ุฏุงุฑุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุงูุฏุงุฒู ุงุซุฑ ุฏุฑ ุขุฒูููโูุง ฺฉู"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ุจุฑุง ุฌุฏูู ฒรฒ"),
                              tags$ul(
                                tags$li(tags$b("ุถุฑุจ ู (ฯ):"), "ุจุฑุง ุฌุฏูู ฒรฒ"),
                                tags$li(tags$b("ฺฉุฑุงูุฑุฒ V:"), "ุจุฑุง ุฌุฏูู ุจุฒุฑฺฏุชุฑ"),
                                tags$li(tags$b("ุชูุณุฑ:"),
                                        tags$ul(
                                          tags$li("0.1 > : ุงุซุฑ ฺฉูฺฺฉ"),
                                          tags$li("0.3 > : ุงุซุฑ ูุชูุณุท"),
                                          tags$li("0.5 > : ุงุซุฑ ุจุฒุฑฺฏ")
                                        ))
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ูุณุจุช ุดุงูุณ (Odds Ratio)"),
                              tags$ul(
                                tags$li("OR = 1: ุนุฏู ุงุฑุชุจุงุท"),
                                tags$li("OR > 1: ุงุฑุชุจุงุท ูุซุจุช"),
                                tags$li("OR < 1: ุงุฑุชุจุงุท ููู"),
                                tags$li("ูุงุตูู ุงุทููุงู ุดุงูู ฑ ูุจุงุดุฏ: ูุนูโุฏุงุฑ")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ุจุฑุฑุณ ูพุดโูุฑุถโูุง ุขุฒููู ฺฉุง-ุฏู"),
                 div(class = "warning-box",
                     h4("ุฑูุดโูุง ุจุฑุฑุณ ูพุดโูุฑุถโูุง"),
                     tags$ul(
                       tags$li(tags$b("ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ:"),
                               tags$ul(
                                 tags$li("ูุญุงุณุจู ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ ุจุฑุง ูุฑ ุฎุงูู"),
                                 tags$li("ูุฑููู: (ูุฌููุน ุณุทุฑ ร ูุฌููุน ุณุชูู) / ฺฉู"),
                                 tags$li("ุญุฏุงูู ธฐูช ุฎุงููโูุง ุจุงุฏ โฅ ต ุจุงุดูุฏ"),
                                 tags$li("ูฺ ุฎุงููโุง ุตูุฑ ูุจุงุดุฏ")
                               )),
                       tags$li(tags$b("ุงูุฏุงูุงุช ุฏุฑ ุตูุฑุช ููุถ ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุงุฏุบุงู ุฏุณุชูโูุง (ุฏุฑ ุตูุฑุช ูุนูโุฏุงุฑ ุจูุฏู)"),
                                 tags$li("ุงุณุชูุงุฏู ุงุฒ ุขุฒููู ูุดุฑ"),
                                 tags$li("ุงุณุชูุงุฏู ุงุฒ ุดุจูโุณุงุฒ ูููุช ฺฉุงุฑูู")
                               ))
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุจุฑุฑุณ ูพุดโูุฑุถ ฺฉุง-ุฏู"),
                 fluidRow(
                   column(4,
                          h4("ุฏุงุฏูโูุง ุฌุฏูู"),
                          numericInput("assumption_row1_col1", "ุฑุฏู ฑ - ุณุชูู ฑ:", value = 15),
                          numericInput("assumption_row1_col2", "ุฑุฏู ฑ - ุณุชูู ฒ:", value = 10),
                          numericInput("assumption_row2_col1", "ุฑุฏู ฒ - ุณุชูู ฑ:", value = 5),
                          numericInput("assumption_row2_col2", "ุฑุฏู ฒ - ุณุชูู ฒ:", value = 20),
                          actionButton("check_assumptions", "ุจุฑุฑุณ ูพุดโูุฑุถโูุง")
                   ),
                   column(8,
                          plotOutput("assumption_plot"),
                          verbatimTextOutput("assumption_results")
                   )
                 ),
                 
                 h3("๐ ุขุฒูููโูุง ุจุฑุง ูุชุบุฑูุง ุชุฑุชุจ"),
                 div(class = "info-box",
                     h4("ุขุฒูููโูุง ูฺู ุฏุงุฏูโูุง ุชุฑุชุจ"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ุชุฑูุฏ ฺฉุงฺฉุฑุงู-ุขุฑูุชุงฺ:"), 
                               "ุจุฑุฑุณ ุฑููุฏ ุฎุท ุฏุฑ ุฏุงุฏูโูุง ุชุฑุชุจ"),
                       tags$li(tags$b("ุขุฒููู ูู-ูุชู:"), 
                               "ููุงุณู ุฏู ฺฏุฑูู ูุณุชูู ุจุง ุฏุงุฏูโูุง ุชุฑุชุจ"),
                       tags$li(tags$b("ุขุฒููู ฺฉุฑุงุณฺฉุงู-ูุงูุณ:"), 
                               "ููุงุณู ฺูุฏ ฺฏุฑูู ูุณุชูู ุจุง ุฏุงุฏูโูุง ุชุฑุชุจ"),
                       tags$li(tags$b("ุขุฒููู ููฺฉุงฺฉุณูู:"), 
                               "ููุงุณู ุฏู ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู ุจุง ุฏุงุฏูโูุง ุชุฑุชุจ")
                     )
                 ),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู ุจุฑุง ูพฺููุดฺฏุฑุงู"),
                 div(class = "highlight-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ููุดู ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุจุฑุง ูููููโูุง ฺฉูฺฺฉ ุงุฒ ุขุฒููู ูุดุฑ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุงูุฏุงุฒู ุงุซุฑ ุฑุง ููุฑุงู ุจุง p-value ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ุฏุฑ ุตูุฑุช ุงูฺฉุงูุ ูุณุจุช ุดุงูุณ ู ูุงุตูู ุงุทููุงู ุขู ุฑุง ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุชุฑุชุจ ุงุฒ ุขุฒูููโูุง ููุงุณุจ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุงุฒ ุงุฏุบุงู ุฏุณุชูโูุง ุจุฏูู ุชูุฌู ุนูู ุฎูุฏุฏุงุฑ ฺฉูุฏ")
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                 div(class = "success-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                     h5("ุจุฑุง ุขุฒููู ฺฉุง-ุฏู:"),
                     p("ฯยฒ(ุฏุฑุฌู ุขุฒุงุฏ, N = ุญุฌู ููููู) = ููุฏุงุฑ ฺฉุง-ุฏู, p = ููุฏุงุฑ p, ฯ/V = ุงูุฏุงุฒู ุงุซุฑ"),
                     p("ูุซุงู: ฯยฒ(1, N = 100) = 15.8, p < 0.001, ฯ = 0.40"),
                     
                     h5("ุจุฑุง ุขุฒููู ูุดุฑ:"),
                     p("ุขุฒููู ูุดุฑ: p = ููุฏุงุฑ p, OR = ูุณุจุช ุดุงูุณ"),
                     p("ูุซุงู: p = 0.045, OR = 4.5"),
                     
                     h5("ุชูุณุฑ:"),
                     p("ูุชุงุฌ ูุดุงู ุฏุงุฏ ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุณฺฏุงุฑ ฺฉุดุฏู ู ุณุฑุทุงู ุฑู ูุฌูุฏ ุฏุงุฑุฏ (ฯยฒ = 15.8, p < 0.001). ุงูุฏุงุฒู ุงุซุฑ ูุชูุณุท (ฯ = 0.40) ูุดุงู ูโุฏูุฏ ุงู ุฑุงุจุทู ุงุฒ ูุธุฑ ุจุงูู ูุฒ ูุงุจู ุชูุฌู ุงุณุช.")
                 )
             )
           ),
           
           # ุจุฎุด ุขูุงูุฒ ฺฉููุงุฑุงูุณ (ANCOVA)
           "ancova" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุขูุงูุฒ ฺฉููุงุฑุงูุณ (ANCOVA)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ANCOVA"),
                     p("ุขูุงูุฒ ฺฉููุงุฑุงูุณ (ANCOVA) ุชุฑฺฉุจ ุงุฒ ANOVA ู ุฑฺฏุฑุณูู ุงุณุช ฺฉู ุจุฑุง ฺฉูุชุฑู ุงุซุฑ ูุชุบุฑูุง ฺฉูู ูุฒุงุญู (ฺฉููุงุฑุงุช) ููฺฏุงู ููุงุณู ฺฏุฑููโูุง ุงุณุชูุงุฏู ูโุดูุฏ."),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏู ฺฏุฑููโูุง ูพุณ ุงุฒ ฺฉูุชุฑู ุงุซุฑ ูุชุบุฑูุง ฺฉูู"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ููุงุณู ุงุซุฑ ุฏุฑูุงูโูุง ูพุณ ุงุฒ ฺฉูุชุฑู ุณู ุจูุงุฑุงู"),
                                 tags$li("ุจุฑุฑุณ ุชูุงูุช ฺฏุฑููโูุง ูพุณ ุงุฒ ฺฉูุชุฑู ูพุดโุขุฒููู"),
                                 tags$li("ุญุฐู ุงุซุฑ ูุชุบุฑูุง ูุฎุฏูุดฺฏุฑ")
                               )),
                       tags$li(tags$b("ูุฒุงุง:"),
                               tags$ul(
                                 tags$li("ุงูุฒุงุด ุฏูุช ููุงุณูโูุง"),
                                 tags$li("ฺฉุงูุด ูุงุฑุงูุณ ุฎุทุง"),
                                 tags$li("ฺฉูุชุฑู ูุชุบุฑูุง ูุฒุงุญู")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ููุงูู ูพุงู ุฏุฑ ANCOVA"),
                 div(class = "success-box",
                     h4("ุงุฌุฒุง ุงุตู ANCOVA"),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ูุชุบุฑ ฺฉูู ฺฉู ูโุฎูุงูู ููุงุณู ฺฉูู"),
                       tags$li(tags$b("ูุชุบุฑ ูุณุชูู:"), "ูุชุบุฑ ฺฏุฑููโุจูุฏ (ฺฉู)"),
                       tags$li(tags$b("ฺฉููุงุฑุงุช:"), "ูุชุบุฑ ฺฉูู ฺฉู ูโุฎูุงูู ุงุซุฑ ุขู ุฑุง ฺฉูุชุฑู ฺฉูู"),
                       tags$li(tags$b("ูุฏู:"), "Y = ฮผ + ฮฑแตข + ฮฒX + ฮต"),
                       tags$li(tags$b("ูุซุงู:"), "ููุงุณู ูุดุงุฑ ุฎูู ูพุณ ุงุฒ ุฏุฑูุงูุ ูพุณ ุงุฒ ฺฉูุชุฑู ูุดุงุฑ ุฎูู ูพุงู")
                     )
                 ),
                 
                 h3("๐ ูพุดโูุฑุถโูุง ANCOVA"),
                 div(class = "warning-box",
                     h4("ูพุดโูุฑุถโูุง ููู"),
                     tags$ul(
                       tags$li(tags$b("ุฎุท ุจูุฏู:"), "ุฑุงุจุทู ุฎุท ุจู ฺฉููุงุฑุงุช ู ูุชุบุฑ ูุงุจุณุชู"),
                       tags$li(tags$b("ููฺฏูู ุดุจโูุง ุฑฺฏุฑุณูู:"), "ุดุจ ุฑุงุจุทู ุฏุฑ ููู ฺฏุฑููโูุง ฺฉุณุงู ุจุงุดุฏ"),
                       tags$li(tags$b("ูุฑูุงู ุจูุฏู ุจุงููุงูุฏูโูุง:"), "ุจุงููุงูุฏูโูุง ุชูุฒุน ูุฑูุงู ุฏุงุดุชู ุจุงุดูุฏ"),
                       tags$li(tags$b("ููุณุงู ูุงุฑุงูุณโูุง:"), "ูุงุฑุงูุณ ุฎุทุง ุฏุฑ ฺฏุฑููโูุง ฺฉุณุงู ุจุงุดุฏ"),
                       tags$li(tags$b("ููุณุงู ูุงุฑุงูุณ-ฺฉููุงุฑุงูุณ:"), "ุจุฑุง ฺูุฏู ฺฉููุงุฑุงุช")
                     )
                 ),
                 
                 h3("๐ ุจุฑุฑุณ ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง"),
                 div(class = "info-box",
                     h4("ุขุฒููู ุจุฑููฺฉูุด ฺฏุฑูู ร ฺฉููุงุฑุงุช"),
                     tags$ul(
                       tags$li("ุงฺฏุฑ ุจุฑููฺฉูุด ูุนูโุฏุงุฑ ูุจุงุดุฏ: ูพุดโูุฑุถ ุจุฑูุฑุงุฑ ุงุณุช"),
                       tags$li("ุงฺฏุฑ ุจุฑููฺฉูุด ูุนูโุฏุงุฑ ุจุงุดุฏ: ูพุดโูุฑุถ ููุถ ุดุฏู ุงุณุช"),
                       tags$li("ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ูพฺุฏูโุชุฑ ุง ฺฏุฒุงุฑุด ุฌุฏุงฺฏุงูู")
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ANCOVA"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง"),
                          numericInput("ancova_n_groups", "ุชุนุฏุงุฏ ฺฏุฑููโูุง:", 
                                       value = 2, min = 2, max = 4),
                          numericInput("ancova_n_per_group", "ุชุนุฏุงุฏ ููููู ุฏุฑ ูุฑ ฺฏุฑูู:", 
                                       value = 30),
                          
                          h5("ูุงูฺฏู ูุชุบุฑ ูุงุจุณุชู ุฏุฑ ฺฏุฑููโูุง:"),
                          numericInput("ancova_group1_mean", "ฺฏุฑูู ฑ:", value = 50),
                          numericInput("ancova_group2_mean", "ฺฏุฑูู ฒ:", value = 55),
                          conditionalPanel(
                            condition = "input.ancova_n_groups >= 3",
                            numericInput("ancova_group3_mean", "ฺฏุฑูู ณ:", value = 52)
                          ),
                          conditionalPanel(
                            condition = "input.ancova_n_groups >= 4",
                            numericInput("ancova_group4_mean", "ฺฏุฑูู ด:", value = 58)
                          ),
                          
                          h5("ฺฉููุงุฑุงุช:"),
                          sliderInput("ancova_cov_effect", "ุงุซุฑ ฺฉููุงุฑุงุช:", 
                                      min = 0, max = 2, value = 0.5, step = 0.1),
                          sliderInput("ancova_cov_correlation", "ููุจุณุชฺฏ ฺฉููุงุฑุงุช ุจุง ูุชุบุฑ ูุงุจุณุชู:", 
                                      min = 0, max = 0.8, value = 0.3, step = 0.1),
                          
                          actionButton("run_ancova", "ุงูุฌุงู ANCOVA")
                   ),
                   column(8,
                          plotOutput("ancova_plot"),
                          verbatimTextOutput("ancova_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ููุงุณู ุฏุฑูุงูโูุง ุจุง ฺฉูุชุฑู ุณู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ูุดุงุฑ ุฎูู ูพุณ ุงุฒ ุฏุฑูุงู"),
                                tags$li(tags$b("ูุชุบุฑ ูุณุชูู:"), "ููุน ุฏุฑูุงู (ณ ฺฏุฑูู)"),
                                tags$li(tags$b("ฺฉููุงุฑุงุช:"), "ุณู ุจูุงุฑ"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ูพุณ ุงุฒ ฺฉูุชุฑู ุณูุ ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏุฑูุงูโูุง ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ูุซุงู ฒ: ูุทุงูุนู ุขููุฒุด ุจุง ฺฉูุชุฑู ูพุดโุขุฒููู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ููุฑู ูพุณโุขุฒููู"),
                                tags$li(tags$b("ูุชุบุฑ ูุณุชูู:"), "ุฑูุด ุขููุฒุด (ฒ ฺฏุฑูู)"),
                                tags$li(tags$b("ฺฉููุงุฑุงุช:"), "ููุฑู ูพุดโุขุฒููู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ูพุณ ุงุฒ ฺฉูุชุฑู ูพุดโุขุฒูููุ ุฑูุด ุฌุฏุฏ ุจูุชุฑ ุงุณุช")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ูฺฉุงุช ููู ู ูุดุฏุงุฑูุง"),
                 div(class = "warning-box",
                     h4("ุงุดุชุจุงูุงุช ุฑุงุฌ"),
                     tags$ul(
                       tags$li("ุงุณุชูุงุฏู ุงุฒ ฺฉููุงุฑุงุชโูุง ุจุณุงุฑ ููุจุณุชู ุจุง ูุชุบุฑ ูุณุชูู"),
                       tags$li("ุจโุชูุฌู ุจู ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง"),
                       tags$li("ุงุณุชูุงุฏู ุงุฒ ฺฉููุงุฑุงุชโูุง ฺฉู"),
                       tags$li("ุชูุณุฑ ูุงุฏุฑุณุช ูุงูฺฏูโูุง ุชุนุฏูโุดุฏู"),
                       tags$li("ฺฏุฒุงุฑุด ูฺฉุฑุฏู ุจุฑุฑุณ ูพุดโูุฑุถโูุง")
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ ANCOVA"),
                 div(class = "highlight-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด"),
                     p("ูพุณ ุงุฒ ฺฉูุชุฑู ุงุซุฑ [ูุงู ฺฉููุงุฑุงุช]ุ ุชูุงูุช ูุนูโุฏุงุฑ ุจู ฺฏุฑููโูุง ูุดุงูุฏู ุดุฏ (F(ุฏุฑุฌู ุขุฒุงุฏ ุจู, ุฏุฑุฌู ุขุฒุงุฏ ุฏุฑูู) = ููุฏุงุฑ F, p = ููุฏุงุฑ p, ฮทยฒ = ุงูุฏุงุฒู ุงุซุฑ)."),
                     p("ูุงูฺฏูโูุง ุชุนุฏูโุดุฏู: ฺฏุฑูู ฑ = ููุฏุงุฑ, ฺฏุฑูู ฒ = ููุฏุงุฑ, ..."),
                     p("ุจุฑุฑุณ ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง ูุนูโุฏุงุฑ ูุจูุฏ (p > 0.05).")
                 )
             )
           ),
           
           # ุจุฎุด ููุงุณู ุจุด ุงุฒ ุฏู ฺฏุฑูู ูุงุจุณุชู
           "repeated_measures" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ููุงุณู ุจุด ุงุฒ ุฏู ฺฏุฑูู ูุงุจุณุชู"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุฏุงุฏูโูุง ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ"),
                     p("ุฒูุงู ฺฉู ุงูุฏุงุฒูโฺฏุฑโูุง ูุชุนุฏุฏ ุงุฒ ฺฉ ููููู ุฏุฑ ุฒูุงูโูุง ุง ุดุฑุงุท ูุฎุชูู ุงูุฌุงู ูโุดูุฏุ ุงุฒ ุงู ุฑูุดโูุง ุงุณุชูุงุฏู ูโฺฉูู."),
                     tags$ul(
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ุงูุฏุงุฒูโฺฏุฑ ูุดุงุฑ ุฎูู ุฏุฑ ุฒูุงูโูุง ูุฎุชูู"),
                                 tags$li("ุจุฑุฑุณ ุงุซุฑ ุฏุงุฑู ุฏุฑ ุฏูุฒูุง ูุฎุชูู"),
                                 tags$li("ูุทุงูุนุงุช ุทูู ู ูพฺฏุฑ ุจูุงุฑุงู")
                               )),
                       tags$li(tags$b("ูุฒุงุง:"),
                               tags$ul(
                                 tags$li("ฺฉูุชุฑู ุชูุงูุชโูุง ูุฑุฏ"),
                                 tags$li("ูุงุฒ ุจู ููููู ฺฉูุชุฑ"),
                                 tags$li("ูุฏุฑุช ุขูุงุฑ ุจุงูุงุชุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุชุญูู ูุงุฑุงูุณ ุจุง ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ (Repeated Measures ANOVA)"),
                 div(class = "success-box",
                     h4("ูฺฺฏโูุง Repeated Measures ANOVA"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุงูฺฏูโูุง ฺูุฏ ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู"),
                       tags$li(tags$b("ูพุดโูุฑุถโูุง:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ฺฉูู ู ูุฑูุงู ุจุงุดูุฏ"),
                                 tags$li("ฺฉุฑู ุจูุฏู (Sphericity) ุจุฑูุฑุงุฑ ุจุงุดุฏ"),
                                 tags$li("ูุดุงูุฏุงุช ูุณุชูู ุจู ูุงุญุฏูุง ุจุงุดูุฏ")
                               )),
                       tags$li(tags$b("ูุซุงู:"), "ููุงุณู ูุดุงุฑ ุฎูู ุจูุงุฑุงู ุฏุฑ ด ููุจุช ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ุขุฒููู ูุฑุฏูู (Friedman Test)"),
                 div(class = "warning-box",
                     h4("ุขุฒููู ูุงูพุงุฑุงูุชุฑ ุจุฑุง ุฏุงุฏูโูุง ูุงุจุณุชู"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ุชูุฒุน ฺูุฏ ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ุชุฑุชุจ"),
                                 tags$li("ุฏุงุฏูโูุง ฺฉูู ุบุฑูุฑูุงู"),
                                 tags$li("ูููููโูุง ฺฉูฺฺฉ")
                               )),
                       tags$li(tags$b("ูุซุงู:"), "ููุงุณู ุณุทุญ ุฏุฑุฏ ุฏุฑ ณ ุฑูุด ุฏุฑูุงู ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ุขุฒููู Q ฺฉูฺฉุฑุงู (Cochran's Q Test)"),
                 div(class = "info-box",
                     h4("ุขุฒููู ุจุฑุง ุฏุงุฏูโูุง ุฏูุญุงูุช ูุงุจุณุชู"),
                     tags$ul(
                       tags$li(tags$b("ูุฏู:"), "ููุงุณู ูุณุจุชโูุง ฺูุฏ ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"),
                               tags$ul(
                                 tags$li("ุฏุงุฏูโูุง ุฏูุญุงูุช (ุจูู/ุฎุฑ)"),
                                 tags$li("ุงูุฏุงุฒูโฺฏุฑโูุง ูฺฉุฑุฑ"),
                                 tags$li("ูุชุบุฑูุง ุงุณู")
                               )),
                       tags$li(tags$b("ูุซุงู:"), "ููุงุณู ูุฑุฎ ุจูุจูุฏ ุฏุฑ ด ูุฑุญูู ุฏุฑูุงู")
                     )
                 ),
                 
                 h3("โ๏ธ ูพุดโูุฑุถ ฺฉุฑู ุจูุฏู (Sphericity)"),
                 div(class = "warning-box",
                     h4("ุจุฑุฑุณ ู ุงุตูุงุญ ฺฉุฑู ุจูุฏู"),
                     tags$ul(
                       tags$li(tags$b("ุขุฒููู ูุงุดู (Mauchly's Test):"), "ุจุฑุง ุจุฑุฑุณ ฺฉุฑู ุจูุฏู"),
                       tags$li(tags$b("ุงุตูุงุญโูุง ุฏุฑ ุตูุฑุช ููุถ:"),
                               tags$ul(
                                 tags$li("ฺฏุฑู ูุงูุณ-ฺฏุณุฑ (Greenhouse-Geisser)"),
                                 tags$li("ูุงูู-ููุฏุช (Huynh-Feldt)"),
                                 tags$li("ูพุงูโุชุฑู ุญุฏ (Lower-bound)")
                               )),
                       tags$li(tags$b("ุงูุฏุงู:"), "ุงฺฏุฑ p-value ูุงุดู < 0.05ุ ุงุฒ ุงุตูุงุญ ุงุณุชูุงุฏู ฺฉูุฏ")
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ Repeated Measures ANOVA"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุทุงูุนู"),
                          numericInput("rm_n_subjects", "ุชุนุฏุงุฏ ูุงุญุฏูุง ูุดุงูุฏู:", 
                                       value = 20, min = 5, max = 100),
                          numericInput("rm_n_timepoints", "ุชุนุฏุงุฏ ุฒูุงูโูุง ุงูุฏุงุฒูโฺฏุฑ:", 
                                       value = 3, min = 2, max = 6),
                          
                          h5("ูุงูฺฏูโูุง ุฏุฑ ุฒูุงูโูุง ูุฎุชูู:"),
                          numericInput("rm_time1_mean", "ุฒูุงู ฑ:", value = 50),
                          numericInput("rm_time2_mean", "ุฒูุงู ฒ:", value = 45),
                          numericInput("rm_time3_mean", "ุฒูุงู ณ:", value = 40),
                          conditionalPanel(
                            condition = "input.rm_n_timepoints >= 4",
                            numericInput("rm_time4_mean", "ุฒูุงู ด:", value = 38)
                          ),
                          conditionalPanel(
                            condition = "input.rm_n_timepoints >= 5",
                            numericInput("rm_time5_mean", "ุฒูุงู ต:", value = 37)
                          ),
                          conditionalPanel(
                            condition = "input.rm_n_timepoints >= 6",
                            numericInput("rm_time6_mean", "ุฒูุงู ถ:", value = 36)
                          ),
                          
                          sliderInput("rm_correlation", "ููุจุณุชฺฏ ุจู ุงูุฏุงุฒูโฺฏุฑโูุง:", 
                                      min = 0.1, max = 0.9, value = 0.5, step = 0.1),
                          actionButton("run_rm_anova", "ุงูุฌุงู ุชุญูู")
                   ),
                   column(8,
                          plotOutput("rm_plot"),
                          verbatimTextOutput("rm_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู ูุฑุฏูู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง ุฑุชุจูโุง"),
                          numericInput("friedman_n_blocks", "ุชุนุฏุงุฏ ุจููฺฉโูุง (ููุถูุนุงุช):", 
                                       value = 15, min = 5, max = 50),
                          numericInput("friedman_n_treatments", "ุชุนุฏุงุฏ ุฏุฑูุงูโูุง:", 
                                       value = 3, min = 2, max = 6),
                          
                          h5("ูุงูฺฏู ุฑุชุจู ุฏุฑูุงูโูุง:"),
                          numericInput("friedman_treatment1", "ุฏุฑูุงู ฑ:", value = 1.5),
                          numericInput("friedman_treatment2", "ุฏุฑูุงู ฒ:", value = 2.0),
                          numericInput("friedman_treatment3", "ุฏุฑูุงู ณ:", value = 2.5),
                          conditionalPanel(
                            condition = "input.friedman_n_treatments >= 4",
                            numericInput("friedman_treatment4", "ุฏุฑูุงู ด:", value = 1.8)
                          ),
                          conditionalPanel(
                            condition = "input.friedman_n_treatments >= 5",
                            numericInput("friedman_treatment5", "ุฏุฑูุงู ต:", value = 2.2)
                          ),
                          conditionalPanel(
                            condition = "input.friedman_n_treatments >= 6",
                            numericInput("friedman_treatment6", "ุฏุฑูุงู ถ:", value = 2.8)
                          ),
                          
                          actionButton("run_friedman", "ุงูุฌุงู ุขุฒููู ูุฑุฏูู")
                   ),
                   column(8,
                          plotOutput("friedman_plot"),
                          verbatimTextOutput("friedman_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุขุฒููู Q ฺฉูฺฉุฑุงู"),
                 fluidRow(
                   column(4,
                          h4("ุฏุงุฏูโูุง ุฏูุญุงูุช"),
                          numericInput("cochran_n_subjects", "ุชุนุฏุงุฏ ุจูุงุฑุงู:", 
                                       value = 20, min = 5, max = 50),
                          numericInput("cochran_n_treatments", "ุชุนุฏุงุฏ ุฏุฑูุงูโูุง:", 
                                       value = 3, min = 2, max = 5),
                          
                          h5("ูุณุจุช ุจูุจูุฏ ุฏุฑ ูุฑ ุฏุฑูุงู (%):"),
                          sliderInput("cochran_treatment1", "ุฏุฑูุงู ฑ:", 
                                      min = 0, max = 100, value = 30),
                          sliderInput("cochran_treatment2", "ุฏุฑูุงู ฒ:", 
                                      min = 0, max = 100, value = 50),
                          sliderInput("cochran_treatment3", "ุฏุฑูุงู ณ:", 
                                      min = 0, max = 100, value = 70),
                          conditionalPanel(
                            condition = "input.cochran_n_treatments >= 4",
                            sliderInput("cochran_treatment4", "ุฏุฑูุงู ด:", 
                                        min = 0, max = 100, value = 60)
                          ),
                          conditionalPanel(
                            condition = "input.cochran_n_treatments >= 5",
                            sliderInput("cochran_treatment5", "ุฏุฑูุงู ต:", 
                                        min = 0, max = 100, value = 40)
                          ),
                          
                          actionButton("run_cochran", "ุงูุฌุงู ุขุฒููู ฺฉูฺฉุฑุงู")
                   ),
                   column(8,
                          plotOutput("cochran_plot"),
                          verbatimTextOutput("cochran_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(4,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ูุทุงูุนู ูุดุงุฑ ุฎูู"),
                              tags$ul(
                                tags$li(tags$b("ุทุฑุญ:"), "ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ูุดุงุฑ ุฎูู ุฏุฑ ด ููุจุช"),
                                tags$li(tags$b("ุขุฒููู:"), "Repeated Measures ANOVA"),
                                tags$li(tags$b("ูุชุฌู:"), "ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฒูุงูโูุง")
                              )
                          )
                   ),
                   column(4,
                          div(class = "info-box",
                              h4("ูุซุงู ฒ: ููุงุณู ุฑูุดโูุง ฺฉุงูุด ุฏุฑุฏ"),
                              tags$ul(
                                tags$li(tags$b("ุทุฑุญ:"), "ุฏุงุฏูโูุง ุชุฑุชุจ"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุณุทุญ ุฏุฑุฏ ุจุง ณ ุฑูุด"),
                                tags$li(tags$b("ุขุฒููู:"), "ูุฑุฏูู"),
                                tags$li(tags$b("ูุชุฌู:"), "ุชูุงูุช ุฏุฑ ุชูุฒุน ุฏุฑุฏ")
                              )
                          )
                   ),
                   column(4,
                          div(class = "warning-box",
                              h4("ูุซุงู ณ: ูุทุงูุนู ุจูุจูุฏ ุจูุงุฑุงู"),
                              tags$ul(
                                tags$li(tags$b("ุทุฑุญ:"), "ุฏุงุฏูโูุง ุฏูุญุงูุช"),
                                tags$li(tags$b("ุฏุงุฏูโูุง:"), "ุจูุจูุฏ/ุนุฏู ุจูุจูุฏ ุฏุฑ ณ ูุฑุญูู"),
                                tags$li(tags$b("ุขุฒููู:"), "ฺฉูฺฉุฑุงู"),
                                tags$li(tags$b("ูุชุฌู:"), "ุชูุงูุช ุฏุฑ ูุฑุฎ ุจูุจูุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุฎูุงุตู ุขุฒูููโูุง"),
                 tableOutput("repeated_measures_summary_table"),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู"),
                 div(class = "highlight-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ูุฑูุงู ุงุฒ Repeated Measures ANOVA ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ุงุฒ ูุฑุฏูู ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุฏูุญุงูุช ุงุฒ ฺฉูฺฉุฑุงู ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ููุดู ูพุดโูุฑุถ ฺฉุฑู ุจูุฏู ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุงุฒ ุขุฒูููโูุง ุชุนูุจ ููุงุณุจ ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุญุฌู ููููู ฺฉุงู ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ")
                     )
                 )
             )
           ),
           
           "correlation" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ููุจุณุชฺฏ (Correlation)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ููุจุณุชฺฏ"),
                     p("ููุจุณุชฺฏ ุงูุฏุงุฒูโฺฏุฑ ุฑุงุจุทู ุฎุท ุจู ุฏู ูุชุบุฑ ฺฉู ุงุณุช. ููุจุณุชฺฏ ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ุชุบุฑุงุช ฺฉ ูุชุบุฑ ุจุง ุชุบุฑุงุช ูุชุบุฑ ุฏฺฏุฑ ูุฑุชุจุท ุงุณุช."),
                     tags$ul(
                       tags$li(tags$b("ุถุฑุจ ููุจุณุชฺฏ:"), "ุนุฏุฏ ุจู ฑ- ู ฑ+ ฺฉู ูุฏุฑุช ู ุฌูุช ุฑุงุจุทู ุฑุง ูุดุงู ูโุฏูุฏ"),
                       tags$li(tags$b("ุฌูุช ุฑุงุจุทู:"), "ูุซุจุช (ููโุฌูุช) ุง ููู (ุฎูุงู ุฌูุช)"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ุฑุงุจุทู ุณู ู ูุดุงุฑ ุฎูู"),
                                 tags$li("ุฑุงุจุทู ูุฒู ู ุณุทุญ ฺฉูุณุชุฑูู"),
                                 tags$li("ุฑุงุจุทู ุฏูุฒ ุฏุงุฑู ู ูพุงุณุฎ ุฏุฑูุงู")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุงููุงุน ููุจุณุชฺฏ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ููุจุณุชฺฏโูุง ูพุงุฑุงูุชุฑ"),
                              tags$ul(
                                tags$li(tags$b("ุถุฑุจ ููุจุณุชฺฏ ูพุฑุณูู:"),
                                        tags$ul(
                                          tags$li("ุจุฑุง ุฏุงุฏูโูุง ฺฉู ูุฑูุงู"),
                                          tags$li("ุฑุงุจุทู ุฎุท ุจู ุฏู ูุชุบุฑ"),
                                          tags$li("ููุงุฏุฑ ุจู ฑ- ู ฑ+")
                                        )),
                                tags$li(tags$b("ูพุดโูุฑุถโูุง ูพุฑุณูู:"),
                                        tags$ul(
                                          tags$li("ุฏุงุฏูโูุง ฺฉู ู ูพูุณุชู"),
                                          tags$li("ุชูุฒุน ูุฑูุงู ุฏู ูุชุบุฑู"),
                                          tags$li("ุฑุงุจุทู ุฎุท"),
                                          tags$li("ููฺฏู ูุงุฑุงูุณ")
                                        ))
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ููุจุณุชฺฏโูุง ูุงูพุงุฑุงูุชุฑ"),
                              tags$ul(
                                tags$li(tags$b("ุถุฑุจ ููุจุณุชฺฏ ุงุณูพุฑูู:"),
                                        tags$ul(
                                          tags$li("ุจุฑุง ุฏุงุฏูโูุง ุชุฑุชุจ ุง ุบุฑูุฑูุงู"),
                                          tags$li("ุจุฑ ุงุณุงุณ ุฑุชุจูโูุง"),
                                          tags$li("ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ")
                                        )),
                                tags$li(tags$b("ุถุฑุจ ููุจุณุชฺฏ ฺฉูุฏุงู:"),
                                        tags$ul(
                                          tags$li("ุจุฑุง ุฏุงุฏูโูุง ุชุฑุชุจ"),
                                          tags$li("ููุงูู ุจู ููุงุฏุฑ ูพุฑุช"),
                                          tags$li("ุชูุณุฑ ุจุฑ ุงุณุงุณ ุงุญุชูุงู ููุงููฺฏ")
                                        ))
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุชูุณุฑ ุถุฑุจ ููุจุณุชฺฏ"),
                 div(class = "info-box",
                     h4("ููุงุณ ุชูุณุฑ ููุจุณุชฺฏ"),
                     tableOutput("correlation_interpretation_table"),
                     h5("ูฺฉุงุช ููู:"),
                     tags$ul(
                       tags$li("ููุจุณุชฺฏ โ ุนูุช (Correlation โ Causation)"),
                       tags$li("ููุจุณุชฺฏ ูู ูุฒููุงู ุจู ูุนูุง ุฑุงุจุทู ุนู ูุณุช"),
                       tags$li("ููุจุณุชฺฏ ูโุชูุงูุฏ ุชุญุช ุชุฃุซุฑ ูุชุบุฑูุง ุณูู ุจุงุดุฏ")
                     )
                 ),
                 
                 h3("๐ ูููุฏุงุฑูุง ููุจุณุชฺฏ"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h5("ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ (Scatter Plot)"),
                              p("ุจุฑุง ููุงุด ุจุตุฑ ุฑุงุจุทู ุจู ุฏู ูุชุบุฑ"),
                              tags$ul(
                                tags$li("ูุญูุฑ X: ูุชุบุฑ ูุณุชูู"),
                                tags$li("ูุญูุฑ Y: ูุชุบุฑ ูุงุจุณุชู"),
                                tags$li("ุฎุท ุฑููุฏ: ูุดุงูโุฏููุฏู ุฌูุช ุฑุงุจุทู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ูุงุชุฑุณ ููุจุณุชฺฏ (Correlation Matrix)"),
                              p("ุจุฑุง ููุงุด ููุจุณุชฺฏ ุจู ฺูุฏู ูุชุบุฑ"),
                              tags$ul(
                                tags$li("ููุงุณุจ ุจุฑุง ูุทุงูุนุงุช ุงฺฉุชุดุงู"),
                                tags$li("ุดูุงุณุง ุงูฺฏููุง ููุจุณุชฺฏ"),
                                tags$li("ุชุดุฎุต ููุฎุท (Multicollinearity)")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ููุจุณุชฺฏ ูพุฑุณูู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง"),
                          sliderInput("pearson_cor", "ุถุฑุจ ููุจุณุชฺฏ ููุฑุฏ ูุธุฑ:", 
                                      min = -1, max = 1, value = 0.7, step = 0.1),
                          numericInput("cor_sample_size", "ุญุฌู ููููู:", 
                                       value = 100, min = 10, max = 1000),
                          sliderInput("cor_noise", "ุฏุฑุฌู ููุฒ ุฏุงุฏูโูุง:", 
                                      min = 0, max = 2, value = 0.5, step = 0.1),
                          selectInput("cor_alpha", "ุณุทุญ ูุนูโุฏุงุฑ:",
                                      choices = c("0.01" = 0.01, "0.05" = 0.05, "0.10" = 0.10),
                                      selected = "0.05"),
                          actionButton("run_pearson", "ูุญุงุณุจู ููุจุณุชฺฏ ูพุฑุณูู")
                   ),
                   column(8,
                          plotOutput("pearson_plot"),
                          verbatimTextOutput("pearson_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ููุจุณุชฺฏ ุงุณูพุฑูู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ุฏุงุฏูโูุง"),
                          sliderInput("spearman_cor", "ุถุฑุจ ููุจุณุชฺฏ ููุฑุฏ ูุธุฑ:", 
                                      min = -1, max = 1, value = 0.6, step = 0.1),
                          numericInput("spearman_sample_size", "ุญุฌู ููููู:", 
                                       value = 100, min = 10, max = 1000),
                          sliderInput("spearman_outliers", "ุชุนุฏุงุฏ ููุงุฏุฑ ูพุฑุช:", 
                                      min = 0, max = 10, value = 2),
                          checkboxInput("use_nonlinear", "ุฑุงุจุทู ุบุฑุฎุท", value = FALSE),
                          actionButton("run_spearman", "ูุญุงุณุจู ููุจุณุชฺฏ ุงุณูพุฑูู")
                   ),
                   column(8,
                          plotOutput("spearman_plot"),
                          verbatimTextOutput("spearman_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ุฑุงุจุทู ุณู ู ูุดุงุฑ ุฎูู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุณู (ฺฉู) ู ูุดุงุฑ ุฎูู ุณุณุชููฺฉ (ฺฉู)"),
                                tags$li(tags$b("ุชูุฒุน:"), "ูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู:"), "ููุจุณุชฺฏ ูพุฑุณูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "r = 0.65, p < 0.001"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุฑุงุจุทู ูุซุจุช ู ูู ุจู ุณู ู ูุดุงุฑ ุฎูู ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ูุซุงู ฒ: ุฑุงุจุทู ุณุทุญ ุฏุฑุฏ ู ุฑุถุงุช ุจูุงุฑ"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุณุทุญ ุฏุฑุฏ (ุชุฑุชุจ) ู ุฑุถุงุช (ุชุฑุชุจ)"),
                                tags$li(tags$b("ุชูุฒุน:"), "ุบุฑูุฑูุงู"),
                                tags$li(tags$b("ุขุฒููู:"), "ููุจุณุชฺฏ ุงุณูพุฑูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ฯ = -0.72, p < 0.001"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุฑุงุจุทู ููู ู ูู ุจู ุฏุฑุฏ ู ุฑุถุงุช ูุฌูุฏ ุฏุงุฑุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ุงุดุชุจุงูุงุช ุฑุงุฌ ุฏุฑ ุชุญูู ููุจุณุชฺฏ"),
                 div(class = "warning-box",
                     h4("ูุดุฏุงุฑูุง ููู"),
                     tags$ul(
                       tags$li(tags$b("ุงุดุชุจุงู ุนูุช:"), "ููุจุณุชฺฏ ุจู ูุนูุง ุนูุช ูุณุช"),
                       tags$li(tags$b("ุชุฃุซุฑ ูุชุบุฑูุง ูุฎุฏูุดฺฏุฑ:"), "ูุชุบุฑูุง ุณูู ูโุชูุงููุฏ ุฑุงุจุทู ูุดุงูุฏู ุดุฏู ุฑุง ุชูุถุญ ุฏููุฏ"),
                       tags$li(tags$b("ุฑุงุจุทู ุบุฑุฎุท:"), "ููุจุณุชฺฏ ููุท ุฑุงุจุทู ุฎุท ุฑุง ุงูุฏุงุฒู ูโฺฏุฑุฏ"),
                       tags$li(tags$b("ุชุฃุซุฑ ููุงุฏุฑ ูพุฑุช:"), "ููุงุฏุฑ ูพุฑุช ูโุชูุงููุฏ ููุจุณุชฺฏ ุฑุง ุจู ุดุฏุช ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ุฏููุฏ"),
                       tags$li(tags$b("ุฏุงููู ูุญุฏูุฏ:"), "ุงฺฏุฑ ุฏุงููู ฺฉ ุงุฒ ูุชุบุฑูุง ูุญุฏูุฏ ุจุงุดุฏุ ููุจุณุชฺฏ ุฏุณุช ฺฉู ฺฏุฑูุชู ูโุดูุฏ")
                     )
                 ),
                 
                 h3("๐ ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู ููุจุณุชฺฏ"),
                 tableOutput("correlation_selection_guide"),
                 
                 h3("๐ ุจุฑุฑุณ ูพุดโูุฑุถโูุง ููุจุณุชฺฏ ูพุฑุณูู"),
                 div(class = "info-box",
                     h4("ุฑูุดโูุง ุจุฑุฑุณ ูพุดโูุฑุถโูุง"),
                     tags$ul(
                       tags$li(tags$b("ูุฑูุงู ุจูุฏู:"),
                               tags$ul(
                                 tags$li("ุขุฒููู ุดุงูพุฑู-ููฺฉ ุจุฑุง ูุฑ ูุชุบุฑ"),
                                 tags$li("ูููุฏุงุฑ Q-Q ุจุฑุง ูุฑ ูุชุบุฑ"),
                                 tags$li("ูุณุชูฺฏุฑุงู ู ููุญู ูุฑูุงู")
                               )),
                       tags$li(tags$b("ุฎุท ุจูุฏู:"),
                               tags$ul(
                                 tags$li("ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ"),
                                 tags$li("ุจุฑุฑุณ ุงูฺฏู ููุงุท"),
                                 tags$li("ุนุฏู ูุฌูุฏ ุงูฺฏู ููุญู")
                               )),
                       tags$li(tags$b("ููุณุงู ูุงุฑุงูุณ:"),
                               tags$ul(
                                 tags$li("ูพุฑุงฺฉูุฏฺฏ ฺฉููุงุฎุช ููุงุท ุญูู ุฎุท ุฑููุฏ"),
                                 tags$li("ุนุฏู ูุฌูุฏ ุงูฺฏู ูู ุดฺฉู")
                               ))
                     )
                 ),
                 
                 h3("๐ ุงูุฏุงุฒู ุงุซุฑ ุฏุฑ ููุจุณุชฺฏ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h5("ุถุฑุจ ุชุนู (Rยฒ)"),
                              tags$ul(
                                tags$li("ูุฑุจุน ุถุฑุจ ููุจุณุชฺฏ"),
                                tags$li("ูุดุงูโุฏููุฏู ุฏุฑุตุฏ ูุงุฑุงูุณ ุชุจูโุดุฏู"),
                                tags$li("ุชูุณุฑ:"),
                                tags$ul(
                                  tags$li("Rยฒ = 0.01: ุงุซุฑ ฺฉูฺฺฉ (ฑูช ูุงุฑุงูุณ)"),
                                  tags$li("Rยฒ = 0.09: ุงุซุฑ ูุชูุณุท (นูช ูุงุฑุงูุณ)"),
                                  tags$li("Rยฒ = 0.25: ุงุซุฑ ุจุฒุฑฺฏ (ฒตูช ูุงุฑุงูุณ)")
                                )
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h5("ุชูุงู ุขูุงุฑ"),
                              tags$ul(
                                tags$li("ุงุญุชูุงู ุชุดุฎุต ููุจุณุชฺฏ ูุงูุน"),
                                tags$li("ูุงุจุณุชู ุจู:"),
                                tags$ul(
                                  tags$li("ุญุฌู ููููู"),
                                  tags$li("ุงูุฏุงุฒู ุงุซุฑ"),
                                  tags$li("ุณุทุญ ูุนูโุฏุงุฑ")
                                ),
                                tags$li("ุจุฑุง ููุจุณุชฺฏ ูุชูุณุท (r = 0.3):"),
                                tags$ul(
                                  tags$li("n = 30 โ ุชูุงู โ ณฐูช"),
                                  tags$li("n = 100 โ ุชูุงู โ ธฐูช"),
                                  tags$li("n = 200 โ ุชูุงู โ นตูช")
                                )
                              )
                          )
                   )
                 ),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู ุจุฑุง ูพฺููุดฺฏุฑุงู"),
                 div(class = "highlight-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ููุดู ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ ุฑุณู ฺฉูุฏ"),
                       tags$li("ูพุดโูุฑุถโูุง ุขุฒููู ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ุงุฒ ุงุณูพุฑูู ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ุถุฑุจ ุชุนู (Rยฒ) ุฑุง ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ูุงุตูู ุงุทููุงู ุจุฑุง ุถุฑุจ ููุจุณุชฺฏ ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ุฏุฑ ุชูุณุฑ ูุชุงุฌ ูุญุชุงุท ุจุงุดุฏ ู ุงุฒ ูุชุฌูโฺฏุฑ ุนู ุฎูุฏุฏุงุฑ ฺฉูุฏ")
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                 div(class = "info-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                     h5("ุจุฑุง ููุจุณุชฺฏ ูพุฑุณูู:"),
                     p("r(ุฏุฑุฌู ุขุฒุงุฏ) = ุถุฑุจ ููุจุณุชฺฏ, p = ููุฏุงุฑ p, 95% CI [ุญุฏ ูพุงู, ุญุฏ ุจุงูุง]"),
                     p("ูุซุงู: r(98) = 0.65, p < 0.001, 95% CI [0.52, 0.75]"),
                     
                     h5("ุจุฑุง ููุจุณุชฺฏ ุงุณูพุฑูู:"),
                     p("ฯ(ุฏุฑุฌู ุขุฒุงุฏ) = ุถุฑุจ ููุจุณุชฺฏ, p = ููุฏุงุฑ p"),
                     p("ูุซุงู: ฯ(98) = 0.72, p < 0.001"),
                     
                     h5("ุชูุณุฑ:"),
                     p("ูุชุงุฌ ูุดุงู ุฏุงุฏ ุฑุงุจุทู ูุซุจุช ู ูุนูโุฏุงุฑ ุจู ุณู ู ูุดุงุฑ ุฎูู ูุฌูุฏ ุฏุงุฑุฏ (r = 0.65, p < 0.001). ุงู ุฑุงุจุทู ูู ูุดุงู ูโุฏูุฏ ฺฉู ุจุง ุงูุฒุงุด ุณูุ ูุดุงุฑ ุฎูู ูุฒ ุชูุงู ุจู ุงูุฒุงุด ุฏุงุฑุฏ.")
                 )
             )
           ),
           
           "linear_regression" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุฑฺฏุฑุณูู ุฎุท (Linear Regression)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุฑฺฏุฑุณูู ุฎุท"),
                     p("ุฑฺฏุฑุณูู ุฎุท ุฑูุด ุขูุงุฑ ุจุฑุง ูุฏูโุณุงุฒ ุฑุงุจุทู ุจู ฺฉ ูุชุบุฑ ูุงุจุณุชู ฺฉู ู ฺฉ ุง ฺูุฏ ูุชุบุฑ ูุณุชูู ุงุณุช. ูุฏู ูพุดโุจู ูุชุบุฑ ูุงุจุณุชู ุจุฑ ุงุณุงุณ ูุชุบุฑูุง ูุณุชูู ุงุณุช."),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู (Response):"), "ูุชุบุฑ ฺฉู ูโุฎูุงูู ูพุดโุจู ฺฉูู"),
                       tags$li(tags$b("ูุชุบุฑ ูุณุชูู (Predictor):"), "ูุชุบุฑ ฺฉู ุจุฑุง ูพุดโุจู ุงุณุชูุงุฏู ูโฺฉูู"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ูพุดโุจู ูุดุงุฑ ุฎูู ุจุฑ ุงุณุงุณ ุณู ู ูุฒู"),
                                 tags$li("ูพุดโุจู ุณุทุญ ููุฏ ุฎูู ุจุฑ ุงุณุงุณ ุฑฺู ุบุฐุง"),
                                 tags$li("ูพุดโุจู ุฒูุงู ุจูุจูุฏ ุจุฑ ุงุณุงุณ ุดุฏุช ุจูุงุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุงููุงุน ุฑฺฏุฑุณูู ุฎุท"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุฑฺฏุฑุณูู ุฎุท ุณุงุฏู"),
                              tags$ul(
                                tags$li("ฺฉ ูุชุบุฑ ูุณุชูู ู ฺฉ ูุชุบุฑ ูุงุจุณุชู"),
                                tags$li(tags$b("ูุฏู:"), "y = ฮฒโ + ฮฒโx + ฮต"),
                                tags$li(tags$b("ุงุฌุฒุง:"),
                                        tags$ul(
                                          tags$li("ฮฒโ: ุนุฑุถ ุงุฒ ูุจุฏุฃ (Intercept)"),
                                          tags$li("ฮฒโ: ุดุจ (Slope)"),
                                          tags$li("ฮต: ุฎุทุง (Error)")
                                        )),
                                tags$li(tags$b("ูุซุงู:"), "ูพุดโุจู ูุดุงุฑ ุฎูู ุจุฑ ุงุณุงุณ ุณู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุฑฺฏุฑุณูู ุฎุท ฺูุฏฺฏุงูู"),
                              tags$ul(
                                tags$li("ฺูุฏ ูุชุบุฑ ูุณุชูู ู ฺฉ ูุชุบุฑ ูุงุจุณุชู"),
                                tags$li(tags$b("ูุฏู:"), "y = ฮฒโ + ฮฒโxโ + ฮฒโxโ + ... + ฮฒโxโ + ฮต"),
                                tags$li(tags$b("ูุฒุงุง:"),
                                        tags$ul(
                                          tags$li("ฺฉูุชุฑู ุงุซุฑ ูุชุบุฑูุง ูุฎุฏูุดฺฏุฑ"),
                                          tags$li("ุจุฑุฑุณ ุงุซุฑุงุช ูุณุชูู ูุชุบุฑูุง"),
                                          tags$li("ูพุดโุจู ุฏููโุชุฑ")
                                        )),
                                tags$li(tags$b("ูุซุงู:"), "ูพุดโุจู ูุดุงุฑ ุฎูู ุจุฑ ุงุณุงุณ ุณูุ ูุฒู ู ุฌูุณุช")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ููุงูู ูพุงู ุฏุฑ ุฑฺฏุฑุณูู"),
                 div(class = "warning-box",
                     h4("ุดุงุฎุตโูุง ููู ุฑฺฏุฑุณูู"),
                     tags$ul(
                       tags$li(tags$b("ุถุฑุจ ุชุนู (Rยฒ):"), "ูุณุจุช ูุงุฑุงูุณ ุชุจูโุดุฏู ุจู ูุงุฑุงูุณ ฺฉู"),
                       tags$li(tags$b("ุถุฑุจ ุชุนู ุชุนุฏูโุดุฏู:"), "Rยฒ ุจุง ุชุนุฏู ุจุฑุง ุชุนุฏุงุฏ ูุชุบุฑูุง"),
                       tags$li(tags$b("ุฎุทุง ูุนุงุฑ ุจุฑุขูุฑุฏ:"), "ูุงูฺฏู ูุงุตูู ููุงุท ุงุฒ ุฎุท ุฑฺฏุฑุณูู"),
                       tags$li(tags$b("ุขูุงุฑู F:"), "ูุนูโุฏุงุฑ ฺฉู ูุฏู"),
                       tags$li(tags$b("ุถุฑุงุจ ุงุณุชุงูุฏุงุฑุฏุดุฏู:"), "ุจุฑุง ููุงุณู ุงุซุฑ ูุชุบุฑูุง")
                     )
                 ),
                 
                 h3("๐ ูพุดโูุฑุถโูุง ุฑฺฏุฑุณูู ุฎุท"),
                 div(class = "info-box",
                     h4("ูพุดโูุฑุถโูุง ุงุตู"),
                     tags$ul(
                       tags$li(tags$b("ุฎุท ุจูุฏู:"), "ุฑุงุจุทู ุจู ูุชุบุฑูุง ุฎุท ุงุณุช"),
                       tags$li(tags$b("ุงุณุชููุงู ุฎุทุงูุง:"), "ุฎุทุงูุง ุงุฒ ูู ูุณุชูู ูุณุชูุฏ"),
                       tags$li(tags$b("ููุณุงู ูุงุฑุงูุณ:"), "ูุงุฑุงูุณ ุฎุทุงูุง ุซุงุจุช ุงุณุช"),
                       tags$li(tags$b("ูุฑูุงู ุจูุฏู ุฎุทุงูุง:"), "ุฎุทุงูุง ุชูุฒุน ูุฑูุงู ุฏุงุฑูุฏ"),
                       tags$li(tags$b("ุนุฏู ููุฎุท:"), "ูุชุบุฑูุง ูุณุชูู ููุจุณุชฺฏ ุจุงูุง ูุฏุงุฑูุฏ")
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ุฎุท ุณุงุฏู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุฏู"),
                          sliderInput("slr_slope", "ุดุจ (ฮฒโ):", 
                                      min = -2, max = 2, value = 0.8, step = 0.1),
                          sliderInput("slr_intercept", "ุนุฑุถ ุงุฒ ูุจุฏุฃ (ฮฒโ):", 
                                      min = -10, max = 10, value = 2, step = 1),
                          numericInput("slr_sample_size", "ุญุฌู ููููู:", 
                                       value = 100, min = 10, max = 1000),
                          sliderInput("slr_noise", "ุฏุฑุฌู ููุฒ:", 
                                      min = 0.1, max = 3, value = 1, step = 0.1),
                          actionButton("run_slr", "ุงุฌุฑุง ุฑฺฏุฑุณูู ุณุงุฏู")
                   ),
                   column(8,
                          plotOutput("slr_plot"),
                          verbatimTextOutput("slr_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ุฎุท ฺูุฏฺฏุงูู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุฏู"),
                          numericInput("mlr_sample_size", "ุญุฌู ููููู:", 
                                       value = 100, min = 10, max = 1000),
                          
                          h5("ุถุฑุงุจ ูุชุบุฑูุง:"),
                          sliderInput("mlr_beta1", "ุถุฑุจ Xโ:", 
                                      min = -2, max = 2, value = 0.7, step = 0.1),
                          sliderInput("mlr_beta2", "ุถุฑุจ Xโ:", 
                                      min = -2, max = 2, value = 0.5, step = 0.1),
                          sliderInput("mlr_intercept", "ุนุฑุถ ุงุฒ ูุจุฏุฃ:", 
                                      min = -10, max = 10, value = 3, step = 1),
                          
                          sliderInput("mlr_correlation", "ููุจุณุชฺฏ ุจู Xโ ู Xโ:", 
                                      min = -0.8, max = 0.8, value = 0.3, step = 0.1),
                          actionButton("run_mlr", "ุงุฌุฑุง ุฑฺฏุฑุณูู ฺูุฏฺฏุงูู")
                   ),
                   column(8,
                          plotOutput("mlr_plot"),
                          verbatimTextOutput("mlr_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ุฑฺฏุฑุณูู ุณุงุฏู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ุขุง ุณู ูโุชูุงูุฏ ูุดุงุฑ ุฎูู ุฑุง ูพุดโุจู ฺฉูุฏุ"),
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ูุดุงุฑ ุฎูู ุณุณุชููฺฉ"),
                                tags$li(tags$b("ูุชุบุฑ ูุณุชูู:"), "ุณู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "Rยฒ = 0.42, ฮฒ = 0.65, p < 0.001"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุณู ดฒูช ุงุฒ ูุงุฑุงูุณ ูุดุงุฑ ุฎูู ุฑุง ุชุจู ูโฺฉูุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ูุซุงู ฒ: ุฑฺฏุฑุณูู ฺูุฏฺฏุงูู"),
                              tags$ul(
                                tags$li(tags$b("ุณูุงู:"), "ฺู ุนูุงูู ุณุทุญ ููุฏ ุฎูู ุฑุง ูพุดโุจู ูโฺฉููุฏุ"),
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุณุทุญ ููุฏ ุฎูู ูุงุดุชุง"),
                                tags$li(tags$b("ูุชุบุฑูุง ูุณุชูู:"), "ุณูุ BMIุ ุณุงุจูู ุฎุงููุงุฏฺฏ"),
                                tags$li(tags$b("ูุชุงุฌ:"), "Rยฒ = 0.58, ููู ูุชุบุฑูุง ูุนูโุฏุงุฑ"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ูุฏู ตธูช ุงุฒ ูุงุฑุงูุณ ููุฏ ุฎูู ุฑุง ุชุจู ูโฺฉูุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ุชุดุฎุต ูุดฺฉูุงุช ุฏุฑ ุฑฺฏุฑุณูู"),
                 div(class = "warning-box",
                     h4("ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญูโูุง"),
                     tags$ul(
                       tags$li(tags$b("ููุฎุท (Multicollinearity):"),
                               tags$ul(
                                 tags$li("ุนูุงุฆู: ุถุฑุงุจ ูุงูพุงุฏุงุฑุ ุนูุงุฆู ุบุฑููุทู"),
                                 tags$li("ุชุดุฎุต: VIF > 10"),
                                 tags$li("ุฑุงูโุญู: ุญุฐู ูุชุบุฑูุง ููุจุณุชูุ PCA")
                               )),
                       tags$li(tags$b("ููุถ ููุณุงู ูุงุฑุงูุณ:"),
                               tags$ul(
                                 tags$li("ุนูุงุฆู: ุงูฺฏู ูู ุฏุฑ ูููุฏุงุฑ residuals"),
                                 tags$li("ุชุดุฎุต: ุขุฒููู ุจุฑูุด-ูพุงฺฏุงู"),
                                 tags$li("ุฑุงูโุญู: ุชุจุฏู ูุชุบุฑุ ุฑฺฏุฑุณูู ูุฒู")
                               )),
                       tags$li(tags$b("ููุงุฏุฑ ูพุฑุช:"),
                               tags$ul(
                                 tags$li("ุชุดุฎุต: ูููุฏุงุฑ residualsุ ูุงุตูู ฺฉูฺฉ"),
                                 tags$li("ุฑุงูโุญู: ุจุฑุฑุณ ุฏุงุฏูุ ุญุฐู ุง ุชุจุฏู")
                               ))
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ ุฑฺฏุฑุณูู"),
                 div(class = "highlight-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด"),
                     h5("ุจุฑุง ุฑฺฏุฑุณูู ุณุงุฏู:"),
                     p("ูุฏู ุฑฺฏุฑุณูู ูุนูโุฏุงุฑ ุจูุฏ (F(1, 98) = 45.6, p < 0.001) ู ณฒูช ุงุฒ ูุงุฑุงูุณ ูุชุบุฑ ูุงุจุณุชู ุฑุง ุชุจู ฺฉุฑุฏ. ุณู ูพุดโุจู ูุนูโุฏุงุฑ ูุดุงุฑ ุฎูู ุจูุฏ (ฮฒ = 0.65, p < 0.001)."),
                     
                     h5("ุจุฑุง ุฑฺฏุฑุณูู ฺูุฏฺฏุงูู:"),
                     p("ูุฏู ุฑฺฏุฑุณูู ูุนูโุฏุงุฑ ุจูุฏ (F(3, 96) = 32.8, p < 0.001, Rยฒ = 0.51). ุณู (ฮฒ = 0.42, p < 0.001)ุ BMI (ฮฒ = 0.28, p = 0.01) ู ุณุงุจูู ุฎุงููุงุฏฺฏ (ฮฒ = 0.35, p < 0.001) ูพุดโุจูโูุง ูุนูโุฏุงุฑ ุจูุฏูุฏ."),
                     
                     h5("ุฌุฏูู ุถุฑุงุจ:"),
                     p("ููุดู ุฌุฏูู ุถุฑุงุจ ุจุง ููุงุฏุฑ ฮฒุ ุฎุทุง ุงุณุชุงูุฏุงุฑุฏุ ุขูุงุฑู t ู p-value ฺฏุฒุงุฑุด ุดูุฏ.")
                 )
             )
           ),
           
           "logistic_regression" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุฑฺฏุฑุณูู ูุฌุณุชฺฉ (Logistic Regression)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุฑฺฏุฑุณูู ูุฌุณุชฺฉ"),
                     p("ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ุจุฑุง ูุฏูโุณุงุฒ ุฑุงุจุทู ุจู ฺฉ ูุชุบุฑ ูุงุจุณุชู ุฏูุญุงูุช (ุจุงูุฑ) ู ฺฉ ุง ฺูุฏ ูุชุบุฑ ูุณุชูู ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ุฑูุด ุงุญุชูุงู ุฑุฎุฏุงุฏ ฺฉ ุฑูุฏุงุฏ ุฑุง ูพุดโุจู ูโฺฉูุฏ."),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุฏูุญุงูุช (ฐ ู ฑ)"),
                       tags$li(tags$b("ุฎุฑูุฌ:"), "ุงุญุชูุงู ุจู ฐ ู ฑ"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ูพุดโุจู ุฎุทุฑ ุจูุงุฑ ููุจ"),
                                 tags$li("ุนูุงูู ูุคุซุฑ ุจุฑ ูพุงุณุฎ ุจู ุฏุฑูุงู"),
                                 tags$li("ูพุดโุจู ูุฑฺฏ ู ูุฑ ุจูุงุฑุงู")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุงููุงุน ุฑฺฏุฑุณูู ูุฌุณุชฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ุณุงุฏู"),
                              tags$ul(
                                tags$li("ฺฉ ูุชุบุฑ ูุณุชูู ู ฺฉ ูุชุบุฑ ูุงุจุณุชู ุฏูุญุงูุช"),
                                tags$li(tags$b("ูุฏู:"), "logit(p) = ln(p/(1-p)) = ฮฒโ + ฮฒโx"),
                                tags$li(tags$b("ุชุงุจุน ูพููุฏ:"), "ุชุงุจุน logit"),
                                tags$li(tags$b("ูุซุงู:"), "ูพุดโุจู ุฏุงุจุช ุจุฑ ุงุณุงุณ ุณู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ฺูุฏฺฏุงูู"),
                              tags$ul(
                                tags$li("ฺูุฏ ูุชุบุฑ ูุณุชูู ู ฺฉ ูุชุบุฑ ูุงุจุณุชู ุฏูุญุงูุช"),
                                tags$li(tags$b("ูุฏู:"), "logit(p) = ฮฒโ + ฮฒโxโ + ฮฒโxโ + ..."),
                                tags$li(tags$b("ูุฒุงุง:"),
                                        tags$ul(
                                          tags$li("ฺฉูุชุฑู ุงุซุฑ ูุชุบุฑูุง ูุฎุฏูุดฺฏุฑ"),
                                          tags$li("ุจุฑุฑุณ ุงุซุฑุงุช ูุณุชูู ุนูุงูู ุฎุทุฑ"),
                                          tags$li("ูุญุงุณุจู odds ratio ุชุนุฏูโุดุฏู")
                                        )),
                                tags$li(tags$b("ูุซุงู:"), "ูพุดโุจู ุฏุงุจุช ุจุฑ ุงุณุงุณ ุณูุ BMI ู ุณุงุจูู ุฎุงููุงุฏฺฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ููุงูู ูพุงู ุฏุฑ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ"),
                 div(class = "warning-box",
                     h4("ุดุงุฎุตโูุง ููู"),
                     tags$ul(
                       tags$li(tags$b("ุงุญุชูุงู (Probability):"), "ุดุงูุณ ุฑุฎุฏุงุฏ ุฑูุฏุงุฏ (ฐ ุชุง ฑ)"),
                       tags$li(tags$b("ุดุงูุณ (Odds):"), "ูุณุจุช ุงุญุชูุงู ุฑุฎุฏุงุฏ ุจู ุนุฏู ุฑุฎุฏุงุฏ"),
                       tags$li(tags$b("ูุงุฌุช (Logit):"), "ูฺฏุงุฑุชู ุทุจุน ุดุงูุณ"),
                       tags$li(tags$b("ูุณุจุช ุดุงูุณ (Odds Ratio):"), "ุชุบุฑ ุดุงูุณ ุจู ุงุฒุง ฺฉ ูุงุญุฏ ุชุบุฑ ุฏุฑ ูุชุบุฑ ูุณุชูู"),
                       tags$li(tags$b("ุขูุงุฑู -2LogLikelihood:"), "ูุนุงุฑ ุจุฑุงุฒุด ูุฏู")
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ุณุงุฏู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุฏู"),
                          sliderInput("logit_beta", "ุถุฑุจ ูุชุบุฑ ูุณุชูู:", 
                                      min = -3, max = 3, value = 0.8, step = 0.1),
                          sliderInput("logit_intercept", "ุนุฑุถ ุงุฒ ูุจุฏุฃ:", 
                                      min = -5, max = 5, value = -1, step = 0.1),
                          numericInput("logit_sample_size", "ุญุฌู ููููู:", 
                                       value = 200, min = 50, max = 1000),
                          sliderInput("logit_base_prob", "ุงุญุชูุงู ูพุงู:", 
                                      min = 0.1, max = 0.9, value = 0.3, step = 0.05),
                          actionButton("run_logit", "ุงุฌุฑุง ุฑฺฏุฑุณูู ูุฌุณุชฺฉ")
                   ),
                   column(8,
                          plotOutput("logit_plot"),
                          verbatimTextOutput("logit_results")
                   )
                 ),
                 
                 h3("๐ ุชูุณุฑ ูุณุจุช ุดุงูุณ (Odds Ratio)"),
                 div(class = "info-box",
                     h4("ุฑุงูููุง ุชูุณุฑ OR"),
                     tableOutput("or_interpretation_table"),
                     h5("ูฺฉุงุช ููู:"),
                     tags$ul(
                       tags$li("OR = 1: ูุชุบุฑ ูุณุชูู ุงุซุฑ ูุฏุงุฑุฏ"),
                       tags$li("OR > 1: ูุชุบุฑ ูุณุชูู ุฎุทุฑ ุฑุง ุงูุฒุงุด ูโุฏูุฏ"),
                       tags$li("OR < 1: ูุชุบุฑ ูุณุชูู ุฎุทุฑ ุฑุง ฺฉุงูุด ูโุฏูุฏ"),
                       tags$li("ูุงุตูู ุงุทููุงู OR ุดุงูู ฑ ูุจุงุดุฏ: ุงุซุฑ ูุนูโุฏุงุฑ ุงุณุช")
                     )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ุนูุงูู ุฎุทุฑ ุจูุงุฑ ููุจ"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุจูุงุฑ ููุจ (ุฏุงุฑุฏ/ูุฏุงุฑุฏ)"),
                                tags$li(tags$b("ูุชุบุฑูุง ูุณุชูู:"), "ุณูุ ูุดุงุฑ ุฎููุ ฺฉูุณุชุฑูู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ุณู: OR = 1.8, ูุดุงุฑ ุฎูู: OR = 2.1"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุจุง ูุฑ ุณุงู ุงูุฒุงุด ุณูุ ุดุงูุณ ุจูุงุฑ ููุจ ธฐูช ุงูุฒุงุด ูโุงุจุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ูุซุงู ฒ: ูพุดโุจู ูพุงุณุฎ ุจู ุฏุฑูุงู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ูพุงุณุฎ ุจู ุฏุฑูุงู (ูููู/ูุงูููู)"),
                                tags$li(tags$b("ูุชุบุฑูุง ูุณุชูู:"), "ุณูุ ุดุฏุช ุจูุงุฑุ ููุน ุฏุฑูุงู"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ุฏุฑูุงู A vs B: OR = 0.4"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุดุงูุณ ููููุช ุฏุฑูุงู A ูุณุจุช ุจู B ถฐูช ฺฉูุชุฑ ุงุณุช")
                              )
                          )
                   )
                 )
             )
           ),
           
           "count_regression" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุฑฺฏุฑุณูู ุดูุงุฑุด (Count Regression)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุฑฺฏุฑุณูู ุดูุงุฑุด"),
                     p("ุฑฺฏุฑุณูู ุดูุงุฑุด ุจุฑุง ูุฏูโุณุงุฒ ูุชุบุฑูุง ูุงุจุณุชู ฺฉู ุชุนุฏุงุฏ ุฑูุฏุงุฏูุง ุฑุง ุฏุฑ ฺฉ ุจุงุฒู ุฒูุงู ุง ูฺฉุงู ูุดุงู ูโุฏููุฏ ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ูุชุบุฑูุง ููุงุฏุฑ ุตุญุญ ู ุบุฑููู ุฏุงุฑูุฏ."),
                     tags$ul(
                       tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุดูุงุฑุด (ฐ, ฑ, ฒ, ณ, ...)"),
                       tags$li(tags$b("ุชูุฒุน:"), "ูพูุงุณูู ุง ุฏูุฌูููโุง ููู"),
                       tags$li(tags$b("ูุซุงูโูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ุชุนุฏุงุฏ ุฏูุนุงุช ุจุณุชุฑ ุฏุฑ ุจูุงุฑุณุชุงู"),
                                 tags$li("ุชุนุฏุงุฏ ุนูููุชโูุง ุจูุงุฑุณุชุงู"),
                                 tags$li("ุชุนุฏุงุฏ ุฏุงุฑููุง ูุตุฑู ุจูุงุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ุงููุงุน ุฑฺฏุฑุณูู ุดูุงุฑุด"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุฑฺฏุฑุณูู ูพูุงุณูู"),
                              tags$ul(
                                tags$li("ุจุฑุง ุฏุงุฏูโูุง ุดูุงุฑุด ุจุง ูุงุฑุงูุณ ุจุฑุงุจุฑ ูุงูฺฏู"),
                                tags$li(tags$b("ูุฏู:"), "ln(ฮป) = ฮฒโ + ฮฒโxโ + ฮฒโxโ + ..."),
                                tags$li(tags$b("ูพุดโูุฑุถ:"), "ูุงูฺฏู = ูุงุฑุงูุณ"),
                                tags$li(tags$b("ุชุงุจุน ูพููุฏ:"), "ูฺฏุงุฑุชู"),
                                tags$li(tags$b("ูุซุงู:"), "ูุฏูโุณุงุฒ ุชุนุฏุงุฏ ุนูููุชโูุง ุจูุงุฑุณุชุงู")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ุฑฺฏุฑุณูู ุฏูุฌูููโุง ููู"),
                              tags$ul(
                                tags$li("ุจุฑุง ุฏุงุฏูโูุง ุดูุงุฑุด ุจุง ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ"),
                                tags$li(tags$b("ูุฏู:"), "ูุงููุฏ ูพูุงุณูู ุงูุง ุจุง ูพุงุฑุงูุชุฑ ูพุฑุงฺฉูุฏฺฏ ุงุถุงู"),
                                tags$li(tags$b("ฺฉุงุฑุจุฑุฏ:"), "ููุช ูุงุฑุงูุณ > ูุงูฺฏู"),
                                tags$li(tags$b("ูุฒุช:"), "ุงูุนุทุงูโูพุฐุฑ ุจุดุชุฑ ุฏุฑ ูุฏูโุณุงุฒ ูพุฑุงฺฉูุฏฺฏ"),
                                tags$li(tags$b("ูุซุงู:"), "ูุฏูโุณุงุฒ ุชุนุฏุงุฏ ุฏูุนุงุช ูุฑุงุฌุนู ุจู ุงูุฑฺุงูุณ")
                              )
                          )
                   )
                 ),
                 
                 h3("๐ ุชุดุฎุต ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ"),
                 div(class = "info-box",
                     h4("ุฑูุดโูุง ุชุดุฎุต"),
                     tags$ul(
                       tags$li(tags$b("ูุณุจุช ูุงุฑุงูุณ ุจู ูุงูฺฏู:"), "ุงฺฏุฑ > 1.5 ุจุงุดุฏ ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ ูุฌูุฏ ุฏุงุฑุฏ"),
                       tags$li(tags$b("ุขุฒููู likelihood ratio:"), "ููุงุณู ูุฏู ูพูุงุณูู ู ุฏูุฌูููโุง ููู"),
                       tags$li(tags$b("ูููุฏุงุฑ ูุฑุงูุงู:"), "ููุงุณู ุชูุฒุน ูุดุงูุฏู ุดุฏู ุจุง ูพูุงุณูู"),
                       tags$li(tags$b("ุขูุงุฑู ูพุฑุงฺฉูุฏฺฏ:"), "ููุฏุงุฑ > 1 ูุดุงูโุฏููุฏู ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ ุงุณุช")
                     )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ูพูุงุณูู"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุฏู"),
                          sliderInput("poisson_lambda", "ูุงูฺฏู (ฮป):", 
                                      min = 0.5, max = 10, value = 3, step = 0.5),
                          sliderInput("poisson_beta", "ุถุฑุจ ูุชุบุฑ ูุณุชูู:", 
                                      min = -1, max = 1, value = 0.2, step = 0.05),
                          numericInput("poisson_sample_size", "ุญุฌู ููููู:", 
                                       value = 200, min = 50, max = 1000),
                          sliderInput("poisson_overdispersion", "ุฏุฑุฌู ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ:", 
                                      min = 1, max = 3, value = 1, step = 0.1),
                          actionButton("run_poisson", "ุงุฌุฑุง ุฑฺฏุฑุณูู ูพูุงุณูู")
                   ),
                   column(8,
                          plotOutput("poisson_plot"),
                          verbatimTextOutput("poisson_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ูุซุงู ฑ: ุนูููุชโูุง ุจูุงุฑุณุชุงู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุชุนุฏุงุฏ ุนูููุชโูุง ุจูุงุฑุณุชุงู ุฏุฑ ูุงู"),
                                tags$li(tags$b("ูุชุบุฑูุง ูุณุชูู:"), "ุทูู ุจุณุชุฑุ ุณูุ ููุน ุฌุฑุงุญ"),
                                tags$li(tags$b("ูุฏู:"), "ุฑฺฏุฑุณูู ูพูุงุณูู"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุจุง ูุฑ ุฑูุฒ ุงูุฒุงุด ุทูู ุจุณุชุฑุ ุชุนุฏุงุฏ ุนูููุชโูุง ฑตูช ุงูุฒุงุด ูโุงุจุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ูุซุงู ฒ: ูุฑุงุฌุนุงุช ุงูุฑฺุงูุณ"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑ ูุงุจุณุชู:"), "ุชุนุฏุงุฏ ูุฑุงุฌุนู ุจู ุงูุฑฺุงูุณ ุฏุฑ ุณุงู"),
                                tags$li(tags$b("ูุชุบุฑูุง ูุณุชูู:"), "ุณูุ ุจูุงุฑโูุง ูุฒููุ ุฏุณุชุฑุณ ุจู ูพุฒุดฺฉ"),
                                tags$li(tags$b("ูุฏู:"), "ุฑฺฏุฑุณูู ุฏูุฌูููโุง ููู"),
                                tags$li(tags$b("ุชูุณุฑ:"), "ุจูุงุฑุงู ุจุง ุจูุงุฑ ูุฒูู ฒ.ณ ุจุฑุงุจุฑ ุจุดุชุฑ ุจู ุงูุฑฺุงูุณ ูุฑุงุฌุนู ูโฺฉููุฏ")
                              )
                          )
                   )
                 )
             )
           ),
           
           "survival_analysis" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุชุญูู ุจูุง (Survival Analysis)"),
                 
                 h3("๐ ููุฏูู"),
                 div(class = "highlight-box",
                     h4("ุชุนุฑู ุชุญูู ุจูุง"),
                     p("ุชุญูู ุจูุง ูุฌููุนูโุง ุงุฒ ุฑูุดโูุง ุขูุงุฑ ุจุฑุง ุชุญูู ุฏุงุฏูโูุง 'ุฒูุงู ุชุง ูููุน ุฑุฎุฏุงุฏ' ุงุณุช. ุงู ุฑูุดโูุง ุฒูุงู ุงุณุชูุงุฏู ูโุดููุฏ ฺฉู ูุชุบุฑ ูพุงุณุฎุ ุฒูุงู ุชุง ูููุน ฺฉ ุฑูุฏุงุฏ ุฎุงุต ุจุงุดุฏ."),
                     tags$ul(
                       tags$li(tags$b("ุฑูุฏุงุฏ (Event):"), "ุงุชูุงู ููุฑุฏ ูุทุงูุนู (ูุซูุงู ูุฑฺฏุ ุนูุฏ ุจูุงุฑุ ุจูุจูุฏ)"),
                       tags$li(tags$b("ุฒูุงู ุจูุง (Survival Time):"), "ูุงุตูู ุฒูุงู ุงุฒ ุดุฑูุน ูุทุงูุนู ุชุง ูููุน ุฑูุฏุงุฏ"),
                       tags$li(tags$b("ุณุงูุณูุฑุดุฏฺฏ (Censoring):"), "ููุช ุฒูุงู ุฏูู ุฑูุฏุงุฏ ุจุฑุง ุจุฑุฎ ุงูุฑุงุฏ ูุดุฎุต ูุณุช"),
                       tags$li(tags$b("ฺฉุงุฑุจุฑุฏูุง ูพุฒุดฺฉ:"),
                               tags$ul(
                                 tags$li("ูุทุงูุนู ุทูู ุนูุฑ ุจูุงุฑุงู ูพุณ ุงุฒ ุชุดุฎุต ุจูุงุฑ"),
                                 tags$li("ููุงุณู ุงุซุฑุจุฎุด ุฏุฑูุงูโูุง ูุฎุชูู"),
                                 tags$li("ุดูุงุณุง ุนูุงูู ูพุดโุขฺฏู ุจูุงุฑ"),
                                 tags$li("ุจุฑุฑุณ ุฒูุงู ุนูุฏ ุจูุงุฑ")
                               ))
                     )
                 ),
                 
                 h3("๐ฏ ููุงูู ูพุงู ุฏุฑ ุชุญูู ุจูุง"),
                 fluidRow(
                   column(6,
                          div(class = "success-box",
                              h4("ุชุงุจุน ุจูุง (Survival Function)"),
                              tags$ul(
                                tags$li("S(t) = P(T > t)"),
                                tags$li("ุงุญุชูุงู ุฒูุฏู ูุงูุฏู ุชุง ุฒูุงู t"),
                                tags$li("ููุฏุงุฑ ุจู 0 ู 1"),
                                tags$li("ุชุงุจุน ูุฒูู"),
                                tags$li(tags$b("ูุซุงู:"), "ุงุญุชูุงู ุฒูุฏู ูุงูุฏู ุจูุงุฑุงู ุณุฑุทุงู ุชุง 5 ุณุงู ูพุณ ุงุฒ ุชุดุฎุต")
                              )
                          )
                   ),
                   column(6,
                          div(class = "info-box",
                              h4("ุชุงุจุน ุฎุทุฑ (Hazard Function)"),
                              tags$ul(
                                tags$li("h(t) = lim(ฮtโ0) P(t โค T < t+ฮt | T โฅ t)/ฮt"),
                                tags$li("ูุฑุฎ ูุญุธูโุง ูููุน ุฑูุฏุงุฏ"),
                                tags$li("ุฑุณฺฉ ููุฑ ุฏุฑ ุฒูุงู t"),
                                tags$li(tags$b("ูุซุงู:"), "ูุฑุฎ ูุฑฺฏ ุจูุงุฑุงู ููุจ ุฏุฑ ูุงู ุงูู ูพุณ ุงุฒ ุฌุฑุงุญ")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ุงููุงุน ุณุงูุณูุฑุดุฏฺฏ"),
                 div(class = "warning-box",
                     h4("ุณุงูุณูุฑุดุฏฺฏ ุฑุงุณุช (Right Censoring)"),
                     tags$ul(
                       tags$li(tags$b("ุณุงูุณูุฑ ููุน I:"), "ูพุงุงู ูุทุงูุนู ูุจู ุงุฒ ูููุน ุฑูุฏุงุฏ ุจุฑุง ุจุฑุฎ ุงูุฑุงุฏ"),
                       tags$li(tags$b("ุณุงูุณูุฑ ููุน II:"), "ูพุงุงู ูุทุงูุนู ูพุณ ุงุฒ ูููุน ุชุนุฏุงุฏ ูุดุฎุต ุฑูุฏุงุฏ"),
                       tags$li(tags$b("ุณุงูุณูุฑ ุชุตุงุฏู:"), "ุฎุฑูุฌ ุงุฒ ูุทุงูุนู ุจู ุฏูุงู ูุฎุชูู (ููุงุฌุฑุชุ ุงุฒ ุฏุณุช ุฏุงุฏู ูพฺฏุฑ)"),
                       tags$li(tags$b("ููุงุฏ:"), "ุนูุงูุช + ุจุฑุง ุฏุงุฏูโูุง ุณุงูุณูุฑ ุดุฏู")
                     ),
                     h5("ูุซุงู:"),
                     p("ุจูุงุฑ ฺฉู ุชุง ูพุงุงู ูุทุงูุนู ุฒูุฏู ูุงูุฏู: ุฒูุงู 36+ ูุงู")
                 ),
                 
                 h3("๐ ุชุฎูู ฺฉุงูพูุงู-ูุงุฑ (Kaplan-Meier)"),
                 div(class = "info-box",
                     h4("ุฑูุด ฺฉุงูพูุงู-ูุงุฑ"),
                     tags$ul(
                       tags$li("ุชุฎูู ุบุฑูพุงุฑุงูุชุฑ ุชุงุจุน ุจูุง"),
                       tags$li("ููุงุณุจ ุจุฑุง ุฏุงุฏูโูุง ุณุงูุณูุฑ ุดุฏู"),
                       tags$li("ุงุฌุงุฏ ููุญู ุจูุง"),
                       tags$li("ูุญุงุณุจู ุงุญุชูุงู ุจูุง ุฏุฑ ุฒูุงูโูุง ูุฎุชูู"),
                       tags$li(tags$b("ูุฑููู:"), "S(t) = ฮ(1 - dแตข/nแตข) ุจุฑุง ุชูุงู i ฺฉู tแตข โค t")
                     )
                 ),
                 
                 h3("๐ ุขุฒููู ูฺฏุฑุงูฺฉ (Log-Rank Test)"),
                 div(class = "highlight-box",
                     h4("ููุงุณู ููุญูโูุง ุจูุง"),
                     tags$ul(
                       tags$li("ููุงุณู ููุญูโูุง ุจูุง ุฏู ุง ฺูุฏ ฺฏุฑูู"),
                       tags$li("ุขุฒููู ูุงูพุงุฑุงูุชุฑ"),
                       tags$li("Hโ: ููู ููุญูโูุง ุจูุง ฺฉุณุงู ูุณุชูุฏ"),
                       tags$li("Hโ: ุญุฏุงูู ุฏู ููุญู ุจุง ูู ุชูุงูุช ุฏุงุฑูุฏ"),
                       tags$li(tags$b("ูุซุงู:"), "ููุงุณู ุจูุง ุจูุงุฑุงู ุจุง ุฏู ุฑูุด ุฏุฑูุงู ูุฎุชูู")
                     )
                 ),
                 
                 h3("๐ ุฑฺฏุฑุณูู ฺฉุงฺฉุณ (Cox Regression)"),
                 div(class = "success-box",
                     h4("ูุฏู ุฎุทุฑุงุช ูุชูุงุณุจ ฺฉุงฺฉุณ"),
                     tags$ul(
                       tags$li("h(t) = hโ(t) ร exp(ฮฒโxโ + ฮฒโxโ + ... + ฮฒโxโ)"),
                       tags$li("hโ(t): ุชุงุจุน ุฎุทุฑ ูพุงู"),
                       tags$li("ฮฒแตข: ุถุฑุงุจ ุฑฺฏุฑุณูู"),
                       tags$li("xแตข: ูุชุบุฑูุง ูพุดโุจู"),
                       tags$li("ูุณุจุช ุฎุทุฑ (Hazard Ratio): exp(ฮฒ)"),
                       tags$li("ูพุดโูุฑุถ: ุฎุทุฑุงุช ูุชูุงุณุจ (Proportional Hazards)")
                     )
                 ),
                 
                 h3("๐ง ุดุจูโุณุงุฒ ููุญู ฺฉุงูพูุงู-ูุงุฑ"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ฺฏุฑููโูุง"),
                          numericInput("km_n_groups", "ุชุนุฏุงุฏ ฺฏุฑููโูุง:", 
                                       value = 2, min = 1, max = 4),
                          numericInput("km_sample_size", "ุญุฌู ููููู ูุฑ ฺฏุฑูู:", 
                                       value = 100, min = 10, max = 500),
                          
                          h5("ูุงูฺฏู ุฒูุงู ุจูุง (ูุงู):"),
                          numericInput("km_group1_mean", "ฺฏุฑูู ฑ:", value = 24),
                          numericInput("km_group2_mean", "ฺฏุฑูู ฒ:", value = 36),
                          conditionalPanel(
                            condition = "input.km_n_groups >= 3",
                            numericInput("km_group3_mean", "ฺฏุฑูู ณ:", value = 30)
                          ),
                          conditionalPanel(
                            condition = "input.km_n_groups >= 4",
                            numericInput("km_group4_mean", "ฺฏุฑูู ด:", value = 42)
                          ),
                          
                          sliderInput("km_censoring", "ุฏุฑุตุฏ ุณุงูุณูุฑุดุฏฺฏ:", 
                                      min = 0, max = 50, value = 20, step = 5),
                          actionButton("run_km", "ูุญุงุณุจู ููุญู ุจูุง")
                   ),
                   column(8,
                          plotOutput("km_plot"),
                          verbatimTextOutput("km_results")
                   )
                 ),
                 
                 h3("๐ ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ฺฉุงฺฉุณ"),
                 fluidRow(
                   column(4,
                          h4("ุชูุธูุงุช ูุฏู"),
                          numericInput("cox_sample_size", "ุญุฌู ููููู:", 
                                       value = 200, min = 50, max = 1000),
                          
                          h5("ูุณุจุช ุฎุทุฑ (Hazard Ratio):"),
                          sliderInput("cox_hr_age", "ุณู (ุจู ุงุฒุง 10 ุณุงู):", 
                                      min = 0.5, max = 3, value = 1.2, step = 0.1),
                          sliderInput("cox_hr_treatment", "ุฏุฑูุงู (ุฌุฏุฏ vs ูุฏู):", 
                                      min = 0.1, max = 2, value = 0.6, step = 0.1),
                          sliderInput("cox_hr_stage", "ูุฑุญูู ุจูุงุฑ (ูพุดุฑูุชู vs ุงููู):", 
                                      min = 1, max = 5, value = 2.5, step = 0.1),
                          
                          actionButton("run_cox", "ุงูุฌุงู ุฑฺฏุฑุณูู ฺฉุงฺฉุณ")
                   ),
                   column(8,
                          plotOutput("cox_plot"),
                          verbatimTextOutput("cox_results")
                   )
                 ),
                 
                 h3("๐ฏ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ ุฏุฑ ูพุฒุดฺฉ"),
                 fluidRow(
                   column(6,
                          div(class = "info-box",
                              h4("ูุซุงู ฑ: ูุทุงูุนู ุณุฑุทุงู ูพุณุชุงู"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุฒูุงู ุจูุงุ ูุถุนุช ูุฑฺฏุ ุณูุ ูุฑุญูู ุชูููุฑุ ููุน ุฏุฑูุงู"),
                                tags$li(tags$b("ุชุญูู:"), "ููุญู ฺฉุงูพูุงู-ูุงุฑ + ุขุฒููู ูฺฏุฑุงูฺฉ"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ุชูุงูุช ูุนูโุฏุงุฑ ุฏุฑ ุจูุง ุจูุงุฑุงู ุจุง ุฏุฑูุงูโูุง ูุฎุชูู"),
                                tags$li(tags$b("ูุชุฌู:"), "ุฏุฑูุงู ุฌุฏุฏ ุจูุง ุจูุชุฑ ุฏุงุฑุฏ")
                              )
                          )
                   ),
                   column(6,
                          div(class = "warning-box",
                              h4("ูุซุงู ฒ: ูุทุงูุนู ุจูุงุฑุงู ููุจ"),
                              tags$ul(
                                tags$li(tags$b("ูุชุบุฑูุง:"), "ุฒูุงู ุชุง ุนูุฏ ุจูุงุฑุ ุณูุ ุฌูุณุชุ ูุดุงุฑ ุฎููุ ฺฉูุณุชุฑูู"),
                                tags$li(tags$b("ุชุญูู:"), "ุฑฺฏุฑุณูู ฺฉุงฺฉุณ"),
                                tags$li(tags$b("ูุชุงุฌ:"), "ุณู ู ูุดุงุฑ ุฎูู ุนูุงูู ุฎุทุฑ ูุณุชูู ูุณุชูุฏ"),
                                tags$li(tags$b("ูุชุฌู:"), "ฺฉูุชุฑู ูุดุงุฑ ุฎูู ุฎุทุฑ ุนูุฏ ุฑุง ฺฉุงูุด ูโุฏูุฏ")
                              )
                          )
                   )
                 ),
                 
                 h3("โ๏ธ ูพุดโูุฑุถโูุง ููู"),
                 div(class = "warning-box",
                     h4("ูพุดโูุฑุถ ุฎุทุฑุงุช ูุชูุงุณุจ"),
                     tags$ul(
                       tags$li("ูุณุจุช ุฎุทุฑ ุฏุฑ ุทูู ุฒูุงู ุซุงุจุช ุงุณุช"),
                       tags$li("ุจุฑุฑุณ ุจุง ูููุฏุงุฑ ูฺฏ-ูฺฏ (Log-Log Plot)"),
                       tags$li("ุขุฒููู ุดุงูพุฑู (Schoenfeld Residuals)"),
                       tags$li("ุงูุฏุงู ุฏุฑ ุตูุฑุช ููุถ:"),
                       tags$ul(
                         tags$li("ุงุณุชุฑุงุชูฺฉุดู (Stratification)"),
                         tags$li("ุงุถุงูู ฺฉุฑุฏู ุจุฑููฺฉูุด ุจุง ุฒูุงู"),
                         tags$li("ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ูพุงุฑุงูุชุฑฺฉ")
                       )
                     )
                 ),
                 
                 h3("๐ ฺฏุฒุงุฑุด ูุชุงุฌ"),
                 div(class = "highlight-box",
                     h4("ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุด"),
                     h5("ุจุฑุง ููุญู ฺฉุงูพูุงู-ูุงุฑ:"),
                     p("ูุงูฺฏู ุจูุง ฺฏุฑูู A: X ูุงู (ูุงุตูู ุงุทููุงู 95%: Y-Z)ุ ฺฏุฑูู B: ..."),
                     p("ุขุฒููู ูฺฏุฑุงูฺฉ: ฯยฒ(df, N) = ููุฏุงุฑ, p = ููุฏุงุฑ"),
                     
                     h5("ุจุฑุง ุฑฺฏุฑุณูู ฺฉุงฺฉุณ:"),
                     p("ูุณุจุช ุฎุทุฑ (HR) = ููุฏุงุฑ, ูุงุตูู ุงุทููุงู 95% = [ุญุฏ ูพุงู, ุญุฏ ุจุงูุง], p = ููุฏุงุฑ"),
                     p("ูุซุงู: ุณู (ุจู ุงุฒุง 10 ุณุงู): HR = 1.45, 95% CI [1.20-1.75], p < 0.001"),
                     
                     h5("ุชูุณุฑ:"),
                     p("ูุชุงุฌ ูุดุงู ุฏุงุฏ ฺฉู ุฏุฑูุงู ุฌุฏุฏ ุจุง ฺฉุงูุด 40% ุฏุฑ ุฎุทุฑ ูุฑฺฏ ููุฑุงู ุงุณุช (HR = 0.60, 95% CI [0.45-0.80], p = 0.001).")
                 ),
                 
                 h3("๐ ุฎูุงุตู ุฑูุดโูุง ุชุญูู ุจูุง"),
                 tableOutput("survival_methods_table"),
                 
                 h3("๐ฏ ูฺฉุงุช ุนูู ุจุฑุง ูพฺููุดฺฏุฑุงู"),
                 div(class = "info-box",
                     h4("ุชูุตูโูุง ููู"),
                     tags$ul(
                       tags$li("ุฏุงุฏูโูุง ุณุงูุณูุฑ ุดุฏู ุฑุง ุจู ุฏุฑุณุช ฺฉุฏฺฏุฐุงุฑ ฺฉูุฏ"),
                       tags$li("ูพุดโูุฑุถ ุฎุทุฑุงุช ูุชูุงุณุจ ุฑุง ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุงุฒ ุขุฒููู ูฺฏุฑุงูฺฉ ุจุฑุง ููุงุณู ฺฏุฑููโูุง ุงุณุชูุงุฏู ฺฉูุฏ"),
                       tags$li("ูุณุจุช ุฎุทุฑ ู ูุงุตูู ุงุทููุงู ุฑุง ฺฏุฒุงุฑุด ุฏูุฏ"),
                       tags$li("ูุฏู ุฑุง ุจุฑุง ุฎุท ุจูุฏู ู ุชุงุซุฑุงุช ุบุฑุฎุท ุจุฑุฑุณ ฺฉูุฏ"),
                       tags$li("ุงุฒ ูููุฏุงุฑูุง ููุงุณุจ ุจุฑุง ููุงุด ูุชุงุฌ ุงุณุชูุงุฏู ฺฉูุฏ")
                     )
                 )
             )
           ),
           
           # ุณุงุฑ ุจุฎุดโูุง...
           
           "normal_sim" = tagList(
             div(class = "rtl-text farsi-font",
                 h2("ุดุจูโุณุงุฒ ุชูุฒุน ูุฑูุงู"),
                 p("ุจุง ุงู ุงุจุฒุงุฑ ูโุชูุงูุฏ ูููููโูุง ุงุฒ ฺฉ ุชูุฒุน ูุฑูุงู ุจุง ูุงูฺฏู ู ุงูุญุฑุงู ูุนุงุฑ ูุดุฎุต ุชููุฏ ฺฉูุฏ ู ูฺฺฏโูุง ุชูุฒุน ูุฑูุงู ุฑุง ุจูุชุฑ ุฏุฑฺฉ ฺฉูุฏ.")
             )
           )
    )
  })
  
  # ุฌุฏุงูู ุจุฑุง ุงููุงุน ูุชุบุฑูุง
  output$variables_table <- renderTable({
    data.frame(
      "ููุน ูุชุบุฑ" = c("ฺฉู ุงุณู", "ฺฉู ุชุฑุชุจ", "ฺฉู ูุงุตููโุง", "ฺฉู ูุณุจ"),
      "ุชุนุฑู" = c("ุจุฏูู ุชุฑุชุจ ุทุจุน", "ุจุง ุชุฑุชุจ ุทุจุน", "ููุงุฏุฑ ุนุฏุฏ ุจุง ูุงุตูู ูุนูโุฏุงุฑ", "ููุงุฏุฑ ุนุฏุฏ ุจุง ุตูุฑ ูุทูู"),
      "ูุซุงู ูพุฒุดฺฉ" = c("ฺฏุฑูู ุฎููุ ุฌูุณุช", "ุฏุฑุฌู ุณุฑุทุงูุ ุณุทุญ ุฏุฑุฏ", "ุฏูุง ุจุฏูุ ููุฑู ุขูพฺฏุงุฑ", "ูุฏุ ูุฒูุ ูุดุงุฑ ุฎูู")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏุงูู ุจุฑุง ุขูุงุฑ ุชูุตู
  output$qualitative_freq_table <- renderTable({
    blood_types <- data.frame(
      "ฺฏุฑูู ุฎูู" = c("A", "B", "O", "AB"),
      "ูุฑุงูุงู ูุทูู" = c(42, 38, 15, 5),
      "ูุฑุงูุงู ูุณุจ" = c(0.42, 0.38, 0.15, 0.05),
      "ูุฑุงูุงู ุฏุฑุตุฏ" = c("42%", "38%", "15%", "5%"),
      "ูุฑุงูุงู ุชุฌูุน" = c(42, 80, 95, 100)
    )
    blood_types
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c', digits = 2)
  
  output$quantitative_freq_table <- renderTable({
    age_intervals <- data.frame(
      "ุจุงุฒู ุณู" = c("20-29", "30-39", "40-49", "50-59", "60-69"),
      "ูุฑุงูุงู ูุทูู" = c(15, 28, 35, 18, 4),
      "ูุฑุงูุงู ูุณุจ" = c(0.15, 0.28, 0.35, 0.18, 0.04),
      "ูุฑุงูุงู ุฏุฑุตุฏ" = c("15%", "28%", "35%", "18%", "4%"),
      "ูุฑุงูุงู ุชุฌูุน" = c(15, 43, 78, 96, 100),
      "ููุทู ูุงู" = c(24.5, 34.5, 44.5, 54.5, 64.5)
    )
    age_intervals
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c', digits = 2)
  
  output$bp_raw_data_table <- renderTable({
    set.seed(123)
    sample_bp <- round(rnorm(10, mean = 125, sd = 15))
    data.frame(
      "ุดูุงุฑู ุจูุงุฑ" = 1:10,
      "ูุดุงุฑ ุฎูู (mmHg)" = sample_bp
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  output$bp_freq_table <- renderTable({
    bp_intervals <- data.frame(
      "ุจุงุฒู ูุดุงุฑ ุฎูู" = c("90-99", "100-109", "110-119", "120-129", "130-139", "140-149", "150-159"),
      "ูุฑุงูุงู ูุทูู" = c(5, 12, 28, 35, 15, 4, 1),
      "ูุฑุงูุงู ูุณุจ" = c(0.05, 0.12, 0.28, 0.35, 0.15, 0.04, 0.01),
      "ูุฑุงูุงู ุฏุฑุตุฏ" = c("5%", "12%", "28%", "35%", "15%", "4%", "1%")
    )
    bp_intervals
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c', digits = 2)
  
  # ูููุฏุงุฑูุง ุฏูู
  output$bar_chart_demo <- renderPlot({
    data <- data.frame(
      Disease = c("ุฏุงุจุช", "ูุดุงุฑ ุฎูู", "ุขุณู", "ููุจ"),
      Count = c(35, 42, 18, 25)
    )
    
    ggplot(data, aes(x = reorder(Disease, -Count), y = Count, fill = Disease)) +
      geom_col(alpha = 0.7, color = "black") +
      geom_text(aes(label = Count), vjust = -0.5, size = 4, family = "Tahoma") +
      scale_fill_brewer(palette = "Set2") +
      theme_minimal() +
      labs(title = "ุดูุน ุจูุงุฑโูุง", x = "ููุน ุจูุงุฑ", y = "ุชุนุฏุงุฏ ุจูุงุฑุงู") +
      theme(text = element_text(family = "Tahoma", size = 10),
            legend.position = "none",
            axis.text.x = element_text(angle = 45, hjust = 1))
  })
  
  output$pie_chart_demo <- renderPlot({
    data <- data.frame(
      RiskFactor = c("ุณฺฏุงุฑ", "ฺุงู", "ุจโุชุญุฑฺฉ", "ุณุงุจูู ุฎุงููุงุฏฺฏ", "ุณุงุฑ"),
      Count = c(30, 25, 20, 15, 10)
    )
    
    ggplot(data, aes(x = "", y = Count, fill = RiskFactor)) +
      geom_col(alpha = 0.7, color = "black") +
      coord_polar("y", start = 0) +
      scale_fill_brewer(palette = "Set3") +
      theme_void() +
      labs(title = "ุชูุฒุน ุนูุงูู ุฎุทุฑ ุจูุงุฑ ููุจ") +
      theme(text = element_text(family = "Tahoma", size = 10),
            legend.position = "bottom",
            plot.title = element_text(hjust = 0.5))
  })
  
  output$histogram_demo <- renderPlot({
    set.seed(123)
    bp_data <- rnorm(200, mean = 125, sd = 15)
    
    ggplot(data.frame(BP = bp_data), aes(x = BP)) +
      geom_histogram(fill = "skyblue", alpha = 0.7, bins = 15, color = "black") +
      geom_vline(xintercept = mean(bp_data), color = "red", linetype = "dashed", size = 1) +
      theme_minimal() +
      labs(title = "ุชูุฒุน ูุดุงุฑ ุฎูู ุฏุฑ ุฌุงูุนู", x = "ูุดุงุฑ ุฎูู (mmHg)", y = "ูุฑุงูุงู") +
      theme(text = element_text(family = "Tahoma", size = 10))
  })
  
  output$boxplot_demo <- renderPlot({
    set.seed(123)
    group1 <- rnorm(50, mean = 120, sd = 10)
    group2 <- rnorm(50, mean = 130, sd = 12)
    group3 <- rnorm(50, mean = 125, sd = 8)
    
    data <- data.frame(
      BP = c(group1, group2, group3),
      Group = rep(c("ฺฏุฑูู A", "ฺฏุฑูู B", "ฺฏุฑูู C"), each = 50)
    )
    
    ggplot(data, aes(x = Group, y = BP, fill = Group)) +
      geom_boxplot(alpha = 0.7, outlier.color = "red") +
      scale_fill_brewer(palette = "Pastel1") +
      theme_minimal() +
      labs(title = "ููุงุณู ูุดุงุฑ ุฎูู ุจู ฺฏุฑููโูุง", x = "ฺฏุฑูู", y = "ูุดุงุฑ ุฎูู (mmHg)") +
      theme(text = element_text(family = "Tahoma", size = 10),
            legend.position = "none")
  })
  
  # ุชูุงุจุน ุณุฑูุฑ ุจุฑุง ูููุฏุงุฑูุง ุขูุงุฑ ุชูุตู
  output$mean_plot <- renderPlot({
    set.seed(123)
    data <- c(rnorm(95, mean = 100, sd = 15), 200)
    
    df <- data.frame(Value = data)
    mean_val <- mean(data)
    
    ggplot(df, aes(x = Value)) +
      geom_histogram(fill = "skyblue", alpha = 0.7, bins = 20, color = "black") +
      geom_vline(xintercept = mean_val, color = "red", size = 1.5, linetype = "dashed") +
      geom_point(aes(x = 200, y = 0), color = "red", size = 3, shape = 8) +
      annotate("text", x = mean_val, y = 15, label = "ูุงูฺฏู", 
               color = "red", hjust = -0.1, family = "Tahoma", size = 5) +
      annotate("text", x = 200, y = 2, label = "ููุฏุงุฑ ูพุฑุช", 
               color = "red", hjust = -0.1, family = "Tahoma", size = 4) +
      theme_minimal() +
      labs(title = "ูุงูฺฏู - ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช", x = "ููุฏุงุฑ", y = "ูุฑุงูุงู") +
      theme(text = element_text(family = "Tahoma", size = 12))
  })
  
  output$median_plot <- renderPlot({
    set.seed(123)
    data <- c(rnorm(95, mean = 100, sd = 15), 200)
    
    df <- data.frame(Value = data)
    median_val <- median(data)
    
    ggplot(df, aes(x = Value)) +
      geom_histogram(fill = "lightgreen", alpha = 0.7, bins = 20, color = "black") +
      geom_vline(xintercept = median_val, color = "darkgreen", size = 1.5, linetype = "dashed") +
      geom_point(aes(x = 200, y = 0), color = "red", size = 3, shape = 8) +
      annotate("text", x = median_val, y = 15, label = "ูุงูู", 
               color = "darkgreen", hjust = -0.1, family = "Tahoma", size = 5) +
      theme_minimal() +
      labs(title = "ูุงูู - ููุงูู ุจู ููุงุฏุฑ ูพุฑุช", x = "ููุฏุงุฑ", y = "ูุฑุงูุงู") +
      theme(text = element_text(family = "Tahoma", size = 12))
  })
  
  output$mode_plot <- renderPlot({
    set.seed(123)
    data <- sample(c(rep("A", 40), rep("B", 35), rep("O", 20), rep("AB", 5)))
    
    df <- as.data.frame(table(data))
    colnames(df) <- c("Group", "Count")
    
    ggplot(df, aes(x = reorder(Group, -Count), y = Count, fill = Group)) +
      geom_col(alpha = 0.7, color = "black") +
      geom_text(aes(label = Count), vjust = -0.5, family = "Tahoma", size = 5) +
      scale_fill_brewer(palette = "Set2") +
      theme_minimal() +
      labs(title = "ููุง - ูพุฑุชฺฉุฑุงุฑุชุฑู ฺฏุฑูู ุฎูู", x = "ฺฏุฑูู ุฎูู", y = "ุชุนุฏุงุฏ") +
      theme(text = element_text(family = "Tahoma", size = 12),
            legend.position = "none")
  })
  
  output$range_plot <- renderPlot({
    set.seed(123)
    data <- rnorm(100, mean = 100, sd = 15)
    
    df <- data.frame(Value = data)
    min_val <- min(data)
    max_val <- max(data)
    range_val <- max_val - min_val
    
    ggplot(df, aes(x = Value)) +
      geom_histogram(fill = "orange", alpha = 0.7, bins = 20, color = "black") +
      geom_vline(xintercept = c(min_val, max_val), color = "red", size = 1, linetype = "dashed") +
      annotate("rect", xmin = min_val, xmax = max_val, ymin = 0, ymax = Inf,
               alpha = 0.2, fill = "red") +
      annotate("text", x = min_val, y = 10, label = "ูููู", 
               color = "red", hjust = 1.1, family = "Tahoma", size = 4) +
      annotate("text", x = max_val, y = 10, label = "ูุงฺฉุณูู", 
               color = "red", hjust = -0.1, family = "Tahoma", size = 4) +
      annotate("text", x = mean(c(min_val, max_val)), y = 15, 
               label = paste("ุฏุงููู =", round(range_val, 1)), 
               color = "darkred", family = "Tahoma", size = 5) +
      theme_minimal() +
      labs(title = "ุฏุงููู (ูุงฺฉุณูู - ูููู)", x = "ููุฏุงุฑ", y = "ูุฑุงูุงู") +
      theme(text = element_text(family = "Tahoma", size = 12))
  })
  
  output$variance_plot <- renderPlot({
    set.seed(123)
    data1 <- rnorm(100, mean = 100, sd = 5)
    data2 <- rnorm(100, mean = 100, sd = 15)
    
    df <- data.frame(
      Value = c(data1, data2),
      Group = rep(c("ูพุฑุงฺฉูุฏฺฏ ฺฉู", "ูพุฑุงฺฉูุฏฺฏ ุฒุงุฏ"), each = 100)
    )
    
    var1 <- var(data1)
    var2 <- var(data2)
    
    ggplot(df, aes(x = Value, fill = Group)) +
      geom_density(alpha = 0.6) +
      geom_vline(xintercept = 100, linetype = "dashed", color = "red") +
      annotate("text", x = 85, y = 0.05, label = paste("ูุงุฑุงูุณ =", round(var1, 1)), 
               color = "darkblue", family = "Tahoma", size = 4) +
      annotate("text", x = 130, y = 0.02, label = paste("ูุงุฑุงูุณ =", round(var2, 1)), 
               color = "darkred", family = "Tahoma", size = 4) +
      scale_fill_manual(values = c("ูพุฑุงฺฉูุฏฺฏ ฺฉู" = "lightblue", "ูพุฑุงฺฉูุฏฺฏ ุฒุงุฏ" = "salmon")) +
      theme_minimal() +
      labs(title = "ูุงุฑุงูุณ - ุงูุฏุงุฒูโฺฏุฑ ูพุฑุงฺฉูุฏฺฏ", 
           x = "ููุฏุงุฑ", y = "ฺฺฏุงู", fill = "ฺฏุฑูู") +
      theme(text = element_text(family = "Tahoma", size = 12),
            legend.position = "bottom")
  })
  
  output$sd_plot <- renderPlot({
    set.seed(123)
    data <- rnorm(1000, mean = 100, sd = 15)
    
    df <- data.frame(Value = data)
    mean_val <- mean(data)
    sd_val <- sd(data)
    
    ggplot(df, aes(x = Value)) +
      geom_histogram(aes(y = ..density..), fill = "purple", alpha = 0.7, bins = 30, color = "black") +
      geom_density(color = "blue", size = 1) +
      geom_vline(xintercept = mean_val + c(-2, -1, 0, 1, 2)*sd_val, 
                 color = "red", linetype = "dashed", alpha = 0.7) +
      annotate("rect", xmin = mean_val - sd_val, xmax = mean_val + sd_val, ymin = 0, ymax = Inf,
               alpha = 0.2, fill = "green") +
      annotate("rect", xmin = mean_val - 2*sd_val, xmax = mean_val + 2*sd_val, ymin = 0, ymax = Inf,
               alpha = 0.1, fill = "yellow") +
      annotate("text", x = mean_val, y = 0.02, label = "ฮผ", color = "red", size = 6) +
      annotate("text", x = mean_val + sd_val, y = 0.02, label = "ฮผ+ฯ", color = "red", size = 4) +
      annotate("text", x = mean_val - sd_val, y = 0.02, label = "ฮผ-ฯ", color = "red", size = 4) +
      annotate("text", x = mean_val, y = 0.06, 
               label = paste("68% ุฏุงุฏูโูุง ุฏุฑ ฮผ ยฑ ฯ"), color = "darkgreen", size = 4) +
      annotate("text", x = mean_val, y = 0.05, 
               label = paste("95% ุฏุงุฏูโูุง ุฏุฑ ฮผ ยฑ 2ฯ"), color = "darkorange", size = 4) +
      theme_minimal() +
      labs(title = "ุงูุญุฑุงู ูุนุงุฑ - ูพุฑุงฺฉูุฏฺฏ ุญูู ูุงูฺฏู", x = "ููุฏุงุฑ", y = "ฺฺฏุงู") +
      theme(text = element_text(family = "Tahoma", size = 12))
  })
  
  output$quartile_plot <- renderPlot({
    set.seed(123)
    data <- rnorm(100, mean = 100, sd = 15)
    
    q1 <- quantile(data, 0.25)
    q2 <- quantile(data, 0.50)
    q3 <- quantile(data, 0.75)
    iqr <- q3 - q1
    
    df <- data.frame(Value = data)
    
    ggplot(df, aes(x = "", y = Value)) +
      geom_boxplot(fill = "lightblue", alpha = 0.7, width = 0.3, outlier.color = "red") +
      geom_point(aes(x = ""), position = position_jitter(width = 0.1), alpha = 0.5, size = 1) +
      annotate("text", x = 0.7, y = q1, label = paste("Q1 =", round(q1, 1)), 
               color = "red", size = 4, family = "Tahoma") +
      annotate("text", x = 0.7, y = q2, label = paste("Q2 =", round(q2, 1)), 
               color = "darkgreen", size = 4, family = "Tahoma") +
      annotate("text", x = 0.7, y = q3, label = paste("Q3 =", round(q3, 1)), 
               color = "blue", size = 4, family = "Tahoma") +
      annotate("text", x = 1.3, y = (q1 + q3)/2, label = paste("IQR =", round(iqr, 1)), 
               color = "purple", size = 5, family = "Tahoma") +
      theme_minimal() +
      labs(title = "ูููุฏุงุฑ ุฌุนุจูโุง - ููุงุด ฺุงุฑฺฉโูุง ู ุฏุงููู ูุงู ฺุงุฑฺฉ", 
           x = "", y = "ููุฏุงุฑ") +
      theme(text = element_text(family = "Tahoma", size = 12))
  })
  
  output$outlier_detection_plot <- renderPlot({
    set.seed(123)
    data <- c(rnorm(90, mean = 100, sd = 10), 
              rnorm(5, mean = 150, sd = 5),
              rnorm(5, mean = 50, sd = 5))
    
    df <- data.frame(Index = 1:length(data), Value = data)
    
    q1 <- quantile(data, 0.25)
    q3 <- quantile(data, 0.75)
    iqr <- q3 - q1
    is_outlier <- data < (q1 - 1.5*iqr) | data > (q3 + 1.5*iqr)
    
    ggplot(df, aes(x = Index, y = Value, color = is_outlier)) +
      geom_point(size = 2) +
      geom_hline(yintercept = c(q1 - 1.5*iqr, q3 + 1.5*iqr), 
                 linetype = "dashed", color = "red", size = 1) +
      scale_color_manual(values = c("FALSE" = "blue", "TRUE" = "red"),
                         labels = c("FALSE" = "ุฏุงุฏู ุนุงุฏ", "TRUE" = "ููุฏุงุฑ ูพุฑุช")) +
      theme_minimal() +
      labs(title = "ุดูุงุณุง ููุงุฏุฑ ูพุฑุช ุฏุฑ ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ", 
           x = "ุดูุงุฑู ููููู", y = "ููุฏุงุฑ", color = "ููุน ุฏุงุฏู") +
      theme(text = element_text(family = "Tahoma"),
            legend.position = "bottom")
  })
  
  output$bp_example_plot <- renderPlot({
    set.seed(123)
    bp_data <- rnorm(100, mean = 125, sd = 15)
    
    df <- data.frame(BloodPressure = bp_data)
    
    ggplot(df, aes(x = BloodPressure)) +
      geom_histogram(aes(y = ..density..), fill = "lightcoral", alpha = 0.7, bins = 20) +
      geom_density(color = "darkred", size = 1) +
      geom_vline(xintercept = mean(bp_data), color = "blue", linetype = "dashed", size = 1) +
      geom_vline(xintercept = median(bp_data), color = "green", linetype = "dashed", size = 1) +
      annotate("text", x = mean(bp_data), y = 0.02, label = "ูุงูฺฏู", 
               color = "blue", hjust = -0.1, family = "Tahoma") +
      annotate("text", x = median(bp_data), y = 0.025, label = "ูุงูู", 
               color = "green", hjust = 1.1, family = "Tahoma") +
      theme_minimal() +
      labs(title = "ุชูุฒุน ูุดุงุฑ ุฎูู 100 ุจูุงุฑ", 
           x = "ูุดุงุฑ ุฎูู (mmHg)", y = "ฺฺฏุงู") +
      theme(text = element_text(family = "Tahoma"))
  })
  
  # ุฌุฏูู ุฎูุงุตู ุดุงุฎุตโูุง ุขูุงุฑ ุชูุตู
  output$descriptive_summary_table <- renderTable({
    data.frame(
      "ุดุงุฎุต" = c("ูุงูฺฏู", "ูุงูู", "ููุง", "ุฏุงููู", "ูุงุฑุงูุณ", "ุงูุญุฑุงู ูุนุงุฑ", "ุฏุงููู ูุงู ฺุงุฑฺฉ"),
      "ุชุนุฑู" = c("ูุฌููุน ููุงุฏุฑ ุชูุณู ุจุฑ ุชุนุฏุงุฏ", "ููุฏุงุฑ ูุณุท ุฏุงุฏูโูุง ูุฑุชุจ", "ูพุฑุชฺฉุฑุงุฑุชุฑู ููุฏุงุฑ", "ุชูุงูุช ูุงฺฉุณูู ู ูููู", "ูุงูฺฏู ูุฑุจุนุงุช ุงูุญุฑุงู ุงุฒ ูุงูฺฏู", "ุฌุฐุฑ ูุงุฑุงูุณ", "ุชูุงูุช ฺุงุฑฺฉ ุณูู ู ุงูู"),
      "ููุน ุฏุงุฏู" = c("ฺฉู", "ฺฉู ู ุชุฑุชุจ", "ููู ุงููุงุน", "ฺฉู", "ฺฉู", "ฺฉู", "ฺฉู"),
      "ูุฒุงุง" = c("ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุฏุงุฏูโูุง", "ููุงูู ุจู ููุงุฏุฑ ูพุฑุช", "ูุงุจู ุงุณุชูุงุฏู ุจุฑุง ุฏุงุฏูโูุง ฺฉู", "ูุญุงุณุจู ุณุงุฏู", "ุฏูุช ุจุงูุง", "ูุงุญุฏ ูุนูโุฏุงุฑ", "ููุงูู ุจู ููุงุฏุฑ ูพุฑุช"),
      "ูุนุงุจ" = c("ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช", "ุนุฏู ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุงุทูุงุนุงุช", "ููฺฉู ุงุณุช ฺูุฏู ููุง ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ", "ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช", "ูุงุญุฏ ูุงูุฃููุณ", "ุญุณุงุณ ุจู ููุงุฏุฑ ูพุฑุช", "ูพฺุฏฺฏ ูุญุงุณุจู")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุชูุงุจุน ุณุฑูุฑ ุจุฑุง ุชูุฒุนโูุง ุขูุงุฑ
  observeEvent(input$plot_normal, {
    output$normal_plot <- renderPlot({
      set.seed(123)
      data <- rnorm(input$norm_sample_size, 
                    mean = input$norm_mean, 
                    sd = input$norm_sd)
      
      df <- data.frame(Value = data)
      
      p1 <- ggplot(df, aes(x = Value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 30, fill = "skyblue", alpha = 0.7) +
        geom_density(color = "blue", size = 1) +
        stat_function(fun = dnorm, 
                      args = list(mean = input$norm_mean, sd = input$norm_sd),
                      color = "red", size = 1, linetype = "dashed") +
        theme_minimal() +
        labs(title = "ูุณุชูฺฏุฑุงู ู ููุญู ฺฺฏุงู",
             x = "ููุฏุงุฑ", y = "ฺฺฏุงู")
      
      p2 <- ggplot(df, aes(sample = Value)) +
        geom_qq_line(color = "red", size = 1) +
        geom_qq(color = "blue", alpha = 0.6) +
        theme_minimal() +
        labs(title = "ูููุฏุงุฑ Q-Q ุจุฑุง ุจุฑุฑุณ ูุฑูุงู ุจูุฏู",
             x = "ููุงุฏุฑ ุชุฆูุฑฺฉ", y = "ููุงุฏุฑ ูุดุงูุฏู ุดุฏู")
      
      gridExtra::grid.arrange(p1, p2, ncol = 2)
    })
    
    output$normal_info <- renderPrint({
      set.seed(123)
      data <- rnorm(input$norm_sample_size, 
                    mean = input$norm_mean, 
                    sd = input$norm_sd)
      
      cat("๐ ุงุทูุงุนุงุช ุชูุฒุน ูุฑูุงู\n\n")
      cat("ูพุงุฑุงูุชุฑูุง ุชูุฒุน:\n")
      cat("  ูุงูฺฏู (ฮผ):", input$norm_mean, "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ (ฯ):", input$norm_sd, "\n")
      cat("  ูุงุฑุงูุณ (ฯยฒ):", round(input$norm_sd^2, 2), "\n\n")
      
      cat("ุขูุงุฑ ุชูุตู ููููู:\n")
      cat("  ุญุฌู ููููู:", length(data), "\n")
      cat("  ูุงูฺฏู ููููู:", round(mean(data), 2), "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ ููููู:", round(sd(data), 2), "\n")
      cat("  ูุงูู:", round(median(data), 2), "\n\n")
      
      cat("๐ ูุงููู 68-95-99.7:\n")
      cat("  68% ุฏุงุฏูโูุง ุจู", round(input$norm_mean - input$norm_sd, 1), 
          "ู", round(input$norm_mean + input$norm_sd, 1), "\n")
      cat("  95% ุฏุงุฏูโูุง ุจู", round(input$norm_mean - 2*input$norm_sd, 1), 
          "ู", round(input$norm_mean + 2*input$norm_sd, 1), "\n")
      cat("  99.7% ุฏุงุฏูโูุง ุจู", round(input$norm_mean - 3*input$norm_sd, 1), 
          "ู", round(input$norm_mean + 3*input$norm_sd, 1), "\n\n")
      
      if(input$norm_sample_size <= 5000) {
        norm_test <- shapiro.test(data)
        cat("๐ ุขุฒููู ูุฑูุงูุช ุดุงูพุฑู-ููฺฉ:\n")
        cat("  ุขูุงุฑู W:", round(norm_test$statistic, 4), "\n")
        cat("  p-value:", format.pval(norm_test$p.value, digits = 3), "\n")
        if(norm_test$p.value > 0.05) {
          cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p > 0.05)\n")
        } else {
          cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p < 0.05)\n")
        }
      }
    })
  })
  
  observeEvent(input$plot_binomial, {
    output$binomial_plot <- renderPlot({
      set.seed(123)
      data <- rbinom(input$binom_sample_size, 
                     size = input$binom_n, 
                     prob = input$binom_p)
      
      df <- data.frame(Successes = data)
      
      ggplot(df, aes(x = Successes)) +
        geom_bar(aes(y = ..count.. / sum(..count..)), 
                 fill = "lightgreen", alpha = 0.7, color = "black") +
        stat_function(fun = function(x) dbinom(x, size = input$binom_n, prob = input$binom_p),
                      color = "red", size = 1, n = input$binom_n + 1) +
        theme_minimal() +
        labs(title = paste("ุชูุฒุน ุฏูุฌูููโุง - n =", input$binom_n, ", p =", input$binom_p),
             x = "ุชุนุฏุงุฏ ููููุชโูุง", 
             y = "ุงุญุชูุงู") +
        scale_x_continuous(breaks = 0:input$binom_n)
    })
    
    output$binomial_info <- renderPrint({
      n <- input$binom_n
      p <- input$binom_p
      
      cat("๐ ุงุทูุงุนุงุช ุชูุฒุน ุฏูุฌูููโุง\n\n")
      cat("ูพุงุฑุงูุชุฑูุง ุชูุฒุน:\n")
      cat("  ุชุนุฏุงุฏ ุขุฒูุงุด (n):", n, "\n")
      cat("  ุงุญุชูุงู ููููุช (p):", p, "\n")
      cat("  ุงุญุชูุงู ุดฺฉุณุช (q):", round(1-p, 3), "\n\n")
      
      cat("ุดุงุฎุตโูุง ุชูุฒุน:\n")
      cat("  ูุงูฺฏู (np):", round(n * p, 2), "\n")
      cat("  ูุงุฑุงูุณ (npq):", round(n * p * (1-p), 2), "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ (โnpq):", round(sqrt(n * p * (1-p)), 2), "\n\n")
      
      cat("๐ฏ ูุซุงู ูพุฒุดฺฉ:\n")
      cat("  ุงฺฏุฑ", n, "ุจูุงุฑ ุฑุง ุฏุฑูุงู ฺฉูู ู ุงุญุชูุงู ุจูุจูุฏ ูุฑ ุจูุงุฑ", p, "ุจุงุดุฏ:\n")
      cat("  ูุงูฺฏู ุชุนุฏุงุฏ ุจูุจูุฏ ุงูุชูโูุง:", round(n * p, 1), "\n")
      cat("  ุงุญุชูุงู ุจูุจูุฏ ุฏููุงู", round(n * p), "ุจูุงุฑ:", 
          round(dbinom(round(n * p), size = n, prob = p), 4), "\n")
    })
  })
  
  observeEvent(input$plot_poisson, {
    output$poisson_plot <- renderPlot({
      set.seed(123)
      data <- rpois(input$pois_sample_size, 
                    lambda = input$pois_lambda)
      
      df <- data.frame(Count = data)
      
      max_count <- max(data)
      
      ggplot(df, aes(x = Count)) +
        geom_bar(aes(y = ..count.. / sum(..count..)), 
                 fill = "orange", alpha = 0.7, color = "black") +
        stat_function(fun = function(x) dpois(x, lambda = input$pois_lambda),
                      color = "red", size = 1, n = max_count + 1) +
        theme_minimal() +
        labs(title = paste("ุชูุฒุน ูพูุงุณูู - ฮป =", input$pois_lambda),
             x = "ุชุนุฏุงุฏ ุฑูุฏุงุฏูุง", 
             y = "ุงุญุชูุงู") +
        scale_x_continuous(breaks = 0:max_count)
    })
    
    output$poisson_info <- renderPrint({
      lambda <- input$pois_lambda
      
      cat("๐ ุงุทูุงุนุงุช ุชูุฒุน ูพูุงุณูู\n\n")
      cat("ูพุงุฑุงูุชุฑูุง ุชูุฒุน:\n")
      cat("  ูุงูฺฏู (ฮป):", lambda, "\n")
      cat("  ูุงุฑุงูุณ (ฮป):", lambda, "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ (โฮป):", round(sqrt(lambda), 2), "\n\n")
      
      cat("๐ฏ ูุซุงู ูพุฒุดฺฉ:\n")
      cat("  ุงฺฏุฑ ูุงูฺฏู ูุฑุงุฌุนู ุจู ุงูุฑฺุงูุณ ุฏุฑ ุณุงุนุช", lambda, "ุจุงุดุฏ:\n")
      cat("  ุงุญุชูุงู ุฏููุงู", round(lambda), "ูุฑุงุฌุนู ุฏุฑ ุณุงุนุช:", 
          round(dpois(round(lambda), lambda = lambda), 4), "\n")
      cat("  ุงุญุชูุงู ุจุด ุงุฒ", round(lambda), "ูุฑุงุฌุนู:", 
          round(1 - ppois(round(lambda), lambda = lambda), 4), "\n")
      cat("  ุงุญุชูุงู ฺฉูุชุฑ ุงุฒ", round(lambda), "ูุฑุงุฌุนู:", 
          round(ppois(round(lambda)-1, lambda = lambda), 4), "\n")
    })
  })
  
  # ุฌุฏูู ุฎูุงุตู ุชูุฒุนโูุง
  output$distributions_summary_table <- renderTable({
    data.frame(
      "ุชูุฒุน" = c("ูุฑูุงู", "ุฏูุฌูููโุง", "ูพูุงุณูู"),
      "ููุน ุฏุงุฏู" = c("ฺฉู ูพูุณุชู", "ฺฉู ฺฏุณุณุชู (ุฏูุญุงูุช)", "ฺฉู ฺฏุณุณุชู (ุดูุงุฑุด)"),
      "ูพุงุฑุงูุชุฑูุง" = c("ฮผ (ูุงูฺฏู), ฯ (ุงูุญุฑุงู ูุนุงุฑ)", "n (ุชุนุฏุงุฏ ุขุฒูุงุด), p (ุงุญุชูุงู ููููุช)", "ฮป (ูุงูฺฏู)"),
      "ูุญุฏูุฏู" = c("(-โ, +โ)", "0, 1, 2, ..., n", "0, 1, 2, ..."),
      "ฺฉุงุฑุจุฑุฏ ูพุฒุดฺฉ" = c("ูุดุงุฑ ุฎููุ ูุฏุ ูุฒู", "ุชุนุฏุงุฏ ุจูุจูุฏุ ูพุงุณุฎ ุจู ุฏุฑูุงู", "ุชุนุฏุงุฏ ูุฑุงุฌุนู ุจู ุงูุฑฺุงูุณุ ุนูููุชโูุง")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ุงููุงุน ุฎุทุง
  output$error_types_table <- renderTable({
    data.frame(
      "ุชุตูู" = c("ุฑุฏ Hโ", "ุนุฏู ุฑุฏ Hโ"),
      "Hโ ุฏุฑุณุช ุงุณุช" = c("ุฎุทุง ููุน ุงูู (ฮฑ)", "ุชุตูู ุฏุฑุณุช"),
      "Hโ ูุงุฏุฑุณุช ุงุณุช" = c("ุชุตูู ุฏุฑุณุช (ุชูุงู ุขุฒููู)", "ุฎุทุง ููุน ุฏูู (ฮฒ)")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ููุงูู ฺฉูุฏ
  output$key_concepts_table <- renderTable({
    data.frame(
      "ููููู" = c("ูุฑุถ ุตูุฑ (Hโ)", "ูุฑุถ ููุงุจู (Hโ)", "ุณุทุญ ูุนูโุฏุงุฑ (ฮฑ)", "ุฎุทุง ููุน ุฏูู (ฮฒ)", "ุชูุงู ุขุฒููู (1-ฮฒ)", "p-value", "ูุงุตูู ุงุทููุงู"),
      "ุชุนุฑู" = c("ูุฑุถู ุนุฏู ุชูุงูุช ุง ุนุฏู ุงุซุฑ", "ูุฑุถู ูุฌูุฏ ุชูุงูุช ุง ุงุซุฑ", "ุญุฏุงฺฉุซุฑ ุงุญุชูุงู ุฎุทุง ููุน ุงูู", "ุงุญุชูุงู ุฎุทุง ููุน ุฏูู", "ุงุญุชูุงู ุชุดุฎุต ุชูุงูุช ูุงูุน", "ุงุญุชูุงู ูุดุงูุฏู ูุชุงุฌ ููููู ุฏุฑ ุตูุฑุช ุตุญุญ ุจูุฏู Hโ", "ูุญุฏูุฏู ุชุฎูู ูพุงุฑุงูุชุฑ ุฌุงูุนู"),
      "ููุฏุงุฑ ูุนููู" = c("--", "--", "0.05", "0.2", "0.8", "< 0.05 ุจุฑุง ูุนูโุฏุงุฑ", "95%"),
      "ุชูุณุฑ" = c("ุงุฏุนุง ฺฉู ุขุฒูุงุด ูโุดูุฏ", "ุงุฏุนุง ฺฉู ุฏุฑ ุตูุฑุช ุฑุฏ Hโ ูพุฐุฑูุชู ูโุดูุฏ", "ุงุญุชูุงู ุฑุฏ Hโ ูุงุฏุฑุณุช", "ุงุญุชูุงู ุงุฒ ุฏุณุช ุฏุงุฏู ุงุซุฑ ูุงูุน", "ุชูุงูุง ูุทุงูุนู ุฏุฑ ุชุดุฎุต ุงุซุฑ", "ุดูุงูุฏ ุนูู Hโ", "ุฏูุช ุจุฑุขูุฑุฏ")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ูุงุตูู ุงุทููุงู
  observeEvent(input$calc_ci, {
    output$ci_plot <- renderPlot({
      mean_val <- input$ci_mean
      sd_val <- input$ci_sd
      n <- input$ci_n
      level <- as.numeric(input$ci_level)
      
      # ูุญุงุณุจู ูุงุตูู ุงุทููุงู
      z_value <- qnorm(1 - (1 - level)/2)
      se <- sd_val / sqrt(n)
      margin <- z_value * se
      lower <- mean_val - margin
      upper <- mean_val + margin
      
      df <- data.frame(
        x = c("ูุงุตูู ุงุทููุงู"),
        estimate = mean_val,
        lower = lower,
        upper = upper
      )
      
      ggplot(df, aes(x = x, y = estimate)) +
        geom_point(size = 4, color = "blue") +
        geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, size = 1.5, color = "red") +
        theme_minimal() +
        labs(
          title = paste("ูุงุตูู ุงุทููุงู", level * 100, "% ุจุฑุง ูุงูฺฏู"),
          x = "",
          y = "ููุฏุงุฑ"
        ) +
        geom_hline(yintercept = mean_val, linetype = "dashed", alpha = 0.5) +
        theme(text = element_text(family = "Tahoma"),
              axis.text = element_text(size = 12),
              axis.title = element_text(size = 14))
    })
    
    output$ci_results <- renderPrint({
      mean_val <- input$ci_mean
      sd_val <- input$ci_sd
      n <- input$ci_n
      level <- as.numeric(input$ci_level)
      
      z_value <- qnorm(1 - (1 - level)/2)
      se <- sd_val / sqrt(n)
      margin <- z_value * se
      lower <- mean_val - margin
      upper <- mean_val + margin
      
      cat("๐ ูุชุงุฌ ูุงุตูู ุงุทููุงู\n\n")
      cat("ุณุทุญ ุงุทููุงู:", level * 100, "%\n")
      cat("ูุงูฺฏู ููููู:", round(mean_val, 2), "\n")
      cat("ุงูุญุฑุงู ูุนุงุฑ ููููู:", sd_val, "\n")
      cat("ุญุฌู ููููู:", n, "\n")
      cat("ุฎุทุง ุงุณุชุงูุฏุงุฑุฏ:", round(se, 2), "\n")
      cat("ุญุฏ ูพุงู ูุงุตูู ุงุทููุงู:", round(lower, 2), "\n")
      cat("ุญุฏ ุจุงูุง ูุงุตูู ุงุทููุงู:", round(upper, 2), "\n")
      cat("ุนุฑุถ ูุงุตูู ุงุทููุงู:", round(upper - lower, 2), "\n")
      cat("ุญุงุดู ุฎุทุง:", round(margin, 2), "\n\n")
      
      cat("๐ก ุชูุณุฑ:\n")
      cat("ุจุง ุงุทููุงู", level * 100, "ูชุ ูุงูฺฏู ูุงูุน ุฌุงูุนู ุจู", 
          round(lower, 2), "ู", round(upper, 2), "ูุฑุงุฑ ุฏุงุฑุฏ.\n")
    })
  })
  
  # ุดุจูโุณุงุฒ ุขุฒููู ูุฑุถ
  observeEvent(input$calc_ht, {
    output$ht_plot <- renderPlot({
      sample_mean <- input$ht_sample_mean
      pop_mean <- input$ht_pop_mean
      sd_val <- input$ht_sd
      n <- input$ht_n
      alpha <- as.numeric(input$ht_alpha)
      
      # ูุญุงุณุจู ุขูุงุฑู Z ู p-value
      se <- sd_val / sqrt(n)
      z_value <- (sample_mean - pop_mean) / se
      p_value <- 2 * pnorm(-abs(z_value))  # ุฏู ุฏูุจุงูู
      
      # ุงุฌุงุฏ ูููุฏุงุฑ ุชูุฒุน ูุฑูุงู
      x <- seq(pop_mean - 4*se, pop_mean + 4*se, length.out = 100)
      y <- dnorm(x, mean = pop_mean, sd = se)
      df <- data.frame(x = x, y = y)
      
      # ูุงุญู ุจุญุฑุงู
      critical_value <- qnorm(1 - alpha/2)
      reject_region_lower <- pop_mean - critical_value * se
      reject_region_upper <- pop_mean + critical_value * se
      
      ggplot(df, aes(x = x, y = y)) +
        geom_line(color = "blue", size = 1) +
        geom_vline(xintercept = pop_mean, linetype = "dashed", color = "red") +
        geom_vline(xintercept = sample_mean, linetype = "solid", color = "green", size = 1) +
        geom_area(data = subset(df, x <= reject_region_lower), aes(x = x, y = y), 
                  fill = "red", alpha = 0.3) +
        geom_area(data = subset(df, x >= reject_region_upper), aes(x = x, y = y), 
                  fill = "red", alpha = 0.3) +
        annotate("text", x = pop_mean, y = max(y)*0.9, 
                 label = paste("Hโ: ฮผ =", pop_mean), color = "red", size = 5) +
        annotate("text", x = sample_mean, y = max(y)*0.7, 
                 label = paste("ูุงูฺฏู ููููู =", sample_mean), color = "green", size = 4) +
        theme_minimal() +
        labs(
          title = paste("ุชูุฒุน ูููููโฺฏุฑ ุชุญุช ูุฑุถ ุตูุฑ (ฮฑ =", alpha, ")"),
          x = "ููุฏุงุฑ",
          y = "ฺฺฏุงู"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$ht_results <- renderPrint({
      sample_mean <- input$ht_sample_mean
      pop_mean <- input$ht_pop_mean
      sd_val <- input$ht_sd
      n <- input$ht_n
      alpha <- as.numeric(input$ht_alpha)
      
      # ูุญุงุณุจุงุช
      se <- sd_val / sqrt(n)
      z_value <- (sample_mean - pop_mean) / se
      p_value <- 2 * pnorm(-abs(z_value))
      
      cat("๐ ูุชุงุฌ ุขุฒููู ูุฑุถ\n\n")
      cat("ูุฑุถ ุตูุฑ (Hโ): ฮผ =", pop_mean, "\n")
      cat("ูุฑุถ ููุงุจู (Hโ): ฮผ โ", pop_mean, "\n")
      cat("ุณุทุญ ูุนูโุฏุงุฑ (ฮฑ):", alpha, "\n\n")
      
      cat("ุขูุงุฑู ุขุฒููู:\n")
      cat("  ุขูุงุฑู Z:", round(z_value, 3), "\n")
      cat("  p-value:", format.pval(p_value, digits = 3), "\n\n")
      
      cat("ุชุตูู:\n")
      if (p_value < alpha) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < ฮฑ)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุงุณุช\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ ฮฑ)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ูุณุช\n")
      }
      
      cat("\n๐ก ุชูุณุฑ:\n")
      if (p_value < 0.01) {
        cat("  ุดูุงูุฏ ุจุณุงุฑ ูู ุนูู ูุฑุถ ุตูุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else if (p_value < 0.05) {
        cat("  ุดูุงูุฏ ูู ุนูู ูุฑุถ ุตูุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else if (p_value < 0.1) {
        cat("  ุดูุงูุฏ ุถุนู ุนูู ูุฑุถ ุตูุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  ุดูุงูุฏ ฺฉุงู ุนูู ูุฑุถ ุตูุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุงุทูุงุนุงุช ููููู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ูุงูฺฏู ููููู:", sample_mean, "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ:", sd_val, "\n")
      cat("  ุฎุทุง ุงุณุชุงูุฏุงุฑุฏ:", round(se, 3), "\n")
    })
  })
  
  # ุฌุฏูู ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู
  output$test_selection_guide <- renderTable({
    data.frame(
      "ููุน ุฏุงุฏู" = c("ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู", "ุชุฑุชุจ", "ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู", "ุชุฑุชุจ"),
      "ุชุนุฏุงุฏ ฺฏุฑูู" = c("ฺฉ ฺฏุฑูู", "ฺฉ ฺฏุฑูู", "ฺฉ ฺฏุฑูู", "ุฏู ฺฏุฑูู ูุณุชูู", "ุฏู ฺฏุฑูู ูุณุชูู", "ุฏู ฺฏุฑูู ูุณุชูู"),
      "ุขุฒููู ูพุงุฑุงูุชุฑ" = c("t ุชฺฉ ูููููโุง", "--", "--", "t ูุณุชูู", "--", "--"),
      "ุขุฒููู ูุงูพุงุฑุงูุชุฑ" = c("--", "ุนูุงูุช", "ุนูุงูุช", "--", "ูู-ูุชู", "ูู-ูุชู"),
      "ุฏู ฺฏุฑูู ูุงุจุณุชู" = c("t ุฒูุฌ", "ููฺฉุงฺฉุณูู", "ููฺฉุงฺฉุณูู", "--", "--", "--")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ุฎูุงุตู ุขุฒูููโูุง
  output$tests_summary_table <- renderTable({
    data.frame(
      "ุขุฒููู" = c("t ุชฺฉ ูููููโุง", "t ูุณุชูู", "t ุฒูุฌ", "ุนูุงูุช", "ูู-ูุชู", "ููฺฉุงฺฉุณูู"),
      "ููุน" = c("ูพุงุฑุงูุชุฑ", "ูพุงุฑุงูุชุฑ", "ูพุงุฑุงูุชุฑ", "ูุงูพุงุฑุงูุชุฑ", "ูุงูพุงุฑุงูุชุฑ", "ูุงูพุงุฑุงูุชุฑ"),
      "ูุฏู" = c("ููุงุณู ุจุง ููุฏุงุฑ ุซุงุจุช", "ููุงุณู ุฏู ฺฏุฑูู ูุณุชูู", "ููุงุณู ุฏู ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู", "ููุงุณู ุจุง ููุฏุงุฑ ุซุงุจุช", "ููุงุณู ุฏู ฺฏุฑูู ูุณุชูู", "ููุงุณู ุฏู ุงูุฏุงุฒูโฺฏุฑ ูุงุจุณุชู"),
      "ูพุดโูุฑุถ ูุฑูุงู ุจูุฏู" = c("ุจูู", "ุจูู", "ุจูู", "ุฎุฑ", "ุฎุฑ", "ุฎุฑ"),
      "ุฏุงุฏูโูุง ููุฑุฏ ูุงุฒ" = c("ฺฉู", "ฺฉู", "ฺฉู", "ฺฉู/ุชุฑุชุจ", "ฺฉู/ุชุฑุชุจ", "ฺฉู/ุชุฑุชุจ")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ุขุฒููู t ูุณุชูู
  observeEvent(input$run_ttest, {
    output$ttest_plot <- renderPlot({
      # ุชููุฏ ุฏุงุฏูโูุง ูุตููุน
      set.seed(123)
      group1_data <- rnorm(input$group1_n, mean = input$group1_mean, sd = input$group1_sd)
      group2_data <- rnorm(input$group2_n, mean = input$group2_mean, sd = input$group2_sd)
      
      df <- data.frame(
        Value = c(group1_data, group2_data),
        Group = rep(c("ฺฏุฑูู ฑ", "ฺฏุฑูู ฒ"), c(input$group1_n, input$group2_n))
      )
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = Group, y = Value, fill = Group)) +
        geom_boxplot(alpha = 0.7, outlier.color = "red") +
        geom_jitter(width = 0.2, alpha = 0.5, size = 1) +
        stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +
        scale_fill_brewer(palette = "Set2") +
        theme_minimal() +
        labs(
          title = "ููุงุณู ุชูุฒุน ุฏู ฺฏุฑูู",
          x = "ฺฏุฑูู",
          y = "ููุฏุงุฑ"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "none")
    })
    
    output$ttest_results <- renderPrint({
      # ุงูุฌุงู ุขุฒููู t
      set.seed(123)
      group1_data <- rnorm(input$group1_n, mean = input$group1_mean, sd = input$group1_sd)
      group2_data <- rnorm(input$group2_n, mean = input$group2_mean, sd = input$group2_sd)
      
      t_test <- t.test(group1_data, group2_data, var.equal = TRUE)
      alpha <- as.numeric(input$test_alpha)
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ (d ฺฉููู)
      mean_diff <- input$group1_mean - input$group2_mean
      pooled_sd <- sqrt(((input$group1_n - 1) * input$group1_sd^2 + 
                           (input$group2_n - 1) * input$group2_sd^2) / 
                          (input$group1_n + input$group2_n - 2))
      cohens_d <- abs(mean_diff) / pooled_sd
      
      cat("๐ ูุชุงุฌ ุขุฒููู t ูุณุชูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ฺฏุฑูู ฑ: ูุงูฺฏู =", round(mean(group1_data), 2), 
          ", ุงูุญุฑุงู ูุนุงุฑ =", round(sd(group1_data), 2), "\n")
      cat("  ฺฏุฑูู ฒ: ูุงูฺฏู =", round(mean(group2_data), 2), 
          ", ุงูุญุฑุงู ูุนุงุฑ =", round(sd(group2_data), 2), "\n")
      cat("  ุชูุงูุช ูุงูฺฏูโูุง:", round(mean_diff, 2), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  ุขูุงุฑู t:", round(t_test$statistic, 3), "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ:", t_test$parameter, "\n")
      cat("  p-value:", format.pval(t_test$p.value, digits = 3), "\n")
      cat("  ูุงุตูู ุงุทููุงู 95%: [", 
          round(t_test$conf.int[1], 2), ",", 
          round(t_test$conf.int[2], 2), "]\n\n")
      
      cat("๐ ุงูุฏุงุฒู ุงุซุฑ:\n")
      cat("  d ฺฉููู:", round(cohens_d, 2), "\n")
      if (cohens_d < 0.2) {
        cat("  ุชูุณุฑ: ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (cohens_d < 0.5) {
        cat("  ุชูุณุฑ: ุงุซุฑ ูุชูุณุท\n")
      } else if (cohens_d < 0.8) {
        cat("  ุชูุณุฑ: ุงุซุฑ ุจุฒุฑฺฏ\n")
      } else {
        cat("  ุชูุณุฑ: ุงุซุฑ ุจุณุงุฑ ุจุฒุฑฺฏ\n")
      }
      cat("\n")
      
      cat("๐ก ุชุตูู:\n")
      if (t_test$p.value < alpha) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < ฮฑ)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏู ฺฏุฑูู ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ ฮฑ)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏู ฺฏุฑูู ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ุขุฒููู ูู-ูุชู
  observeEvent(input$run_mwtest, {
    output$mwtest_plot <- renderPlot({
      # ุชููุฏ ุฏุงุฏูโูุง ูุตููุน ุจุฑ ุงุณุงุณ ุฑุชุจูโูุง
      set.seed(123)
      n1 <- input$mw_n1
      n2 <- input$mw_n2
      
      # ุงุฌุงุฏ ุฏุงุฏูโูุง ุจุฑ ุงุณุงุณ ูุงูฺฏู ุฑุชุจู
      group1_ranks <- rnorm(n1, mean = input$mw_group1_rank, sd = 10)
      group2_ranks <- rnorm(n2, mean = input$mw_group2_rank, sd = 10)
      
      df <- data.frame(
        Rank = c(group1_ranks, group2_ranks),
        Group = rep(c("ฺฏุฑูู ฑ", "ฺฏุฑูู ฒ"), c(n1, n2))
      )
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = Group, y = Rank, fill = Group)) +
        geom_violin(alpha = 0.7) +
        geom_boxplot(width = 0.2, alpha = 0.7, outlier.color = "red") +
        stat_summary(fun = median, geom = "point", shape = 23, size = 3, fill = "white") +
        scale_fill_brewer(palette = "Set1") +
        theme_minimal() +
        labs(
          title = "ููุงุณู ุชูุฒุน ุฑุชุจูโูุง ุฏุฑ ุฏู ฺฏุฑูู",
          x = "ฺฏุฑูู",
          y = "ุฑุชุจู"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "none")
    })
    
    output$mwtest_results <- renderPrint({
      # ุชููุฏ ุฏุงุฏูโูุง
      set.seed(123)
      n1 <- input$mw_n1
      n2 <- input$mw_n2
      group1_ranks <- rnorm(n1, mean = input$mw_group1_rank, sd = 10)
      group2_ranks <- rnorm(n2, mean = input$mw_group2_rank, sd = 10)
      
      # ุงูุฌุงู ุขุฒููู ูู-ูุชู
      mw_test <- wilcox.test(group1_ranks, group2_ranks)
      
      cat("๐ ูุชุงุฌ ุขุฒููู ูู-ูุชู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ฺฏุฑูู ฑ: ูุงูู =", round(median(group1_ranks), 2), 
          ", ูุงูฺฏู ุฑุชุจู =", round(mean(rank(c(group1_ranks, group2_ranks))[1:n1]), 2), "\n")
      cat("  ฺฏุฑูู ฒ: ูุงูู =", round(median(group2_ranks), 2), 
          ", ูุงูฺฏู ุฑุชุจู =", round(mean(rank(c(group1_ranks, group2_ranks))[(n1+1):(n1+n2)]), 2), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  ุขูุงุฑู W:", round(mw_test$statistic, 3), "\n")
      cat("  p-value:", format.pval(mw_test$p.value, digits = 3), "\n\n")
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      z_value <- qnorm(mw_test$p.value/2)
      r_effect <- abs(z_value) / sqrt(n1 + n2)
      
      cat("๐ ุงูุฏุงุฒู ุงุซุฑ:\n")
      cat("  r:", round(r_effect, 2), "\n")
      if (r_effect < 0.1) {
        cat("  ุชูุณุฑ: ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (r_effect < 0.3) {
        cat("  ุชูุณุฑ: ุงุซุฑ ูุชูุณุท\n")
      } else if (r_effect < 0.5) {
        cat("  ุชูุณุฑ: ุงุซุฑ ุจุฒุฑฺฏ\n")
      } else {
        cat("  ุชูุณุฑ: ุงุซุฑ ุจุณุงุฑ ุจุฒุฑฺฏ\n")
      }
      cat("\n")
      
      cat("๐ก ุชุตูู:\n")
      if (mw_test$p.value < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุชูุฒุน ุฏู ฺฏุฑูู ุชูุงูุช ูุนูโุฏุงุฑ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุชูุฒุน ุฏู ฺฏุฑูู ุชูุงูุช ูุนูโุฏุงุฑ ูุฏุงุฑุฏ\n")
      }
      
      cat("\nโ๏ธ ูฺฉุชู: ุขุฒููู ูู-ูุชู ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ููุงุณุจ ุงุณุช\n")
    })
  })
  
  # ุดุจูโุณุงุฒ ุจุฑุฑุณ ูุฑูุงู ุจูุฏู
  observeEvent(input$run_norm_check, {
    output$norm_check_plot <- renderPlot({
      set.seed(123)
      
      # ุชููุฏ ุฏุงุฏูโูุง ุจุง ฺููฺฏ ูุงุจู ุชูุธู
      if (input$norm_check_skew == 0) {
        data <- rnorm(input$norm_check_n, 
                      mean = input$norm_check_mean, 
                      sd = input$norm_check_sd)
      } else {
        # ุงุณุชูุงุฏู ุงุฒ ุชูุฒุน ฺููู
        data <- sn::rsn(input$norm_check_n, 
                        xi = input$norm_check_mean, 
                        omega = input$norm_check_sd, 
                        alpha = input$norm_check_skew * 5)
      }
      
      df <- data.frame(Value = data)
      
      # ุงุฌุงุฏ ูููุฏุงุฑูุง ุชุฑฺฉุจ
      p1 <- ggplot(df, aes(x = Value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 30, fill = "skyblue", alpha = 0.7) +
        geom_density(color = "blue", size = 1) +
        stat_function(fun = dnorm, 
                      args = list(mean = mean(data), sd = sd(data)),
                      color = "red", size = 1, linetype = "dashed") +
        theme_minimal() +
        labs(title = "ูุณุชูฺฏุฑุงู ู ููุญู ฺฺฏุงู",
             x = "ููุฏุงุฑ", y = "ฺฺฏุงู")
      
      p2 <- ggplot(df, aes(sample = Value)) +
        geom_qq_line(color = "red", size = 1) +
        geom_qq(color = "blue", alpha = 0.6) +
        theme_minimal() +
        labs(title = "ูููุฏุงุฑ Q-Q",
             x = "ููุงุฏุฑ ุชุฆูุฑฺฉ", y = "ููุงุฏุฑ ูุดุงูุฏู ุดุฏู")
      
      gridExtra::grid.arrange(p1, p2, ncol = 2)
    })
    
    output$norm_check_results <- renderPrint({
      set.seed(123)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      if (input$norm_check_skew == 0) {
        data <- rnorm(input$norm_check_n, 
                      mean = input$norm_check_mean, 
                      sd = input$norm_check_sd)
      } else {
        data <- sn::rsn(input$norm_check_n, 
                        xi = input$norm_check_mean, 
                        omega = input$norm_check_sd, 
                        alpha = input$norm_check_skew * 5)
      }
      
      # ุงูุฌุงู ุขุฒูููโูุง ูุฑูุงูุช
      shapiro_test <- shapiro.test(data)
      
      # ุขุฒููู ฺฉููููฺฏุฑูู-ุงุณูุฑููู
      ks_test <- ks.test(data, "pnorm", mean = mean(data), sd = sd(data))
      
      # ูุญุงุณุจู ฺููฺฏ ู ฺฉุดุฏฺฏ
      skewness_val <- moments::skewness(data)
      kurtosis_val <- moments::kurtosis(data)
      
      cat("๐ ูุชุงุฌ ุจุฑุฑุณ ูุฑูุงู ุจูุฏู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", length(data), "\n")
      cat("  ูุงูฺฏู:", round(mean(data), 2), "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ:", round(sd(data), 2), "\n")
      cat("  ฺููฺฏ:", round(skewness_val, 3), 
          ifelse(abs(skewness_val) > 1, " (ฺููฺฏ ุดุฏุฏ)", 
                 ifelse(abs(skewness_val) > 0.5, " (ฺููฺฏ ูุชูุณุท)", " (ุชูุฑุจุงู ูุชูุงุฑู)")), "\n")
      cat("  ฺฉุดุฏฺฏ:", round(kurtosis_val, 3), 
          ifelse(kurtosis_val > 3.5, " (ฺฉุดุฏฺฏ ูุซุจุช)", 
                 ifelse(kurtosis_val < 2.5, " (ฺฉุดุฏฺฏ ููู)", " (ูุฑูุงู)")), "\n\n")
      
      cat("๐ฏ ุขุฒููู ุดุงูพุฑู-ููฺฉ:\n")
      cat("  ุขูุงุฑู W:", round(shapiro_test$statistic, 4), "\n")
      cat("  p-value:", format.pval(shapiro_test$p.value, digits = 3), "\n")
      if(shapiro_test$p.value > 0.05) {
        cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p > 0.05)\n")
      } else {
        cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p < 0.05)\n")
      }
      cat("\n")
      
      cat("๐ฏ ุขุฒููู ฺฉููููฺฏุฑูู-ุงุณูุฑููู:\n")
      cat("  ุขูุงุฑู D:", round(ks_test$statistic, 4), "\n")
      cat("  p-value:", format.pval(ks_test$p.value, digits = 3), "\n")
      if(ks_test$p.value > 0.05) {
        cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p > 0.05)\n")
      } else {
        cat("  โ ุฏุงุฏูโูุง ูุฑูุงู ูุณุชูุฏ (p < 0.05)\n")
      }
      cat("\n")
      
      cat("๐ก ุชูุตู:\n")
      if(shapiro_test$p.value > 0.05 & ks_test$p.value > 0.05) {
        cat("  โ ูโุชูุงู ุงุฒ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ\n")
      } else if(input$norm_check_n > 30 & abs(skewness_val) < 2) {
        cat("  โ๏ธ ุจุง ุงุญุชุงุท ุงุฒ ุขุฒูููโูุง ูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ฺฉูุฏ (ุชุนุฏุงุฏ ููููู ุฒุงุฏ)\n")
      } else {
        cat("  โ ุจูุชุฑ ุงุณุช ุงุฒ ุขุฒูููโูุง ูุงูพุงุฑุงูุชุฑ ุงุณุชูุงุฏู ุดูุฏ\n")
      }
    })
  })
  
  # ุฌุฏูู ุฑุงูููุง ุชูุณุฑ ูุฑูุงูุช
  output$normality_guide_table <- renderTable({
    data.frame(
      "ุดุงุฎุต" = c("p-value > 0.05", "p-value < 0.05", "ฺููฺฏ โ 0", "ฺููฺฏ > 0.5", "ฺููฺฏ < -0.5", "ฺฉุดุฏฺฏ โ 3", "ฺฉุดุฏฺฏ > 3.5", "ฺฉุดุฏฺฏ < 2.5"),
      "ุชูุณุฑ" = c("ูุฑูุงู ุจูุฏู ูุงุจู ูุจูู", "ููุถ ูุฑูุงู ุจูุฏู", "ุชูุฒุน ูุชูุงุฑู", "ฺููฺฏ ุจู ุฑุงุณุช", "ฺููฺฏ ุจู ฺูพ", "ฺฉุดุฏฺฏ ูุฑูุงู", "ฺฉุดุฏฺฏ ูุซุจุช (ููฺฉ ุชุฒ)", "ฺฉุดุฏฺฏ ููู (ูพูู)"),
      "ุงูุฏุงู" = c("ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑ", "ุงุณุชูุงุฏู ุงุฒ ูุงูพุงุฑุงูุชุฑ", "ูุดฺฉู ูุฏุงุฑุฏ", "ุจุฑุฑุณ ุชุจุฏู ุฏุงุฏู", "ุจุฑุฑุณ ุชุจุฏู ุฏุงุฏู", "ูุดฺฉู ูุฏุงุฑุฏ", "ุจุฑุฑุณ ููุงุฏุฑ ูพุฑุช", "ุจุฑุฑุณ ุฏูุช ุฏุงุฏูโูุง")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู ุจุฑุง ฺูุฏ ฺฏุฑูู
  output$multi_group_test_guide <- renderTable({
    data.frame(
      "ููุน ุฏุงุฏู" = c("ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู", "ุชุฑุชุจ", "ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู", "ุชุฑุชุจ"),
      "ุชุนุฏุงุฏ ฺฏุฑูู" = c("ณ ฺฏุฑูู ุง ุจุดุชุฑ", "ณ ฺฏุฑูู ุง ุจุดุชุฑ", "ณ ฺฏุฑูู ุง ุจุดุชุฑ", "ณ ฺฏุฑูู ุง ุจุดุชุฑ", "ณ ฺฏุฑูู ุง ุจุดุชุฑ", "ณ ฺฏุฑูู ุง ุจุดุชุฑ"),
      "ุขุฒููู ุงุตู" = c("ANOVA", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ANOVA", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ"),
      "ุขุฒููู ุชุนูุจ" = c("ุชูู", "ุฏุงู", "ุฏุงู", "ุดูู", "ูู-ูู", "ูู-ูู"),
      "ูพุดโูุฑุถ ูุฑูุงู ุจูุฏู" = c("ุจูู", "ุฎุฑ", "ุฎุฑ", "ุจูู", "ุฎุฑ", "ุฎุฑ")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ุฎูุงุตู ุขุฒูููโูุง ฺูุฏฺฏุฑูู
  output$multi_group_summary_table <- renderTable({
    data.frame(
      "ุขุฒููู" = c("ANOVA", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ุชูู HSD", "ุฏุงู", "ุดูู", "ูู-ูู"),
      "ููุน" = c("ูพุงุฑุงูุชุฑ", "ูุงูพุงุฑุงูุชุฑ", "ุชุนูุจ ูพุงุฑุงูุชุฑ", "ุชุนูุจ ูุงูพุงุฑุงูุชุฑ", "ุชุนูุจ ูพุงุฑุงูุชุฑ", "ุชุนูุจ ูุงูพุงุฑุงูุชุฑ"),
      "ูุฏู" = c("ููุงุณู ูุงูฺฏู ฺูุฏ ฺฏุฑูู", "ููุงุณู ุชูุฒุน ฺูุฏ ฺฏุฑูู", "ููุงุณู ุฌูุช ฺฏุฑููโูุง ูพุณ ุงุฒ ANOVA", "ููุงุณู ุฌูุช ฺฏุฑููโูุง ูพุณ ุงุฒ ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ููุงุณู ุฌูุช ฺฏุฑููโูุง (ูุญุงูุธูโฺฉุงุฑุงูู)", "ููุงุณู ุฌูุช ฺฏุฑููโูุง ุจุฑุง ุฏุงุฏูโูุง ูุงูพุงุฑุงูุชุฑ"),
      "ุฏุงุฏูโูุง ููุฑุฏ ูุงุฒ" = c("ฺฉู ูุฑูุงู", "ฺฉู/ุชุฑุชุจ", "ฺฉู ูุฑูุงู", "ฺฉู/ุชุฑุชุจ", "ฺฉู ูุฑูุงู", "ฺฉู/ุชุฑุชุจ")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ANOVA
  observeEvent(input$run_anova, {
    output$anova_plot <- renderPlot({
      # ุชููุฏ ุฏุงุฏูโูุง ูุตููุน
      set.seed(123)
      n_groups <- input$anova_n_groups
      n_per_group <- input$anova_n_per_group
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑูุง ูุงูฺฏู ุจุฑ ุงุณุงุณ ุชุนุฏุงุฏ ฺฏุฑููโูุง
      means <- c(input$group1_mean, input$group2_mean, input$group3_mean)
      if (n_groups >= 4) means <- c(means, input$group4_mean)
      if (n_groups >= 5) means <- c(means, input$group5_mean)
      if (n_groups >= 6) means <- c(means, input$group6_mean)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      data_list <- list()
      group_labels <- c()
      
      for (i in 1:n_groups) {
        group_data <- rnorm(n_per_group, mean = means[i], sd = input$anova_sd)
        data_list[[i]] <- group_data
        group_labels <- c(group_labels, rep(paste("ฺฏุฑูู", i), n_per_group))
      }
      
      df <- data.frame(
        Value = unlist(data_list),
        Group = factor(group_labels, levels = paste("ฺฏุฑูู", 1:n_groups))
      )
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      p1 <- ggplot(df, aes(x = Group, y = Value, fill = Group)) +
        geom_boxplot(alpha = 0.7, outlier.color = "red") +
        geom_jitter(width = 0.2, alpha = 0.5, size = 1) +
        stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +
        scale_fill_brewer(palette = "Set2") +
        theme_minimal() +
        labs(
          title = "ููุงุณู ุชูุฒุน ฺฏุฑููโูุง",
          x = "ฺฏุฑูู",
          y = "ููุฏุงุฑ"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "none")
      
      p2 <- ggplot(df, aes(x = Value, fill = Group)) +
        geom_density(alpha = 0.5) +
        scale_fill_brewer(palette = "Set2") +
        theme_minimal() +
        labs(
          title = "ฺฺฏุงู ุชูุฒุน ฺฏุฑููโูุง",
          x = "ููุฏุงุฑ",
          y = "ฺฺฏุงู"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "bottom")
      
      gridExtra::grid.arrange(p1, p2, ncol = 2)
    })
    
    output$anova_results <- renderPrint({
      # ุชููุฏ ุฏุงุฏูโูุง
      set.seed(123)
      n_groups <- input$anova_n_groups
      n_per_group <- input$anova_n_per_group
      
      means <- c(input$group1_mean, input$group2_mean, input$group3_mean)
      if (n_groups >= 4) means <- c(means, input$group4_mean)
      if (n_groups >= 5) means <- c(means, input$group5_mean)
      if (n_groups >= 6) means <- c(means, input$group6_mean)
      
      data_list <- list()
      group_labels <- c()
      
      for (i in 1:n_groups) {
        group_data <- rnorm(n_per_group, mean = means[i], sd = input$anova_sd)
        data_list[[i]] <- group_data
        group_labels <- c(group_labels, rep(paste("ฺฏุฑูู", i), n_per_group))
      }
      
      df <- data.frame(
        Value = unlist(data_list),
        Group = factor(group_labels, levels = paste("ฺฏุฑูู", 1:n_groups))
      )
      
      # ุงูุฌุงู ANOVA
      anova_result <- aov(Value ~ Group, data = df)
      anova_summary <- summary(anova_result)
      
      # ุจุฑุฑุณ ููฺฏู ูุงุฑุงูุณ
      levene_test <- car::leveneTest(Value ~ Group, data = df)
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      ss_between <- anova_summary[[1]]["Group", "Sum Sq"]
      ss_total <- sum(anova_summary[[1]][, "Sum Sq"])
      eta_squared <- ss_between / ss_total
      
      cat("๐ ูุชุงุฌ ุขูุงูุฒ ูุงุฑุงูุณ (ANOVA)\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      desc_stats <- df %>% 
        group_by(Group) %>% 
        summarise(
          n = n(),
          Mean = round(mean(Value), 2),
          SD = round(sd(Value), 2),
          Median = round(median(Value), 2)
        )
      
      for (i in 1:nrow(desc_stats)) {
        cat("  ", desc_stats$Group[i], ": ", 
            "ูุงูฺฏู =", desc_stats$Mean[i], 
            ", ุงูุญุฑุงู ูุนุงุฑ =", desc_stats$SD[i], 
            ", ูุงูู =", desc_stats$Median[i], "\n")
      }
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ANOVA:\n")
      cat("  ุขูุงุฑู F:", round(anova_summary[[1]]["Group", "F value"], 3), "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ ุจู ฺฏุฑูู:", anova_summary[[1]]["Group", "Df"], "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ ุฏุฑูู ฺฏุฑูู:", anova_summary[[1]]["Residuals", "Df"], "\n")
      cat("  p-value:", format.pval(anova_summary[[1]]["Group", "Pr(>F)"], digits = 3), "\n")
      cat("  ุงูุฏุงุฒู ุงุซุฑ (ฮทยฒ):", round(eta_squared, 3), "\n\n")
      
      cat("๐ ุจุฑุฑุณ ูพุดโูุฑุถโูุง:\n")
      cat("  ุขุฒููู ููู ุจุฑุง ููฺฏู ูุงุฑุงูุณ:\n")
      cat("  F(", levene_test$Df[1], ",", levene_test$Df[2], ") =", 
          round(levene_test$`F value`[1], 3), 
          ", p =", format.pval(levene_test$`Pr(>F)`[1], digits = 3), "\n")
      
      if (levene_test$`Pr(>F)`[1] > 0.05) {
        cat("  โ ูุงุฑุงูุณโูุง ููฺฏู ูุณุชูุฏ (p > 0.05)\n")
      } else {
        cat("  โ ูุงุฑุงูุณโูุง ููฺฏู ูุณุชูุฏ (p < 0.05)\n")
      }
      cat("\n")
      
      cat("๐ก ุชุตูู:\n")
      if (anova_summary[[1]]["Group", "Pr(>F)"] < as.numeric(input$anova_alpha)) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < ฮฑ)\n")
        cat("  ูุชุฌู: ุญุฏุงูู ุฏู ฺฏุฑูู ุจุง ูู ุชูุงูุช ูุนูโุฏุงุฑ ุฏุงุฑูุฏ\n")
        cat("  ๐ฏ ุชูุตู: ุงุฒ ุขุฒููู ุชุนูุจ (ูุงููุฏ ุชูฺฉ) ุงุณุชูุงุฏู ฺฉูุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ ฮฑ)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ฺฏุฑููโูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ุงูุฏุงุฒู ุงุซุฑ:\n")
      if (eta_squared < 0.01) {
        cat("  ุงุซุฑ ุจุณุงุฑ ฺฉูฺฺฉ\n")
      } else if (eta_squared < 0.06) {
        cat("  ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (eta_squared < 0.14) {
        cat("  ุงุซุฑ ูุชูุณุท\n")
      } else {
        cat("  ุงุซุฑ ุจุฒุฑฺฏ\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ฺฉุฑุงุณฺฉุงู-ูุงูุณ
  observeEvent(input$run_kw, {
    output$kw_plot <- renderPlot({
      # ุชููุฏ ุฏุงุฏูโูุง ูุตููุน
      set.seed(123)
      n_groups <- input$kw_n_groups
      n_per_group <- input$kw_n_per_group
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑูุง ูุงูฺฏู ุฑุชุจู
      ranks <- c(input$kw_group1_rank, input$kw_group2_rank, input$kw_group3_rank)
      if (n_groups >= 4) ranks <- c(ranks, input$kw_group4_rank)
      if (n_groups >= 5) ranks <- c(ranks, input$kw_group5_rank)
      if (n_groups >= 6) ranks <- c(ranks, input$kw_group6_rank)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      data_list <- list()
      group_labels <- c()
      
      for (i in 1:n_groups) {
        group_data <- rnorm(n_per_group, mean = ranks[i], sd = 10)
        data_list[[i]] <- group_data
        group_labels <- c(group_labels, rep(paste("ฺฏุฑูู", i), n_per_group))
      }
      
      df <- data.frame(
        Value = unlist(data_list),
        Group = factor(group_labels, levels = paste("ฺฏุฑูู", 1:n_groups))
      )
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = Group, y = Value, fill = Group)) +
        geom_violin(alpha = 0.7) +
        geom_boxplot(width = 0.2, alpha = 0.7, outlier.color = "red") +
        stat_summary(fun = median, geom = "point", shape = 23, size = 3, fill = "white") +
        scale_fill_brewer(palette = "Set1") +
        theme_minimal() +
        labs(
          title = "ููุงุณู ุชูุฒุน ุฑุชุจูโูุง ุฏุฑ ฺฏุฑููโูุง",
          x = "ฺฏุฑูู",
          y = "ุฑุชุจู"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "none")
    })
    
    output$kw_results <- renderPrint({
      # ุชููุฏ ุฏุงุฏูโูุง
      set.seed(123)
      n_groups <- input$kw_n_groups
      n_per_group <- input$kw_n_per_group
      
      ranks <- c(input$kw_group1_rank, input$kw_group2_rank, input$kw_group3_rank)
      if (n_groups >= 4) ranks <- c(ranks, input$kw_group4_rank)
      if (n_groups >= 5) ranks <- c(ranks, input$kw_group5_rank)
      if (n_groups >= 6) ranks <- c(ranks, input$kw_group6_rank)
      
      data_list <- list()
      group_labels <- c()
      
      for (i in 1:n_groups) {
        group_data <- rnorm(n_per_group, mean = ranks[i], sd = 10)
        data_list[[i]] <- group_data
        group_labels <- c(group_labels, rep(paste("ฺฏุฑูู", i), n_per_group))
      }
      
      df <- data.frame(
        Value = unlist(data_list),
        Group = factor(group_labels, levels = paste("ฺฏุฑูู", 1:n_groups))
      )
      
      # ุงูุฌุงู ุขุฒููู ฺฉุฑุงุณฺฉุงู-ูุงูุณ
      kw_test <- kruskal.test(Value ~ Group, data = df)
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      n_total <- n_groups * n_per_group
      epsilon_squared <- (kw_test$statistic - (n_groups - 1)) / (n_total - n_groups)
      
      cat("๐ ูุชุงุฌ ุขุฒููู ฺฉุฑุงุณฺฉุงู-ูุงูุณ\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      desc_stats <- df %>% 
        group_by(Group) %>% 
        summarise(
          n = n(),
          Median = round(median(Value), 2),
          Mean_Rank = round(mean(rank(Value)), 2)
        )
      
      for (i in 1:nrow(desc_stats)) {
        cat("  ", desc_stats$Group[i], ": ", 
            "ูุงูู =", desc_stats$Median[i], 
            ", ูุงูฺฏู ุฑุชุจู =", desc_stats$Mean_Rank[i], "\n")
      }
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  ุขูุงุฑู H:", round(kw_test$statistic, 3), "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ:", kw_test$parameter, "\n")
      cat("  p-value:", format.pval(kw_test$p.value, digits = 3), "\n")
      cat("  ุงูุฏุงุฒู ุงุซุฑ (ฮตยฒ):", round(epsilon_squared, 3), "\n\n")
      
      cat("๐ก ุชุตูู:\n")
      if (kw_test$p.value < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุญุฏุงูู ุฏู ฺฏุฑูู ุชูุฒุน ูุชูุงูุช ุฏุงุฑูุฏ\n")
        cat("  ๐ฏ ุชูุตู: ุงุฒ ุขุฒููู ุชุนูุจ (ูุงููุฏ ุฏุงู) ุงุณุชูุงุฏู ฺฉูุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุชูุฒุน ฺฏุฑููโูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ุงูุฏุงุฒู ุงุซุฑ:\n")
      if (epsilon_squared < 0.01) {
        cat("  ุงุซุฑ ุจุณุงุฑ ฺฉูฺฺฉ\n")
      } else if (epsilon_squared < 0.08) {
        cat("  ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (epsilon_squared < 0.26) {
        cat("  ุงุซุฑ ูุชูุณุท\n")
      } else {
        cat("  ุงุซุฑ ุจุฒุฑฺฏ\n")
      }
      
      cat("\nโ๏ธ ูฺฉุชู: ุขุฒููู ฺฉุฑุงุณฺฉุงู-ูุงูุณ ุจุฑุง ุฏุงุฏูโูุง ุบุฑูุฑูุงู ููุงุณุจ ุงุณุช\n")
    })
  })
  
  # ุฌุฏูู ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู ุจุฑุง ูุชุบุฑูุง ฺฉู
  output$categorical_test_selection_guide <- renderTable({
    data.frame(
      "ููุน ูุชุบุฑูุง" = c("ุงุณู - ุฏูุญุงูุช", "ุงุณู - ฺูุฏุญุงูุช", "ุชุฑุชุจ", "ุงุณู - ุฏูุญุงูุช", "ุงุณู - ุฏูุญุงูุช (ููููู ฺฉูฺฺฉ)", "ุชุฑุชุจ - ุฏู ฺฏุฑูู"),
      "ุณุงุฎุชุงุฑ ุฏุงุฏู" = c("ุฏู ฺฏุฑูู ูุณุชูู", "ฺูุฏ ฺฏุฑูู ูุณุชูู", "ฺูุฏ ฺฏุฑูู ูุณุชูู", "ุฏู ฺฏุฑูู ูุงุจุณุชู", "ุฏู ฺฏุฑูู ูุณุชูู", "ุฏู ฺฏุฑูู ูุณุชูู"),
      "ุขุฒููู ุงุตู" = c("ฺฉุง-ุฏู", "ฺฉุง-ุฏู", "ฺฉุฑุงุณฺฉุงู-ูุงูุณ", "ูฺฉ ููุงุฑ", "ูุดุฑ", "ูู-ูุชู"),
      "ุงูุฏุงุฒู ุงุซุฑ" = c("ุถุฑุจ ู", "ฺฉุฑุงูุฑุฒ V", "ุงูพุณููู ูุฑุจุน", "--", "ูุณุจุช ุดุงูุณ", "r"),
      "ูุซุงู ูพุฒุดฺฉ" = c("ุฌูุณุช ู ุจูุงุฑ", "ฺฏุฑูู ุฎูู ู ุจูุงุฑ", "ุฏุฑุฌู ุณุฑุทุงู ู ูพุงุณุฎ ุฏุฑูุงู", "ูุจู ู ุจุนุฏ ุฏุฑูุงู", "ุจูุงุฑ ูุงุฏุฑ ู ุนุงูู ุฎุทุฑ", "ุณุทุญ ุฏุฑุฏ ุฏุฑ ุฏู ุฑูุด")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ุขุฒููู ฺฉุง-ุฏู
  observeEvent(input$run_chi2, {
    output$chi2_plot <- renderPlot({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$chi2_row1_col1, input$chi2_row1_col2,
        input$chi2_row2_col1, input$chi2_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ูุญุงุณุจู ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ
      expected <- chisq.test(data_matrix)$expected
      
      # ุงุฌุงุฏ ุฏุงุฏู ุจุฑุง ูููุฏุงุฑ
      df_obs <- as.data.frame(as.table(data_matrix))
      df_exp <- as.data.frame(as.table(expected))
      
      df_obs$Type <- "ูุดุงูุฏู ุดุฏู"
      df_exp$Type <- "ููุฑุฏ ุงูุชุธุงุฑ"
      
      df_combined <- rbind(df_obs, df_exp)
      colnames(df_combined) <- c("Row", "Col", "Frequency", "Type")
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df_combined, aes(x = Row, y = Frequency, fill = Col, alpha = Type)) +
        geom_col(position = "dodge") +
        scale_alpha_manual(values = c("ูุดุงูุฏู ุดุฏู" = 0.7, "ููุฑุฏ ุงูุชุธุงุฑ" = 0.4)) +
        scale_fill_brewer(palette = "Set2") +
        facet_wrap(~Type) +
        theme_minimal() +
        labs(
          title = "ููุงุณู ูุฑุงูุงูโูุง ูุดุงูุฏู ุดุฏู ู ููุฑุฏ ุงูุชุธุงุฑ",
          x = "ุฑุฏู",
          y = "ูุฑุงูุงู",
          fill = "ุณุชูู",
          alpha = "ููุน"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "bottom")
    })
    
    output$chi2_results <- renderPrint({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$chi2_row1_col1, input$chi2_row1_col2,
        input$chi2_row2_col1, input$chi2_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ุงูุฌุงู ุขุฒููู ฺฉุง-ุฏู
      chi_test <- chisq.test(data_matrix)
      alpha <- as.numeric(input$chi2_alpha)
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      n <- sum(data_matrix)
      phi <- sqrt(chi_test$statistic / n)
      
      cat("๐ ูุชุงุฌ ุขุฒููู ฺฉุง-ุฏู\n\n")
      cat("๐ ุฏุงุฏูโูุง ุฌุฏูู ุชูุงูู:\n")
      print(data_matrix)
      cat("  ุญุฌู ููููู:", n, "\n\n")
      
      cat("๐ ูุฑุงูุงูโูุง ููุฑุฏ ุงูุชุธุงุฑ:\n")
      print(round(chi_test$expected, 2))
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  ุขูุงุฑู ฯยฒ:", round(chi_test$statistic, 3), "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ:", chi_test$parameter, "\n")
      cat("  p-value:", format.pval(chi_test$p.value, digits = 3), "\n")
      cat("  ุงูุฏุงุฒู ุงุซุฑ (ฯ):", round(phi, 3), "\n\n")
      
      cat("๐ ุจุฑุฑุณ ูพุดโูุฑุถโูุง:\n")
      expected <- chi_test$expected
      violations <- sum(expected < 5)
      total_cells <- length(expected)
      
      cat("  ุชุนุฏุงุฏ ุฎุงููโูุง ุจุง ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ < 5:", violations, "/", total_cells, "\n")
      if (violations == 0) {
        cat("  โ ูพุดโูุฑุถโูุง ุฑุนุงุช ุดุฏูโุงูุฏ\n")
      } else if (violations <= 0.2 * total_cells) {
        cat("  โ๏ธ ูพุดโูุฑุถโูุง ุชูุฑุจุงู ุฑุนุงุช ุดุฏูโุงูุฏ\n")
      } else {
        cat("  โ ูพุดโูุฑุถโูุง ููุถ ุดุฏูโุงูุฏ - ุงุฒ ุขุฒููู ูุดุฑ ุงุณุชูุงุฏู ฺฉูุฏ\n")
      }
      cat("\n")
      
      cat("๐ก ุชุตูู:\n")
      if (chi_test$p.value < alpha) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < ฮฑ)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ ฮฑ)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ุงูุฏุงุฒู ุงุซุฑ:\n")
      if (phi < 0.1) {
        cat("  ุงุซุฑ ุจุณุงุฑ ฺฉูฺฺฉ\n")
      } else if (phi < 0.3) {
        cat("  ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (phi < 0.5) {
        cat("  ุงุซุฑ ูุชูุณุท\n")
      } else {
        cat("  ุงุซุฑ ุจุฒุฑฺฏ\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ุขุฒููู ูุดุฑ
  observeEvent(input$run_fisher, {
    output$fisher_plot <- renderPlot({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$fisher_row1_col1, input$fisher_row1_col2,
        input$fisher_row2_col1, input$fisher_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ูุญุงุณุจู ูุณุจุช ุดุงูุณ
      odds_ratio <- (data_matrix[1,1] * data_matrix[2,2]) / (data_matrix[1,2] * data_matrix[2,1])
      
      df <- data.frame(
        Group = c("ฺฏุฑูู ฑ", "ฺฏุฑูู ฒ"),
        Success = c(data_matrix[1,1], data_matrix[2,1]),
        Failure = c(data_matrix[1,2], data_matrix[2,2])
      )
      
      df_long <- df %>%
        pivot_longer(cols = c(Success, Failure), names_to = "Outcome", values_to = "Count")
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df_long, aes(x = Group, y = Count, fill = Outcome)) +
        geom_col(position = "fill") +
        scale_fill_brewer(palette = "Set1") +
        theme_minimal() +
        labs(
          title = paste("ูููุฏุงุฑ ุฏุฑุตุฏ - ูุณุจุช ุดุงูุณ =", round(odds_ratio, 2)),
          x = "ฺฏุฑูู",
          y = "ุฏุฑุตุฏ",
          fill = "ูุชุฌู"
        ) +
        scale_y_continuous(labels = scales::percent) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$fisher_results <- renderPrint({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$fisher_row1_col1, input$fisher_row1_col2,
        input$fisher_row2_col1, input$fisher_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ุงูุฌุงู ุขุฒููู ูุดุฑ
      fisher_test <- fisher.test(data_matrix)
      
      # ูุญุงุณุจู ูุณุจุช ุดุงูุณ
      odds_ratio <- fisher_test$estimate
      ci_lower <- fisher_test$conf.int[1]
      ci_upper <- fisher_test$conf.int[2]
      
      cat("๐ ูุชุงุฌ ุขุฒููู ูุดุฑ\n\n")
      cat("๐ ุฏุงุฏูโูุง ุฌุฏูู ฒรฒ:\n")
      print(data_matrix)
      cat("  ุญุฌู ููููู:", sum(data_matrix), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  p-value:", format.pval(fisher_test$p.value, digits = 3), "\n")
      cat("  ูุณุจุช ุดุงูุณ (OR):", round(odds_ratio, 3), "\n")
      cat("  ูุงุตูู ุงุทููุงู 95%: [", round(ci_lower, 3), ",", round(ci_upper, 3), "]\n\n")
      
      cat("๐ก ุชุตูู:\n")
      if (fisher_test$p.value < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ูุณุจุช ุดุงูุณ:\n")
      if (odds_ratio == 1) {
        cat("  ุนุฏู ุงุฑุชุจุงุท ุจู ูุชุบุฑูุง\n")
      } else if (odds_ratio > 1) {
        cat("  ุงุฑุชุจุงุท ูุซุจุช - ุดุงูุณ ุฑูุฏุงุฏ ุฏุฑ ฺฏุฑูู ุงูู ุจุดุชุฑ ุงุณุช\n")
        cat("  ฺฏุฑูู ุงูู", round((odds_ratio - 1) * 100, 1), "% ุดุงูุณ ุจุดุชุฑ ุฏุงุฑุฏ\n")
      } else {
        cat("  ุงุฑุชุจุงุท ููู - ุดุงูุณ ุฑูุฏุงุฏ ุฏุฑ ฺฏุฑูู ุงูู ฺฉูุชุฑ ุงุณุช\n")
        cat("  ฺฏุฑูู ุงูู", round((1 - odds_ratio) * 100, 1), "% ุดุงูุณ ฺฉูุชุฑ ุฏุงุฑุฏ\n")
      }
      
      cat("\nโก ูุฒุงุง ุขุฒููู ูุดุฑ:\n")
      cat("  โ ููุงุณุจ ุจุฑุง ูููููโูุง ฺฉูฺฺฉ\n")
      cat("  โ ูุงุฒ ุจู ูพุดโูุฑุถโูุง ฺฉูุชุฑ ุฏุงุฑุฏ\n")
      cat("  โ ุฏููโุชุฑ ุจุฑุง ุฏุงุฏูโูุง sparse\n")
    })
  })
  
  # ุดุจูโุณุงุฒ ุจุฑุฑุณ ูพุดโูุฑุถ ฺฉุง-ุฏู
  observeEvent(input$check_assumptions, {
    output$assumption_plot <- renderPlot({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$assumption_row1_col1, input$assumption_row1_col2,
        input$assumption_row2_col1, input$assumption_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ูุญุงุณุจู ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ
      expected <- chisq.test(data_matrix)$expected
      
      # ุงุฌุงุฏ ุฏุงุฏู ุจุฑุง ูููุฏุงุฑ ููุงุณูโุง
      comparison_df <- data.frame(
        Cell = rep(c("(1,1)", "(1,2)", "(2,1)", "(2,2)"), 2),
        Frequency = c(as.vector(data_matrix), as.vector(expected)),
        Type = rep(c("ูุดุงูุฏู ุดุฏู", "ููุฑุฏ ุงูุชุธุงุฑ"), each = 4)
      )
      
      ggplot(comparison_df, aes(x = Cell, y = Frequency, fill = Type)) +
        geom_col(position = "dodge", alpha = 0.7) +
        geom_hline(yintercept = 5, linetype = "dashed", color = "red", size = 1) +
        annotate("text", x = 2.5, y = 5.5, label = "ุขุณุชุงูู ุญุฏุงูู ูุฑุงูุงู (5)", 
                 color = "red", family = "Tahoma") +
        scale_fill_brewer(palette = "Set1") +
        theme_minimal() +
        labs(
          title = "ุจุฑุฑุณ ูพุดโูุฑุถ ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ",
          x = "ุฎุงููโูุง ุฌุฏูู",
          y = "ูุฑุงูุงู",
          fill = "ููุน"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$assumption_results <- renderPrint({
      # ุงุฌุงุฏ ูุงุชุฑุณ ุฏุงุฏูโูุง
      data_matrix <- matrix(c(
        input$assumption_row1_col1, input$assumption_row1_col2,
        input$assumption_row2_col1, input$assumption_row2_col2
      ), nrow = 2, byrow = TRUE)
      
      # ูุญุงุณุจู ูุฑุงูุงู ููุฑุฏ ุงูุชุธุงุฑ
      expected <- chisq.test(data_matrix)$expected
      
      cat("๐ ุจุฑุฑุณ ูพุดโูุฑุถโูุง ุขุฒููู ฺฉุง-ุฏู\n\n")
      cat("๐ ูุฑุงูุงูโูุง ูุดุงูุฏู ุดุฏู:\n")
      print(data_matrix)
      cat("\n")
      
      cat("๐ ูุฑุงูุงูโูุง ููุฑุฏ ุงูุชุธุงุฑ:\n")
      print(round(expected, 2))
      cat("\n")
      
      cat("๐ฏ ุชุญูู ูพุดโูุฑุถโูุง:\n")
      violations <- sum(expected < 5)
      total_cells <- length(expected)
      percent_violations <- round(violations / total_cells * 100, 1)
      
      cat("  ุชุนุฏุงุฏ ฺฉู ุฎุงููโูุง:", total_cells, "\n")
      cat("  ุฎุงููโูุง ุจุง ูุฑุงูุงู < 5:", violations, "\n")
      cat("  ุฏุฑุตุฏ ููุถ ูพุดโูุฑุถ:", percent_violations, "%\n\n")
      
      cat("๐ก ูุถุนุช ูพุดโูุฑุถโูุง:\n")
      if (violations == 0) {
        cat("  โ ุนุงู! ููู ูพุดโูุฑุถโูุง ุฑุนุงุช ุดุฏูโุงูุฏ\n")
        cat("  ๐ฏ ูโุชูุงู ุงุฒ ุขุฒููู ฺฉุง-ุฏู ุงุณุชูุงุฏู ฺฉุฑุฏ\n")
      } else if (percent_violations <= 20) {
        cat("  โ๏ธ ูุงุจู ูุจูู! ฺฉูุชุฑ ุงุฒ 20% ุฎุงููโูุง ูุดฺฉู ุฏุงุฑูุฏ\n")
        cat("  ๐ฏ ูโุชูุงู ุงุฒ ุขุฒููู ฺฉุง-ุฏู ุงุณุชูุงุฏู ฺฉุฑุฏ\n")
      } else {
        cat("  โ ูุดฺฉู! ุจุด ุงุฒ 20% ุฎุงููโูุง ูุดฺฉู ุฏุงุฑูุฏ\n")
        cat("  ๐ซ ูุจุงุฏ ุงุฒ ุขุฒููู ฺฉุง-ุฏู ุงุณุชูุงุฏู ฺฉุฑุฏ\n")
      }
      
      cat("\n๐ฏ ุชูุตูโูุง:\n")
      if (violations > 0) {
        cat("  1. ุงุฏุบุงู ุฏุณุชูโูุง (ุฏุฑ ุตูุฑุช ุงูฺฉุงู)\n")
        cat("  2. ุงุณุชูุงุฏู ุงุฒ ุขุฒููู ูุดุฑ\n")
        cat("  3. ุงุณุชูุงุฏู ุงุฒ ุดุจูโุณุงุฒ ูููุช ฺฉุงุฑูู\n")
        cat("  4. ุงูุฒุงุด ุญุฌู ููููู\n")
      }
      
      # ุจุฑุฑุณ ููุงุณุจ ุจูุฏู ุขุฒููู ูุดุฑ
      if (all(dim(data_matrix) == c(2, 2))) {
        cat("\n๐ ููุงุณุจ ุจูุฏู ุขุฒููู ูุดุฑ:\n")
        if (sum(data_matrix) < 20 || violations > 0) {
          cat("  โ ุฏุงุฏูโูุง ุจุฑุง ุขุฒููู ูุดุฑ ููุงุณุจ ูุณุชูุฏ\n")
          fisher_test <- fisher.test(data_matrix)
          cat("  p-value ูุดุฑ:", format.pval(fisher_test$p.value, digits = 3), "\n")
        } else {
          cat("  โ๏ธ ุฏุงุฏูโูุง ุจุฑุง ฺฉุง-ุฏู ููุงุณุจโุชุฑ ูุณุชูุฏ\n")
        }
      }
    })
  })
  
  # ุฌุฏูู ุชูุณุฑ ููุจุณุชฺฏ
  output$correlation_interpretation_table <- renderTable({
    data.frame(
      "ููุฏุงุฑ ูุทูู ุถุฑุจ" = c("0.00 - 0.10", "0.10 - 0.30", "0.30 - 0.50", "0.50 - 0.70", "0.70 - 0.90", "0.90 - 1.00"),
      "ุชูุณุฑ" = c("ุจุณุงุฑ ุถุนู", "ุถุนู", "ูุชูุณุท", "ูู", "ุจุณุงุฑ ูู", "ฺฉุงูู"),
      "ุชุจู ูุงุฑุงูุณ" = c("ฺฉูุชุฑ ุงุฒ 1%", "1% - 9%", "9% - 25%", "25% - 49%", "49% - 81%", "81% - 100%")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุฌุฏูู ุฑุงูููุง ุงูุชุฎุงุจ ุขุฒููู ููุจุณุชฺฏ
  output$correlation_selection_guide <- renderTable({
    data.frame(
      "ููุน ูุชุบุฑูุง" = c("ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู", "ุชุฑุชุจ", "ุงุณู ุฏูุญุงูุช", "ุงุณู ฺูุฏุญุงูุช"),
      "ุขุฒููู ูพุงุฑุงูุชุฑ" = c("ูพุฑุณูู", "--", "--", "ููุทูโุฏู ุณุฑ", "--"),
      "ุขุฒููู ูุงูพุงุฑุงูุชุฑ" = c("--", "ุงุณูพุฑูู", "ุงุณูพุฑูู/ฺฉูุฏุงู", "--", "ู/ฺฉุฑุงูุฑุฒ"),
      "ูุซุงู ูพุฒุดฺฉ" = c("ูุฏ ู ูุฒู", "ุณุทุญ ุฏุฑุฏ ู ุณู", "ุฏุฑุฌู ุณุฑุทุงู ู ฺฉูุช ุฒูุฏฺฏ", "ุฌูุณุช ู ูุดุงุฑ ุฎูู", "ฺฏุฑูู ุฎูู ู ุจูุงุฑ")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุชุงุจุน ุจุฑุง ANCOVA
  observeEvent(input$run_ancova, {
    output$ancova_plot <- renderPlot({
      set.seed(123)
      n_groups <- input$ancova_n_groups
      n_per_group <- input$ancova_n_per_group
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑ ูุงูฺฏูโูุง
      means <- c(input$ancova_group1_mean, input$ancova_group2_mean)
      if (n_groups >= 3) means <- c(means, input$ancova_group3_mean)
      if (n_groups >= 4) means <- c(means, input$ancova_group4_mean)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      data_list <- list()
      for (i in 1:n_groups) {
        # ุชููุฏ ฺฉููุงุฑุงุช
        covariate <- rnorm(n_per_group, mean = 50, sd = 10)
        
        # ุชููุฏ ูุชุบุฑ ูุงุจุณุชู ุจุง ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุงุซุฑ ฺฉููุงุฑุงุช
        y <- means[i] + input$ancova_cov_effect * (covariate - 50) + 
          rnorm(n_per_group, sd = 5)
        
        data_list[[i]] <- data.frame(
          y = y,
          covariate = covariate,
          group = factor(rep(paste("ฺฏุฑูู", i), n_per_group))
        )
      }
      
      df <- do.call(rbind, data_list)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = covariate, y = y, color = group)) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", se = FALSE) +
        scale_color_brewer(palette = "Set1") +
        theme_minimal() +
        labs(
          title = "ุฑุงุจุทู ูุชุบุฑ ูุงุจุณุชู ู ฺฉููุงุฑุงุช ุฏุฑ ฺฏุฑููโูุง ูุฎุชูู",
          x = "ฺฉููุงุฑุงุช",
          y = "ูุชุบุฑ ูุงุจุณุชู",
          color = "ฺฏุฑูู"
        ) +
        theme(text = element_text(family = "Tahoma"),
              legend.position = "bottom")
    })
    
    output$ancova_results <- renderPrint({
      set.seed(123)
      n_groups <- input$ancova_n_groups
      n_per_group <- input$ancova_n_per_group
      
      means <- c(input$ancova_group1_mean, input$ancova_group2_mean)
      if (n_groups >= 3) means <- c(means, input$ancova_group3_mean)
      if (n_groups >= 4) means <- c(means, input$ancova_group4_mean)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      data_list <- list()
      for (i in 1:n_groups) {
        covariate <- rnorm(n_per_group, mean = 50, sd = 10)
        y <- means[i] + input$ancova_cov_effect * (covariate - 50) + 
          rnorm(n_per_group, sd = 5)
        
        data_list[[i]] <- data.frame(
          y = y,
          covariate = covariate,
          group = factor(rep(paste("ฺฏุฑูู", i), n_per_group))
        )
      }
      
      df <- do.call(rbind, data_list)
      
      # ุงูุฌุงู ANCOVA
      model_ancova <- lm(y ~ group + covariate, data = df)
      anova_result <- car::Anova(model_ancova, type = "III")
      
      # ุจุฑุฑุณ ููฺฏูู ุดุจโูุง
      model_interaction <- lm(y ~ group * covariate, data = df)
      interaction_test <- car::Anova(model_interaction, type = "III")
      
      cat("๐ ูุชุงุฌ ุขูุงูุฒ ฺฉููุงุฑุงูุณ (ANCOVA)\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      desc_stats <- df %>%
        group_by(group) %>%
        summarise(
          n = n(),
          Mean_Y = round(mean(y), 2),
          SD_Y = round(sd(y), 2),
          Mean_Cov = round(mean(covariate), 2)
        )
      print(desc_stats)
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ANCOVA:\n")
      print(anova_result)
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      ss_group <- anova_result["group", "Sum Sq"]
      ss_total <- sum(anova_result[, "Sum Sq"], na.rm = TRUE)
      eta_squared <- ss_group / ss_total
      
      cat("\n๐ ุงูุฏุงุฒู ุงุซุฑ (ฮทยฒ):", round(eta_squared, 3), "\n")
      
      cat("\n๐ ุจุฑุฑุณ ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง:\n")
      interaction_p <- interaction_test["group:covariate", "Pr(>F)"]
      cat("  p-value ุจุฑููฺฉูุด ฺฏุฑูู ร ฺฉููุงุฑุงุช:", 
          format.pval(interaction_p, digits = 3), "\n")
      
      if (interaction_p > 0.05) {
        cat("  โ ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง ุจุฑูุฑุงุฑ ุงุณุช\n")
      } else {
        cat("  โ ูพุดโูุฑุถ ููฺฏูู ุดุจโูุง ููุถ ุดุฏู ุงุณุช\n")
        cat("  โ๏ธ ุชูุณุฑ ูุชุงุฌ ุจุง ุงุญุชุงุท ุงูุฌุงู ุดูุฏ\n")
      }
      
      cat("\n๐ก ุชุตูู:\n")
      group_p <- anova_result["group", "Pr(>F)"]
      if (group_p < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ูพุณ ุงุฒ ฺฉูุชุฑู ุงุซุฑ ฺฉููุงุฑุงุชุ ุชูุงูุช ูุนูโุฏุงุฑ ุจู ฺฏุฑููโูุง ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ูพุณ ุงุฒ ฺฉูุชุฑู ุงุซุฑ ฺฉููุงุฑุงุชุ ุชูุงูุช ูุนูโุฏุงุฑ ุจู ฺฏุฑููโูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
    })
  })
  
  # ุชุงุจุน ุจุฑุง Repeated Measures ANOVA
  observeEvent(input$run_rm_anova, {
    output$rm_plot <- renderPlot({
      set.seed(123)
      n_subjects <- input$rm_n_subjects
      n_timepoints <- input$rm_n_timepoints
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑ ูุงูฺฏูโูุง
      means <- c(input$rm_time1_mean, input$rm_time2_mean, input$rm_time3_mean)
      if (n_timepoints >= 4) means <- c(means, input$rm_time4_mean)
      if (n_timepoints >= 5) means <- c(means, input$rm_time5_mean)
      if (n_timepoints >= 6) means <- c(means, input$rm_time6_mean)
      
      # ุชููุฏ ุฏุงุฏูโูุง ูุงุจุณุชู
      df <- data.frame()
      for (i in 1:n_subjects) {
        subject_effect <- rnorm(1, sd = 5)  # ุงุซุฑ ูุฑุฏ
        
        for (j in 1:n_timepoints) {
          # ุงุฌุงุฏ ููุจุณุชฺฏ ุจู ุงูุฏุงุฒูโฺฏุฑโูุง
          correlated_error <- input$rm_correlation * rnorm(1, sd = 3)
          unique_error <- (1 - input$rm_correlation) * rnorm(1, sd = 3)
          
          y <- means[j] + subject_effect + correlated_error + unique_error
          
          df <- rbind(df, data.frame(
            subject = factor(i),
            time = factor(j),
            value = y
          ))
        }
      }
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = time, y = value, group = subject)) +
        geom_line(alpha = 0.3, color = "gray") +
        geom_point(alpha = 0.5) +
        stat_summary(aes(group = 1), fun = mean, geom = "line", 
                     color = "red", size = 1.5) +
        stat_summary(aes(group = 1), fun = mean, geom = "point", 
                     color = "red", size = 3) +
        theme_minimal() +
        labs(
          title = "ููุงุด ุฏุงุฏูโูุง ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ",
          x = "ุฒูุงู ุงูุฏุงุฒูโฺฏุฑ",
          y = "ููุฏุงุฑ"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$rm_results <- renderPrint({
      set.seed(123)
      n_subjects <- input$rm_n_subjects
      n_timepoints <- input$rm_n_timepoints
      
      means <- c(input$rm_time1_mean, input$rm_time2_mean, input$rm_time3_mean)
      if (n_timepoints >= 4) means <- c(means, input$rm_time4_mean)
      if (n_timepoints >= 5) means <- c(means, input$rm_time5_mean)
      if (n_timepoints >= 6) means <- c(means, input$rm_time6_mean)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      df_wide <- data.frame(subject = 1:n_subjects)
      for (j in 1:n_timepoints) {
        subject_effects <- rnorm(n_subjects, sd = 5)
        correlated_errors <- MASS::mvrnorm(n_subjects, 
                                           mu = rep(0, n_timepoints),
                                           Sigma = toeplitz(input$rm_correlation^(0:(n_timepoints-1))))[,j] * 3
        
        df_wide[[paste0("time", j)]] <- means[j] + subject_effects + correlated_errors
      }
      
      # ุชุจุฏู ุจู ูุฑูุช long
      df_long <- df_wide %>%
        pivot_longer(cols = starts_with("time"), 
                     names_to = "time", 
                     values_to = "value") %>%
        mutate(subject = factor(subject),
               time = factor(time))
      
      # ุงูุฌุงู Repeated Measures ANOVA
      model <- aov(value ~ time + Error(subject/time), data = df_long)
      model_summary <- summary(model)
      
      cat("๐ ูุชุงุฌ ุชุญูู ูุงุฑุงูุณ ุจุง ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      desc_stats <- df_long %>%
        group_by(time) %>%
        summarise(
          n = n(),
          Mean = round(mean(value), 2),
          SD = round(sd(value), 2)
        )
      print(desc_stats)
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ANOVA:\n")
      print(model_summary)
      
      # ุจุฑุฑุณ ฺฉุฑู ุจูุฏู
      tryCatch({
        mauchly_test <- car::mauchlyTest(model)
        cat("\n๐ ุขุฒููู ูุงุดู ุจุฑุง ฺฉุฑู ุจูุฏู:\n")
        cat("  p-value:", format.pval(mauchly_test$p, digits = 3), "\n")
        
        if (mauchly_test$p < 0.05) {
          cat("  โ ูพุดโูุฑุถ ฺฉุฑู ุจูุฏู ููุถ ุดุฏู ุงุณุช\n")
          cat("  ๐ฏ ุงุณุชูุงุฏู ุงุฒ ุงุตูุงุญ ฺฏุฑู ูุงูุณ-ฺฏุณุฑ ุชูุตู ูโุดูุฏ\n")
        } else {
          cat("  โ ูพุดโูุฑุถ ฺฉุฑู ุจูุฏู ุจุฑูุฑุงุฑ ุงุณุช\n")
        }
      }, error = function(e) {
        cat("\nโ๏ธ ุงูฺฉุงู ุงูุฌุงู ุขุฒููู ูุงุดู ูุฌูุฏ ูุฏุงุฑุฏ\n")
      })
      
      cat("\n๐ก ุชุตูู:\n")
      time_p <- model_summary$`Error: subject:time`[[1]]["time", "Pr(>F)"]
      if (!is.na(time_p) && time_p < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฒูุงูโูุง ุงูุฏุงุฒูโฺฏุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฒูุงูโูุง ุงูุฏุงุฒูโฺฏุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
    })
  })
  
  # ุชุงุจุน ุจุฑุง ุขุฒููู ูุฑุฏูู
  observeEvent(input$run_friedman, {
    output$friedman_plot <- renderPlot({
      set.seed(123)
      n_blocks <- input$friedman_n_blocks
      n_treatments <- input$friedman_n_treatments
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑ ูุงูฺฏู ุฑุชุจูโูุง
      ranks <- c(input$friedman_treatment1, input$friedman_treatment2, input$friedman_treatment3)
      if (n_treatments >= 4) ranks <- c(ranks, input$friedman_treatment4)
      if (n_treatments >= 5) ranks <- c(ranks, input$friedman_treatment5)
      if (n_treatments >= 6) ranks <- c(ranks, input$friedman_treatment6)
      
      # ุชููุฏ ุฏุงุฏูโูุง ุฑุชุจูโุง
      df <- data.frame()
      for (i in 1:n_blocks) {
        block_effect <- rnorm(1, sd = 0.5)
        
        treatment_scores <- ranks + block_effect + rnorm(n_treatments, sd = 0.3)
        
        for (j in 1:n_treatments) {
          df <- rbind(df, data.frame(
            block = factor(i),
            treatment = factor(j),
            score = treatment_scores[j]
          ))
        }
      }
      
      # ูุญุงุณุจู ุฑุชุจูโูุง ุฏุฑ ูุฑ ุจููฺฉ
      df_ranks <- df %>%
        group_by(block) %>%
        mutate(rank = rank(score))
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df_ranks, aes(x = treatment, y = rank)) +
        geom_boxplot(fill = "lightblue", alpha = 0.7) +
        stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "red") +
        theme_minimal() +
        labs(
          title = "ุชูุฒุน ุฑุชุจูโูุง ุฏุฑ ุฏุฑูุงูโูุง ูุฎุชูู",
          x = "ุฏุฑูุงู",
          y = "ุฑุชุจู"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$friedman_results <- renderPrint({
      set.seed(123)
      n_blocks <- input$friedman_n_blocks
      n_treatments <- input$friedman_n_treatments
      
      ranks <- c(input$friedman_treatment1, input$friedman_treatment2, input$friedman_treatment3)
      if (n_treatments >= 4) ranks <- c(ranks, input$friedman_treatment4)
      if (n_treatments >= 5) ranks <- c(ranks, input$friedman_treatment5)
      if (n_treatments >= 6) ranks <- c(ranks, input$friedman_treatment6)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      df_wide <- data.frame(block = 1:n_blocks)
      for (j in 1:n_treatments) {
        block_effects <- rnorm(n_blocks, sd = 0.5)
        df_wide[[paste0("treatment", j)]] <- ranks[j] + block_effects + rnorm(n_blocks, sd = 0.3)
      }
      
      # ุงูุฌุงู ุขุฒููู ูุฑุฏูู
      friedman_matrix <- as.matrix(df_wide[, -1])
      friedman_test <- friedman.test(friedman_matrix)
      
      cat("๐ ูุชุงุฌ ุขุฒููู ูุฑุฏูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู (ูุงูฺฏู ุฑุชุจู):\n")
      rank_means <- apply(friedman_matrix, 2, function(x) mean(rank(x)))
      for (i in 1:length(rank_means)) {
        cat("  ุฏุฑูุงู", i, ":", round(rank_means[i], 2), "\n")
      }
      cat("\n")
      
      cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
      cat("  ุขูุงุฑู ฯยฒ:", round(friedman_test$statistic, 3), "\n")
      cat("  ุฏุฑุฌู ุขุฒุงุฏ:", friedman_test$parameter, "\n")
      cat("  p-value:", format.pval(friedman_test$p.value, digits = 3), "\n")
      
      # ูุญุงุณุจู ุงูุฏุงุฒู ุงุซุฑ
      n <- n_blocks
      k <- n_treatments
      W <- friedman_test$statistic / (n * (k - 1))
      
      cat("  ุงูุฏุงุฒู ุงุซุฑ (W):", round(W, 3), "\n\n")
      
      cat("๐ก ุชุตูู:\n")
      if (friedman_test$p.value < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏุฑูุงูโูุง ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุจู ุฏุฑูุงูโูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ุงูุฏุงุฒู ุงุซุฑ:\n")
      if (W < 0.1) {
        cat("  ุงุซุฑ ฺฉูฺฺฉ\n")
      } else if (W < 0.3) {
        cat("  ุงุซุฑ ูุชูุณุท\n")
      } else if (W < 0.5) {
        cat("  ุงุซุฑ ุจุฒุฑฺฏ\n")
      } else {
        cat("  ุงุซุฑ ุจุณุงุฑ ุจุฒุฑฺฏ\n")
      }
    })
  })
  
  # ุชุงุจุน ุจุฑุง ุขุฒููู Q ฺฉูฺฉุฑุงู
  observeEvent(input$run_cochran, {
    output$cochran_plot <- renderPlot({
      set.seed(123)
      n_subjects <- input$cochran_n_subjects
      n_treatments <- input$cochran_n_treatments
      
      # ุงุฌุงุฏ ุจุฑุฏุงุฑ ูุณุจุช ุจูุจูุฏ
      improvements <- c(input$cochran_treatment1, input$cochran_treatment2, input$cochran_treatment3) / 100
      if (n_treatments >= 4) improvements <- c(improvements, input$cochran_treatment4 / 100)
      if (n_treatments >= 5) improvements <- c(improvements, input$cochran_treatment5 / 100)
      
      # ุชููุฏ ุฏุงุฏูโูุง ุฏูุญุงูุช
      df <- data.frame()
      for (i in 1:n_subjects) {
        subject_sensitivity <- runif(1, 0.5, 1.5)  # ุญุณุงุณุช ูุฑุฏ
        
        for (j in 1:n_treatments) {
          prob <- pmin(1, improvements[j] * subject_sensitivity)
          improved <- rbinom(1, 1, prob)
          
          df <- rbind(df, data.frame(
            subject = factor(i),
            treatment = factor(j),
            improved = improved
          ))
        }
      }
      
      # ูุญุงุณุจู ูุณุจุช ุจูุจูุฏ
      summary_df <- df %>%
        group_by(treatment) %>%
        summarise(
          improvement_rate = mean(improved),
          count = sum(improved)
        )
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(summary_df, aes(x = treatment, y = improvement_rate)) +
        geom_col(fill = "lightgreen", alpha = 0.7) +
        geom_text(aes(label = paste0(round(improvement_rate * 100, 1), "%")), 
                  vjust = -0.5, size = 5) +
        scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
        theme_minimal() +
        labs(
          title = "ูุณุจุช ุจูุจูุฏ ุฏุฑ ุฏุฑูุงูโูุง ูุฎุชูู",
          x = "ุฏุฑูุงู",
          y = "ูุณุจุช ุจูุจูุฏ"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$cochran_results <- renderPrint({
      set.seed(123)
      n_subjects <- input$cochran_n_subjects
      n_treatments <- input$cochran_n_treatments
      
      improvements <- c(input$cochran_treatment1, input$cochran_treatment2, input$cochran_treatment3) / 100
      if (n_treatments >= 4) improvements <- c(improvements, input$cochran_treatment4 / 100)
      if (n_treatments >= 5) improvements <- c(improvements, input$cochran_treatment5 / 100)
      
      # ุชููุฏ ุฏุงุฏูโูุง
      df_wide <- data.frame(subject = 1:n_subjects)
      for (j in 1:n_treatments) {
        subject_sensitivities <- runif(n_subjects, 0.5, 1.5)
        probs <- pmin(1, improvements[j] * subject_sensitivities)
        df_wide[[paste0("treatment", j)]] <- rbinom(n_subjects, 1, probs)
      }
      
      # ุงูุฌุงู ุขุฒููู Q ฺฉูฺฉุฑุงู
      cochran_matrix <- as.matrix(df_wide[, -1])
      
      # ูุญุงุณุจู ุขูุงุฑู Q ฺฉูฺฉุฑุงู
      tryCatch({
        # ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน cochran.qtest ุงุฒ ุจุณุชู nonpar
        if (requireNamespace("nonpar", quietly = TRUE)) {
          cochran_test <- nonpar::cochrans.q(cochran_matrix)
          
          cat("๐ ูุชุงุฌ ุขุฒููู Q ฺฉูฺฉุฑุงู\n\n")
          cat("๐ ุขูุงุฑ ุชูุตู:\n")
          improvement_rates <- apply(cochran_matrix, 2, mean)
          for (i in 1:length(improvement_rates)) {
            cat("  ุฏุฑูุงู", i, ":", round(improvement_rates[i] * 100, 1), "% ุจูุจูุฏ\n")
          }
          cat("\n")
          
          cat("๐ฏ ูุชุงุฌ ุขุฒููู:\n")
          cat("  ุขูุงุฑู Q:", round(cochran_test$Q, 3), "\n")
          cat("  ุฏุฑุฌู ุขุฒุงุฏ:", cochran_test$df, "\n")
          cat("  p-value:", format.pval(cochran_test$p.value, digits = 3), "\n\n")
          
          cat("๐ก ุชุตูู:\n")
          if (cochran_test$p.value < 0.05) {
            cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
            cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุฏุฑ ูุฑุฎ ุจูุจูุฏ ุจู ุฏุฑูุงูโูุง ูุฌูุฏ ุฏุงุฑุฏ\n")
          } else {
            cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
            cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุฏุฑ ูุฑุฎ ุจูุจูุฏ ุจู ุฏุฑูุงูโูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
          }
        } else {
          cat("โ๏ธ ุจุฑุง ุงูุฌุงู ุขุฒููู ฺฉูฺฉุฑุงูุ ุจุณุชู 'nonpar' ูุงุฒ ุงุณุช\n")
          cat("๐ฆ ูโุชูุงูุฏ ุจุง ุฏุณุชูุฑ ุฒุฑ ูุตุจ ฺฉูุฏ: install.packages('nonpar')\n")
        }
      }, error = function(e) {
        cat("โ ุฎุทุง ุฏุฑ ุงูุฌุงู ุขุฒููู ฺฉูฺฉุฑุงู:\n", e$message, "\n")
      })
    })
  })
  
  # ุฌุฏูู ุฎูุงุตู ุขุฒูููโูุง ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ
  output$repeated_measures_summary_table <- renderTable({
    data.frame(
      "ุขุฒููู" = c("Repeated Measures ANOVA", "ูุฑุฏูู", "ฺฉูฺฉุฑุงู"),
      "ููุน ุฏุงุฏู" = c("ฺฉู ูุฑูุงู", "ฺฉู ุบุฑูุฑูุงู/ุชุฑุชุจ", "ุฏูุญุงูุช"),
      "ุชุนุฏุงุฏ ฺฏุฑููโูุง" = c("ฒ ุง ุจุดุชุฑ", "ฒ ุง ุจุดุชุฑ", "ฒ ุง ุจุดุชุฑ"),
      "ูุงุจุณุชฺฏ" = c("ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ", "ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ", "ุงูุฏุงุฒูโฺฏุฑ ูฺฉุฑุฑ"),
      "ูพุดโูุฑุถ ูุฑูุงู ุจูุฏู" = c("ุจูู", "ุฎุฑ", "ุฎุฑ"),
      "ูุซุงู ูพุฒุดฺฉ" = c("ูุดุงุฑ ุฎูู ุฏุฑ ุฒูุงูโูุง ูุฎุชูู", "ุณุทุญ ุฏุฑุฏ ุจุง ุฑูุดโูุง ูุฎุชูู", "ุจูุจูุฏ/ุนุฏู ุจูุจูุฏ ุฏุฑ ูุฑุงุญู ูุฎุชูู")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ููุจุณุชฺฏ ูพุฑุณูู
  observeEvent(input$run_pearson, {
    output$pearson_plot <- renderPlot({
      set.seed(123)
      n <- input$cor_sample_size
      r <- input$pearson_cor
      noise <- input$cor_noise
      
      # ุชููุฏ ุฏุงุฏูโูุง ุจุง ููุจุณุชฺฏ ูุดุฎุต
      x <- rnorm(n)
      y <- r * x + sqrt(1 - r^2) * rnorm(n)
      
      # ุงุถุงูู ฺฉุฑุฏู ููุฒ
      y <- y + noise * rnorm(n)
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = x, y = y)) +
        geom_point(alpha = 0.6, color = "blue", size = 2) +
        geom_smooth(method = "lm", se = TRUE, color = "red", fill = "pink", alpha = 0.3) +
        theme_minimal() +
        labs(
          title = paste("ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ - ููุจุณุชฺฏ ูพุฑุณูู"),
          x = "ูุชุบุฑ X",
          y = "ูุชุบุฑ Y"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$pearson_results <- renderPrint({
      set.seed(123)
      n <- input$cor_sample_size
      r <- input$pearson_cor
      noise <- input$cor_noise
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      y <- r * x + sqrt(1 - r^2) * rnorm(n)
      y <- y + noise * rnorm(n)
      
      # ูุญุงุณุจู ููุจุณุชฺฏ ูพุฑุณูู
      cor_test <- cor.test(x, y, method = "pearson")
      r_actual <- cor_test$estimate
      p_value <- cor_test$p.value
      ci_lower <- cor_test$conf.int[1]
      ci_upper <- cor_test$conf.int[2]
      
      # ูุญุงุณุจู ุถุฑุจ ุชุนู
      r_squared <- r_actual^2
      
      cat("๐ ูุชุงุฌ ููุจุณุชฺฏ ูพุฑุณูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ูุงูฺฏู X:", round(mean(x), 2), "\n")
      cat("  ูุงูฺฏู Y:", round(mean(y), 2), "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ X:", round(sd(x), 2), "\n")
      cat("  ุงูุญุฑุงู ูุนุงุฑ Y:", round(sd(y), 2), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ููุจุณุชฺฏ:\n")
      cat("  ุถุฑุจ ููุจุณุชฺฏ (r):", round(r_actual, 3), "\n")
      cat("  ุถุฑุจ ุชุนู (Rยฒ):", round(r_squared, 3), "\n")
      cat("  p-value:", format.pval(p_value, digits = 3), "\n")
      cat("  ูุงุตูู ุงุทููุงู 95%: [", round(ci_lower, 3), ",", round(ci_upper, 3), "]\n\n")
      
      cat("๐ก ุชุตูู:\n")
      if (p_value < as.numeric(input$cor_alpha)) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < ฮฑ)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ ฮฑ)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ูุฏุฑุช ููุจุณุชฺฏ:\n")
      abs_r <- abs(r_actual)
      if (abs_r < 0.1) {
        cat("  ุฑุงุจุทู ุจุณุงุฑ ุถุนู\n")
      } else if (abs_r < 0.3) {
        cat("  ุฑุงุจุทู ุถุนู\n")
      } else if (abs_r < 0.5) {
        cat("  ุฑุงุจุทู ูุชูุณุท\n")
      } else if (abs_r < 0.7) {
        cat("  ุฑุงุจุทู ูู\n")
      } else if (abs_r < 0.9) {
        cat("  ุฑุงุจุทู ุจุณุงุฑ ูู\n")
      } else {
        cat("  ุฑุงุจุทู ฺฉุงูู\n")
      }
      
      cat("\n๐ ุชูุณุฑ ุถุฑุจ ุชุนู:\n")
      cat("  ูุชุบุฑ X ุญุฏูุฏ", round(r_squared * 100, 1), "% ุงุฒ ูุงุฑุงูุณ ูุชุบุฑ Y ุฑุง ุชุจู ูโฺฉูุฏ\n")
      
      # ุจุฑุฑุณ ูพุดโูุฑุถ ูุฑูุงู ุจูุฏู
      shapiro_x <- shapiro.test(x)
      shapiro_y <- shapiro.test(y)
      
      cat("\n๐ ุจุฑุฑุณ ูพุดโูุฑุถ ูุฑูุงู ุจูุฏู:\n")
      cat("  ูุชุบุฑ X: W =", round(shapiro_x$statistic, 3), 
          ", p =", format.pval(shapiro_x$p.value, digits = 3))
      if (shapiro_x$p.value > 0.05) {
        cat(" โ ูุฑูุงู\n")
      } else {
        cat(" โ ุบุฑูุฑูุงู\n")
      }
      
      cat("  ูุชุบุฑ Y: W =", round(shapiro_y$statistic, 3), 
          ", p =", format.pval(shapiro_y$p.value, digits = 3))
      if (shapiro_y$p.value > 0.05) {
        cat(" โ ูุฑูุงู\n")
      } else {
        cat(" โ ุบุฑูุฑูุงู\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ููุจุณุชฺฏ ุงุณูพุฑูู
  observeEvent(input$run_spearman, {
    output$spearman_plot <- renderPlot({
      set.seed(123)
      n <- input$spearman_sample_size
      rho <- input$spearman_cor
      n_outliers <- input$spearman_outliers
      nonlinear <- input$use_nonlinear
      
      if (nonlinear) {
        # ุฑุงุจุทู ุบุฑุฎุท
        x <- runif(n, 0, 10)
        y <- if (rho > 0) {
          x^2 + rnorm(n, sd = 5)
        } else {
          100 - x^2 + rnorm(n, sd = 5)
        }
      } else {
        # ุฑุงุจุทู ุฎุท
        x <- rnorm(n)
        y <- rho * x + sqrt(1 - rho^2) * rnorm(n)
      }
      
      # ุงุถุงูู ฺฉุฑุฏู ููุงุฏุฑ ูพุฑุช
      if (n_outliers > 0) {
        outlier_indices <- sample(1:n, n_outliers)
        x[outlier_indices] <- x[outlier_indices] + runif(n_outliers, 3, 5) * sign(runif(n_outliers, -1, 1))
        y[outlier_indices] <- y[outlier_indices] + runif(n_outliers, 3, 5) * sign(runif(n_outliers, -1, 1))
      }
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      p <- ggplot(df, aes(x = x, y = y)) +
        geom_point(alpha = 0.6, color = "darkgreen", size = 2) +
        theme_minimal() +
        labs(
          title = "ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ - ููุจุณุชฺฏ ุงุณูพุฑูู",
          x = "ูุชุบุฑ X",
          y = "ูุชุบุฑ Y"
        ) +
        theme(text = element_text(family = "Tahoma"))
      
      if (!nonlinear) {
        p <- p + geom_smooth(method = "lm", formula = y ~ x, se = TRUE, color = "red", fill = "pink", alpha = 0.3)
      }
      
      # ูุดุฎุต ฺฉุฑุฏู ููุงุฏุฑ ูพุฑุช
      if (n_outliers > 0) {
        outlier_df <- df[outlier_indices, ]
        p <- p + geom_point(data = outlier_df, aes(x = x, y = y), 
                            color = "red", size = 3, shape = 1, stroke = 2)
      }
      
      p
    })
    
    output$spearman_results <- renderPrint({
      set.seed(123)
      n <- input$spearman_sample_size
      rho <- input$spearman_cor
      n_outliers <- input$spearman_outliers
      nonlinear <- input$use_nonlinear
      
      if (nonlinear) {
        x <- runif(n, 0, 10)
        y <- if (rho > 0) {
          x^2 + rnorm(n, sd = 5)
        } else {
          100 - x^2 + rnorm(n, sd = 5)
        }
      } else {
        x <- rnorm(n)
        y <- rho * x + sqrt(1 - rho^2) * rnorm(n)
      }
      
      # ุงุถุงูู ฺฉุฑุฏู ููุงุฏุฑ ูพุฑุช
      if (n_outliers > 0) {
        outlier_indices <- sample(1:n, n_outliers)
        x[outlier_indices] <- x[outlier_indices] + runif(n_outliers, 3, 5) * sign(runif(n_outliers, -1, 1))
        y[outlier_indices] <- y[outlier_indices] + runif(n_outliers, 3, 5) * sign(runif(n_outliers, -1, 1))
      }
      
      # ูุญุงุณุจู ููุจุณุชฺฏ ุงุณูพุฑูู
      cor_test_spearman <- cor.test(x, y, method = "spearman")
      rho_actual <- cor_test_spearman$estimate
      p_value_spearman <- cor_test_spearman$p.value
      
      # ูุญุงุณุจู ููุจุณุชฺฏ ูพุฑุณูู ุจุฑุง ููุงุณู
      cor_test_pearson <- cor.test(x, y, method = "pearson")
      r_pearson <- cor_test_pearson$estimate
      
      cat("๐ ูุชุงุฌ ููุจุณุชฺฏ ุงุณูพุฑูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ุชุนุฏุงุฏ ููุงุฏุฑ ูพุฑุช:", n_outliers, "\n")
      cat("  ุฑุงุจุทู ุบุฑุฎุท:", ifelse(nonlinear, "ุจูู", "ุฎุฑ"), "\n")
      cat("  ูุงูู X:", round(median(x), 2), "\n")
      cat("  ูุงูู Y:", round(median(y), 2), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ููุจุณุชฺฏ:\n")
      cat("  ุถุฑุจ ููุจุณุชฺฏ ุงุณูพุฑูู (ฯ):", round(rho_actual, 3), "\n")
      cat("  p-value:", format.pval(p_value_spearman, digits = 3), "\n")
      cat("  ุถุฑุจ ููุจุณุชฺฏ ูพุฑุณูู (ููุงุณู):", round(r_pearson, 3), "\n\n")
      
      cat("๐ก ุชุตูู:\n")
      if (p_value_spearman < 0.05) {
        cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ุฏุงุฑุฏ\n")
      } else {
        cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
        cat("  ูุชุฌู: ุฑุงุจุทู ูุนูโุฏุงุฑ ุจู ุฏู ูุชุบุฑ ูุฌูุฏ ูุฏุงุฑุฏ\n")
      }
      
      cat("\n๐ ุชูุณุฑ ูุฏุฑุช ููุจุณุชฺฏ:\n")
      abs_rho <- abs(rho_actual)
      if (abs_rho < 0.1) {
        cat("  ุฑุงุจุทู ุจุณุงุฑ ุถุนู\n")
      } else if (abs_rho < 0.3) {
        cat("  ุฑุงุจุทู ุถุนู\n")
      } else if (abs_rho < 0.5) {
        cat("  ุฑุงุจุทู ูุชูุณุท\n")
      } else if (abs_rho < 0.7) {
        cat("  ุฑุงุจุทู ูู\n")
      } else if (abs_rho < 0.9) {
        cat("  ุฑุงุจุทู ุจุณุงุฑ ูู\n")
      } else {
        cat("  ุฑุงุจุทู ฺฉุงูู\n")
      }
      
      cat("\nโก ูุฒุงุง ุงุณูพุฑูู:\n")
      cat("  โ ููุงูู ุจู ููุงุฏุฑ ูพุฑุช\n")
      cat("  โ ูุงุฒ ุจู ุชูุฒุน ูุฑูุงู ูุฏุงุฑุฏ\n")
      cat("  โ ููุงุณุจ ุจุฑุง ุฏุงุฏูโูุง ุชุฑุชุจ\n")
      cat("  โ ุชุดุฎุต ุฑูุงุจุท ฺฉููุง (ูู ูุฒููุงู ุฎุท)\n")
      
      if (n_outliers > 0) {
        cat("\n๐ ุงุซุฑ ููุงุฏุฑ ูพุฑุช:\n")
        cat("  ุชูุงูุช ูพุฑุณูู ู ุงุณูพุฑูู:", round(abs(r_pearson - rho_actual), 3), "\n")
        if (abs(r_pearson - rho_actual) > 0.2) {
          cat("  โ๏ธ ููุงุฏุฑ ูพุฑุช ุชุฃุซุฑ ูุงุจู ุชูุฌู ุฏุงุฑูุฏ\n")
        }
      }
    })
  })
  
  # ุฌุฏุงูู ุจุฑุง ุจุฎุด ุฑฺฏุฑุณูู ูุฌุณุชฺฉ
  output$or_interpretation_table <- renderTable({
    data.frame(
      "ููุฏุงุฑ OR" = c("0.0 - 0.3", "0.3 - 0.7", "0.7 - 1.3", "1.3 - 3.0", "3.0 - 10.0", "> 10.0"),
      "ุชูุณุฑ" = c("ฺฉุงูุด ุฎุทุฑ ุจุณุงุฑ ูู", "ฺฉุงูุด ุฎุทุฑ ูุชูุณุท", "ุงุซุฑ ูุงฺุฒ", "ุงูุฒุงุด ุฎุทุฑ ูุชูุณุท", "ุงูุฒุงุด ุฎุทุฑ ูู", "ุงูุฒุงุด ุฎุทุฑ ุจุณุงุฑ ูู"),
      "ุชุบุฑ ุฏุฑุตุฏ" = c("ฺฉุงูุด 70-100%", "ฺฉุงูุด 30-70%", "ุชุบุฑ ยฑ30%", "ุงูุฒุงุด 30-200%", "ุงูุฒุงุด 200-900%", "ุงูุฒุงุด >900%")
    )
  }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
  
  # ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ุฎุท ุณุงุฏู
  observeEvent(input$run_slr, {
    output$slr_plot <- renderPlot({
      set.seed(123)
      n <- input$slr_sample_size
      beta1 <- input$slr_slope
      beta0 <- input$slr_intercept
      noise <- input$slr_noise
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      y <- beta0 + beta1 * x + noise * rnorm(n)
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      ggplot(df, aes(x = x, y = y)) +
        geom_point(alpha = 0.6, color = "blue", size = 2) +
        geom_smooth(method = "lm", se = TRUE, color = "red", fill = "pink", alpha = 0.3) +
        theme_minimal() +
        labs(
          title = "ุฑฺฏุฑุณูู ุฎุท ุณุงุฏู",
          x = "ูุชุบุฑ ูุณุชูู (X)",
          y = "ูุชุบุฑ ูุงุจุณุชู (Y)"
        ) +
        theme(text = element_text(family = "Tahoma"))
    })
    
    output$slr_results <- renderPrint({
      set.seed(123)
      n <- input$slr_sample_size
      beta1 <- input$slr_slope
      beta0 <- input$slr_intercept
      noise <- input$slr_noise
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      y <- beta0 + beta1 * x + noise * rnorm(n)
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุฑุง ุฑฺฏุฑุณูู
      model <- lm(y ~ x, data = df)
      summary_model <- summary(model)
      confint_model <- confint(model)
      
      cat("๐ ูุชุงุฌ ุฑฺฏุฑุณูู ุฎุท ุณุงุฏู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ูุงูฺฏู X:", round(mean(x), 2), "\n")
      cat("  ูุงูฺฏู Y:", round(mean(y), 2), "\n")
      cat("  ููุจุณุชฺฏ:", round(cor(x, y), 3), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุฑฺฏุฑุณูู:\n")
      cat("  ุถุฑุจ ุชุนู (Rยฒ):", round(summary_model$r.squared, 3), "\n")
      cat("  ุถุฑุจ ุชุนู ุชุนุฏูโุดุฏู:", round(summary_model$adj.r.squared, 3), "\n")
      cat("  ุฎุทุง ูุนุงุฑ ุจุฑุขูุฑุฏ:", round(summary_model$sigma, 3), "\n")
      cat("  ุขูุงุฑู F:", round(summary_model$fstatistic[1], 3), "\n")
      cat("  p-value ูุฏู:", format.pval(pf(summary_model$fstatistic[1], 
                                           summary_model$fstatistic[2], 
                                           summary_model$fstatistic[3], 
                                           lower.tail = FALSE), digits = 3), "\n\n")
      
      cat("๐ ุฌุฏูู ุถุฑุงุจ:\n")
      coef_df <- as.data.frame(summary_model$coefficients)
      coef_df$CI <- paste0("[", round(confint_model[,1], 3), ", ", round(confint_model[,2], 3), "]")
      print(coef_df)
      
      cat("\n๐ก ุชูุณุฑ:\n")
      if (summary_model$coefficients[2, 4] < 0.05) {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ุจุฑุง Y ุงุณุช.\n")
        cat("  ุจุง ูุฑ ูุงุญุฏ ุงูุฒุงุด ุฏุฑ Xุ Y ุจู ูุฒุงู", round(summary_model$coefficients[2, 1], 3), "ูุงุญุฏ ุชุบุฑ ูโฺฉูุฏ.\n")
      } else {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ุจุฑุง Y ูุณุช.\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ุฎุท ฺูุฏฺฏุงูู
  observeEvent(input$run_mlr, {
    output$mlr_plot <- renderPlot({
      set.seed(123)
      n <- input$mlr_sample_size
      beta1 <- input$mlr_beta1
      beta2 <- input$mlr_beta2
      beta0 <- input$mlr_intercept
      corr <- input$mlr_correlation
      
      # ุชููุฏ ุฏุงุฏูโูุง ุจุง ููุจุณุชฺฏ ูุดุฎุต
      sigma <- matrix(c(1, corr, corr, 1), nrow = 2)
      x_data <- MASS::mvrnorm(n, mu = c(0, 0), Sigma = sigma)
      x1 <- x_data[, 1]
      x2 <- x_data[, 2]
      
      y <- beta0 + beta1 * x1 + beta2 * x2 + rnorm(n)
      
      df <- data.frame(y = y, x1 = x1, x2 = x2)
      
      # ุงุฌุงุฏ ูููุฏุงุฑูุง ูุงุชุฑุณ ูพุฑุงฺฉูุฏฺฏ
      p1 <- ggplot(df, aes(x = x1, y = y)) +
        geom_point(alpha = 0.6, color = "blue") +
        geom_smooth(method = "lm", color = "red") +
        labs(title = "Y ~ X1", x = "X1", y = "Y") +
        theme_minimal()
      
      p2 <- ggplot(df, aes(x = x2, y = y)) +
        geom_point(alpha = 0.6, color = "green") +
        geom_smooth(method = "lm", color = "red") +
        labs(title = "Y ~ X2", x = "X2", y = "Y") +
        theme_minimal()
      
      p3 <- ggplot(df, aes(x = x1, y = x2)) +
        geom_point(alpha = 0.6, color = "purple") +
        labs(title = paste("ููุจุณุชฺฏ X1-X2:", round(corr, 2)), 
             x = "X1", y = "X2") +
        theme_minimal()
      
      gridExtra::grid.arrange(p1, p2, p3, ncol = 3)
    })
    
    output$mlr_results <- renderPrint({
      set.seed(123)
      n <- input$mlr_sample_size
      beta1 <- input$mlr_beta1
      beta2 <- input$mlr_beta2
      beta0 <- input$mlr_intercept
      corr <- input$mlr_correlation
      
      # ุชููุฏ ุฏุงุฏูโูุง
      sigma <- matrix(c(1, corr, corr, 1), nrow = 2)
      x_data <- MASS::mvrnorm(n, mu = c(0, 0), Sigma = sigma)
      x1 <- x_data[, 1]
      x2 <- x_data[, 2]
      
      y <- beta0 + beta1 * x1 + beta2 * x2 + rnorm(n)
      
      df <- data.frame(y = y, x1 = x1, x2 = x2)
      
      # ุงุฌุฑุง ุฑฺฏุฑุณูู
      model <- lm(y ~ x1 + x2, data = df)
      summary_model <- summary(model)
      confint_model <- confint(model)
      
      # ูุญุงุณุจู VIF ุจุฑุง ุชุดุฎุต ููุฎุท
      vif_values <- car::vif(model)
      
      cat("๐ ูุชุงุฌ ุฑฺฏุฑุณูู ุฎุท ฺูุฏฺฏุงูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ููุจุณุชฺฏ X1-X2:", round(corr, 3), "\n")
      cat("  ููุจุณุชฺฏ X1-Y:", round(cor(x1, y), 3), "\n")
      cat("  ููุจุณุชฺฏ X2-Y:", round(cor(x2, y), 3), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุฑฺฏุฑุณูู:\n")
      cat("  ุถุฑุจ ุชุนู (Rยฒ):", round(summary_model$r.squared, 3), "\n")
      cat("  ุถุฑุจ ุชุนู ุชุนุฏูโุดุฏู:", round(summary_model$adj.r.squared, 3), "\n")
      cat("  ุขูุงุฑู F:", round(summary_model$fstatistic[1], 3), "\n")
      cat("  p-value ูุฏู:", format.pval(pf(summary_model$fstatistic[1], 
                                           summary_model$fstatistic[2], 
                                           summary_model$fstatistic[3], 
                                           lower.tail = FALSE), digits = 3), "\n\n")
      
      cat("๐ ุฌุฏูู ุถุฑุงุจ:\n")
      coef_df <- as.data.frame(summary_model$coefficients)
      coef_df$CI <- paste0("[", round(confint_model[,1], 3), ", ", round(confint_model[,2], 3), "]")
      print(coef_df)
      
      cat("\n๐ ุชุดุฎุต ููุฎุท (VIF):\n")
      cat("  VIF X1:", round(vif_values[1], 3), "\n")
      cat("  VIF X2:", round(vif_values[2], 3), "\n")
      if (any(vif_values > 10)) {
        cat("  โ๏ธ ููุฎุท ุดุฏุฏ ูุฌูุฏ ุฏุงุฑุฏ (VIF > 10)\n")
      } else if (any(vif_values > 5)) {
        cat("  โ๏ธ ููุฎุท ูุชูุณุท ูุฌูุฏ ุฏุงุฑุฏ (VIF > 5)\n")
      } else {
        cat("  โ ููุฎุท ูุงุจู ูุจูู ุงุณุช\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ
  observeEvent(input$run_logit, {
    output$logit_plot <- renderPlot({
      set.seed(123)
      n <- input$logit_sample_size
      beta <- input$logit_beta
      beta0 <- input$logit_intercept
      base_prob <- input$logit_base_prob
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      log_odds <- beta0 + beta * x
      prob <- plogis(log_odds)
      y <- rbinom(n, 1, prob)
      
      df <- data.frame(x = x, y = y, prob = prob)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      p1 <- ggplot(df, aes(x = x, y = y)) +
        geom_point(alpha = 0.6, position = position_jitter(height = 0.02), color = "blue") +
        geom_smooth(method = "glm", method.args = list(family = "binomial"), 
                    color = "red", se = TRUE) +
        labs(title = "ุฑฺฏุฑุณูู ูุฌุณุชฺฉ - ุฏุงุฏูโูุง ู ููุญู ุจุฑุงุฒุด", 
             x = "ูุชุบุฑ ูุณุชูู", y = "ูุชุบุฑ ูุงุจุณุชู (ุงุญุชูุงู)") +
        theme_minimal()
      
      p2 <- ggplot(df, aes(x = x, y = prob)) +
        geom_point(alpha = 0.6, color = "darkgreen") +
        stat_smooth(method = "glm", method.args = list(family = "binomial"), 
                    color = "red", se = FALSE) +
        labs(title = "ููุญู ูพุงุณุฎ", x = "ูุชุบุฑ ูุณุชูู", y = "ุงุญุชูุงู ูพุดโุจู ุดุฏู") +
        theme_minimal()
      
      gridExtra::grid.arrange(p1, p2, ncol = 2)
    })
    
    output$logit_results <- renderPrint({
      set.seed(123)
      n <- input$logit_sample_size
      beta <- input$logit_beta
      beta0 <- input$logit_intercept
      base_prob <- input$logit_base_prob
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      log_odds <- beta0 + beta * x
      prob <- plogis(log_odds)
      y <- rbinom(n, 1, prob)
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุฑุง ุฑฺฏุฑุณูู ูุฌุณุชฺฉ
      model <- glm(y ~ x, family = binomial, data = df)
      summary_model <- summary(model)
      confint_model <- exp(confint(model))
      odds_ratios <- exp(coef(model))
      
      cat("๐ ูุชุงุฌ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ุชุนุฏุงุฏ ููุงุฑุฏ Y=1:", sum(y), "\n")
      cat("  ุชุนุฏุงุฏ ููุงุฑุฏ Y=0:", sum(1-y), "\n")
      cat("  ูุณุจุช ููุงุฑุฏ:", round(mean(y), 3), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุฑฺฏุฑุณูู:\n")
      cat("  ุขูุงุฑู -2LogLikelihood:", round(-2 * logLik(model), 3), "\n")
      cat("  AIC:", round(AIC(model), 3), "\n")
      cat("  BIC:", round(BIC(model), 3), "\n\n")
      
      cat("๐ ุฌุฏูู ุถุฑุงุจ ู ูุณุจุชโูุง ุดุงูุณ:\n")
      results_df <- data.frame(
        Coefficient = round(coef(model), 3),
        OR = round(odds_ratios, 3),
        CI_95 = paste0("[", round(confint_model[,1], 3), ", ", round(confint_model[,2], 3), "]"),
        p_value = format.pval(summary_model$coefficients[,4], digits = 3)
      )
      print(results_df)
      
      cat("\n๐ก ุชูุณุฑ:\n")
      if (summary_model$coefficients[2, 4] < 0.05) {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ุงุณุช.\n")
        cat("  ูุณุจุช ุดุงูุณ (OR):", round(odds_ratios[2], 3), "\n")
        cat("  ุจุง ูุฑ ูุงุญุฏ ุงูุฒุงุด ุฏุฑ Xุ ุดุงูุณ Y=1", 
            ifelse(odds_ratios[2] > 1, "ุงูุฒุงุด", "ฺฉุงูุด"), "ูโุงุจุฏ.\n")
        cat("  ุฏุฑุตุฏ ุชุบุฑ:", round((odds_ratios[2] - 1) * 100, 1), "%\n")
      } else {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ูุณุช.\n")
      }
    })
  })
  
  # ุดุจูโุณุงุฒ ุฑฺฏุฑุณูู ูพูุงุณูู
  observeEvent(input$run_poisson, {
    output$poisson_plot <- renderPlot({
      set.seed(123)
      n <- input$poisson_sample_size
      lambda <- input$poisson_lambda
      beta <- input$poisson_beta
      overdispersion <- input$poisson_overdispersion
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      if (overdispersion > 1) {
        # ุงุณุชูุงุฏู ุงุฒ ุชูุฒุน ุฏูุฌูููโุง ููู ุจุฑุง ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ
        mu <- exp(log(lambda) + beta * x)
        size <- 1 / (overdispersion - 1)  # ูพุงุฑุงูุชุฑ ูพุฑุงฺฉูุฏฺฏ
        y <- rnbinom(n, mu = mu, size = size)
      } else {
        # ุงุณุชูุงุฏู ุงุฒ ุชูุฒุน ูพูุงุณูู
        log_mu <- log(lambda) + beta * x
        y <- rpois(n, exp(log_mu))
      }
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุงุฏ ูููุฏุงุฑ
      p1 <- ggplot(df, aes(x = x, y = y)) +
        geom_point(alpha = 0.6, color = "purple") +
        geom_smooth(method = "glm", method.args = list(family = poisson), 
                    color = "red", se = TRUE) +
        labs(title = "ุฑฺฏุฑุณูู ูพูุงุณูู - ุฏุงุฏูโูุง ู ุจุฑุงุฒุด", 
             x = "ูุชุบุฑ ูุณุชูู", y = "ุชุนุฏุงุฏ (Y)") +
        theme_minimal()
      
      p2 <- ggplot(df, aes(x = y)) +
        geom_histogram(binwidth = 1, fill = "orange", alpha = 0.7, color = "black") +
        labs(title = "ุชูุฒุน ูุชุบุฑ ูุงุจุณุชู", x = "ุชุนุฏุงุฏ", y = "ูุฑุงูุงู") +
        theme_minimal()
      
      gridExtra::grid.arrange(p1, p2, ncol = 2)
    })
    
    output$poisson_results <- renderPrint({
      set.seed(123)
      n <- input$poisson_sample_size
      lambda <- input$poisson_lambda
      beta <- input$poisson_beta
      overdispersion <- input$poisson_overdispersion
      
      # ุชููุฏ ุฏุงุฏูโูุง
      x <- rnorm(n)
      if (overdispersion > 1) {
        mu <- exp(log(lambda) + beta * x)
        size <- 1 / (overdispersion - 1)
        y <- rnbinom(n, mu = mu, size = size)
      } else {
        log_mu <- log(lambda) + beta * x
        y <- rpois(n, exp(log_mu))
      }
      
      df <- data.frame(x = x, y = y)
      
      # ุงุฌุฑุง ุฑฺฏุฑุณูู ูพูุงุณูู
      model_poisson <- glm(y ~ x, family = poisson, data = df)
      summary_poisson <- summary(model_poisson)
      
      cat("๐ ูุชุงุฌ ุฑฺฏุฑุณูู ูพูุงุณูู\n\n")
      cat("๐ ุขูุงุฑ ุชูุตู:\n")
      cat("  ุญุฌู ููููู:", n, "\n")
      cat("  ูุงูฺฏู Y:", round(mean(y), 3), "\n")
      cat("  ูุงุฑุงูุณ Y:", round(var(y), 3), "\n")
      cat("  ูุณุจุช ูุงุฑุงูุณ ุจู ูุงูฺฏู:", round(var(y)/mean(y), 3), "\n\n")
      
      cat("๐ฏ ูุชุงุฌ ุฑฺฏุฑุณูู:\n")
      cat("  ุขูุงุฑู -2LogLikelihood:", round(-2 * logLik(model_poisson), 3), "\n")
      cat("  AIC:", round(AIC(model_poisson), 3), "\n")
      cat("  BIC:", round(BIC(model_poisson), 3), "\n\n")
      
      cat("๐ ุฌุฏูู ุถุฑุงุจ:\n")
      coef_df <- as.data.frame(summary_poisson$coefficients)
      coef_df$IRR <- exp(coef(model_poisson))  # Incidence Rate Ratio
      print(coef_df)
      
      cat("\n๐ ุชุดุฎุต ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ:\n")
      dispersion <- summary_poisson$dispersion
      cat("  ุขูุงุฑู ูพุฑุงฺฉูุฏฺฏ:", round(dispersion, 3), "\n")
      if (dispersion > 1.5) {
        cat("  โ๏ธ ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ ุดุฏุฏ ูุฌูุฏ ุฏุงุฑุฏ\n")
        cat("  ๐ฏ ุชูุตู: ุงุฒ ุฑฺฏุฑุณูู ุฏูุฌูููโุง ููู ุงุณุชูุงุฏู ฺฉูุฏ\n")
      } else if (dispersion > 1.2) {
        cat("  โ๏ธ ูพุฑุงฺฉูุฏฺฏ ุจุด ุงุฒ ุญุฏ ูุชูุณุท ูุฌูุฏ ุฏุงุฑุฏ\n")
        cat("  ๐ฏ ุชูุตู: ุฑฺฏุฑุณูู ูพูุงุณูู ุจุง ุงุตูุงุญ ูุงุฑุงูุณ ุงุณุชูุงุฏู ฺฉูุฏ\n")
      } else {
        cat("  โ ูพุฑุงฺฉูุฏฺฏ ุฏุฑ ุญุฏ ูุงุจู ูุจูู ุงุณุช\n")
      }
      
      cat("\n๐ก ุชูุณุฑ:\n")
      if (summary_poisson$coefficients[2, 4] < 0.05) {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ุงุณุช.\n")
        irr <- exp(coef(model_poisson)[2])
        cat("  ูุณุจุช ูุฑุฎ ุจุฑูุฒ (IRR):", round(irr, 3), "\n")
        cat("  ุจุง ูุฑ ูุงุญุฏ ุงูุฒุงุด ุฏุฑ Xุ ูุฑุฎ ุจุฑูุฒ Y", 
            ifelse(irr > 1, "ุงูุฒุงุด", "ฺฉุงูุด"), "ูโุงุจุฏ.\n")
        cat("  ุฏุฑุตุฏ ุชุบุฑ:", round((irr - 1) * 100, 1), "%\n")
      } else {
        cat("  ูุชุบุฑ X ูพุดโุจู ูุนูโุฏุงุฑ ูุณุช.\n")
      }
    })
    
    # ุชุงุจุน ุจุฑุง ููุญู ฺฉุงูพูุงู-ูุงุฑ
    observeEvent(input$run_km, {
      output$km_plot <- renderPlot({
        set.seed(123)
        n_groups <- input$km_n_groups
        n_per_group <- input$km_sample_size
        censoring_rate <- input$km_censoring / 100
        
        # ุงุฌุงุฏ ุจุฑุฏุงุฑ ูุงูฺฏู ุจูุง
        means <- c(input$km_group1_mean, input$km_group2_mean)
        if (n_groups >= 3) means <- c(means, input$km_group3_mean)
        if (n_groups >= 4) means <- c(means, input$km_group4_mean)
        
        # ุชููุฏ ุฏุงุฏูโูุง ุจูุง
        df <- data.frame()
        for (i in 1:n_groups) {
          # ุฒูุงู ุจูุง ุงุฒ ุชูุฒุน ููุง
          time <- rexp(n_per_group, rate = 1/means[i])
          
          # ุงุฌุงุฏ ุณุงูุณูุฑุดุฏฺฏ
          censored <- runif(n_per_group) < censoring_rate
          status <- as.numeric(!censored)
          
          # ุจุฑุง ููุงุฑุฏ ุณุงูุณูุฑ ุดุฏูุ ุฒูุงู ุฑุง ฺฉุงูุด ูโุฏูู
          time[censored] <- time[censored] * runif(sum(censored), 0.1, 0.8)
          
          df <- rbind(df, data.frame(
            time = time,
            status = status,
            group = factor(rep(paste("ฺฏุฑูู", i), n_per_group))
          ))
        }
        
        # ูุญุงุณุจู ููุญู ฺฉุงูพูุงู-ูุงุฑ
        km_fit <- survfit(Surv(time, status) ~ group, data = df)
        
        # ุฑุณู ููุญู ุจูุง
        ggsurvplot(km_fit, data = df,
                   palette = "jco",
                   risk.table = TRUE,
                   pval = TRUE,
                   conf.int = TRUE,
                   xlab = "ุฒูุงู (ูุงู)",
                   ylab = "ุงุญุชูุงู ุจูุง",
                   legend.title = "ฺฏุฑูู",
                   legend.labs = paste("ฺฏุฑูู", 1:n_groups),
                   title = "ููุญู ุจูุง ฺฉุงูพูุงู-ูุงุฑ")$plot
      })
      
      output$km_results <- renderPrint({
        set.seed(123)
        n_groups <- input$km_n_groups
        n_per_group <- input$km_sample_size
        censoring_rate <- input$km_censoring / 100
        
        means <- c(input$km_group1_mean, input$km_group2_mean)
        if (n_groups >= 3) means <- c(means, input$km_group3_mean)
        if (n_groups >= 4) means <- c(means, input$km_group4_mean)
        
        # ุชููุฏ ุฏุงุฏูโูุง
        df <- data.frame()
        for (i in 1:n_groups) {
          time <- rexp(n_per_group, rate = 1/means[i])
          censored <- runif(n_per_group) < censoring_rate
          status <- as.numeric(!censored)
          time[censored] <- time[censored] * runif(sum(censored), 0.1, 0.8)
          
          df <- rbind(df, data.frame(
            time = time,
            status = status,
            group = factor(rep(paste("ฺฏุฑูู", i), n_per_group))
          ))
        }
        
        # ูุญุงุณุจุงุช
        km_fit <- survfit(Surv(time, status) ~ group, data = df)
        logrank_test <- survdiff(Surv(time, status) ~ group, data = df)
        
        cat("๐ ูุชุงุฌ ุชุญูู ุจูุง - ููุญู ฺฉุงูพูุงู-ูุงุฑ\n\n")
        cat("๐ ุขูุงุฑ ุชูุตู:\n")
        for (i in 1:n_groups) {
          group_data <- df[df$group == paste("ฺฏุฑูู", i), ]
          cat("  ฺฏุฑูู", i, ":\n")
          cat("    ุชุนุฏุงุฏ:", nrow(group_data), "\n")
          cat("    ุชุนุฏุงุฏ ุฑูุฏุงุฏ:", sum(group_data$status), "\n")
          cat("    ุฏุฑุตุฏ ุณุงูุณูุฑ:", round(mean(1 - group_data$status) * 100, 1), "%\n")
          cat("    ูุงูู ุจูุง:", round(median(group_data$time), 1), "ูุงู\n")
        }
        cat("\n")
        
        cat("๐ฏ ุขุฒููู ูฺฏุฑุงูฺฉ:\n")
        cat("  ุขูุงุฑู ฯยฒ:", round(logrank_test$chisq, 3), "\n")
        cat("  ุฏุฑุฌู ุขุฒุงุฏ:", length(logrank_test$n) - 1, "\n")
        p_value <- 1 - pchisq(logrank_test$chisq, length(logrank_test$n) - 1)
        cat("  p-value:", format.pval(p_value, digits = 3), "\n\n")
        
        cat("๐ก ุชุตูู:\n")
        if (p_value < 0.05) {
          cat("  โ ุฑุฏ ูุฑุถ ุตูุฑ (p-value < 0.05)\n")
          cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุฏุฑ ููุญูโูุง ุจูุง ูุฌูุฏ ุฏุงุฑุฏ\n")
        } else {
          cat("  โ ุนุฏู ุฑุฏ ูุฑุถ ุตูุฑ (p-value โฅ 0.05)\n")
          cat("  ูุชุฌู: ุชูุงูุช ูุนูโุฏุงุฑ ุฏุฑ ููุญูโูุง ุจูุง ูุฌูุฏ ูุฏุงุฑุฏ\n")
        }
        
        cat("\n๐ ุฎูุงุตู ููุญู ุจูุง:\n")
        print(summary(km_fit))
      })
    })
    
    # ุชุงุจุน ุจุฑุง ุฑฺฏุฑุณูู ฺฉุงฺฉุณ - ูุณุฎู ุงุตูุงุญ ุดุฏู
    observeEvent(input$run_cox, {
      output$cox_plot <- renderPlot({
        set.seed(123)
        n <- input$cox_sample_size
        
        # ุชููุฏ ุฏุงุฏูโูุง ูุตููุน
        age <- rnorm(n, mean = 60, sd = 10)
        treatment <- sample(0:1, n, replace = TRUE)  # 0: ูุฏู, 1: ุฌุฏุฏ
        stage <- sample(1:4, n, replace = TRUE, prob = c(0.3, 0.3, 0.2, 0.2))
        
        # ูุญุงุณุจู ุฎุทุฑ ูพุงู
        base_hazard <- input$cox_hr_age^(age/10) * 
          input$cox_hr_treatment^treatment * 
          input$cox_hr_stage^stage
        
        # ุชููุฏ ุฒูุงู ุจูุง
        time <- rexp(n, rate = base_hazard/100)
        
        # ุณุงูุณูุฑุดุฏฺฏ ุชุตุงุฏู
        censored <- runif(n) < 0.2
        status <- as.numeric(!censored)
        time[censored] <- time[censored] * runif(sum(censored), 0.1, 0.8)
        
        df <- data.frame(
          time = time,
          status = status,
          age = age,
          treatment = factor(treatment, levels = 0:1, labels = c("ูุฏู", "ุฌุฏุฏ")),
          stage = factor(stage)
        )
        
        # ุงุฌุฑุง ุฑฺฏุฑุณูู ฺฉุงฺฉุณ
        cox_model <- coxph(Surv(time, status) ~ age + treatment + stage, data = df)
        
        # ุฑุณู ูููุฏุงุฑ ูุณุจุช ุฎุทุฑ
        forest_data <- broom::tidy(cox_model, exponentiate = TRUE, conf.int = TRUE)
        
        ggplot(forest_data, aes(x = estimate, y = term)) +
          geom_point(size = 3) +
          geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +  # ุงุตูุงุญ ุดุฏู
          geom_vline(xintercept = 1, linetype = "dashed", color = "red") +
          scale_x_log10() +
          labs(
            title = "ูููุฏุงุฑ ุฌูฺฏู ูุณุจุชโูุง ุฎุทุฑ",
            x = "ูุณุจุช ุฎุทุฑ (HR)",
            y = "ูุชุบุฑ"
          ) +
          theme_minimal()
      })
      
      output$cox_results <- renderPrint({
        set.seed(123)
        n <- input$cox_sample_size
        
        # ุชููุฏ ุฏุงุฏูโูุง
        age <- rnorm(n, mean = 60, sd = 10)
        treatment <- sample(0:1, n, replace = TRUE)
        stage <- sample(1:4, n, replace = TRUE, prob = c(0.3, 0.3, 0.2, 0.2))
        
        base_hazard <- input$cox_hr_age^(age/10) * 
          input$cox_hr_treatment^treatment * 
          input$cox_hr_stage^stage
        
        time <- rexp(n, rate = base_hazard/100)
        censored <- runif(n) < 0.2
        status <- as.numeric(!censored)
        time[censored] <- time[censored] * runif(sum(censored), 0.1, 0.8)
        
        df <- data.frame(
          time = time,
          status = status,
          age = age,
          treatment = factor(treatment, levels = 0:1, labels = c("ูุฏู", "ุฌุฏุฏ")),
          stage = factor(stage)
        )
        
        # ุงุฌุฑุง ุฑฺฏุฑุณูู ฺฉุงฺฉุณ
        cox_model <- coxph(Surv(time, status) ~ age + treatment + stage, data = df)
        cox_summary <- summary(cox_model)
        
        cat("๐ ูุชุงุฌ ุฑฺฏุฑุณูู ฺฉุงฺฉุณ\n\n")
        cat("๐ ุขูุงุฑ ุชูุตู:\n")
        cat("  ุญุฌู ููููู:", n, "\n")
        cat("  ุชุนุฏุงุฏ ุฑูุฏุงุฏ:", sum(df$status), "\n")
        cat("  ุฏุฑุตุฏ ุณุงูุณูุฑ:", round(mean(1 - df$status) * 100, 1), "%\n")
        cat("  ูุงูฺฏู ุณู:", round(mean(df$age), 1), "ุณุงู\n")
        cat("  ุชูุฒุน ุฏุฑูุงู:\n")
        print(table(df$treatment))
        cat("  ุชูุฒุน ูุฑุญูู ุจูุงุฑ:\n")
        print(table(df$stage))
        cat("\n")
        
        cat("๐ฏ ูุชุงุฌ ุฑฺฏุฑุณูู ฺฉุงฺฉุณ:\n")
        cat("  ุขูุงุฑู -2LogLikelihood:", round(-2 * cox_summary$loglik[1], 3), "\n")
        cat("  ุขูุงุฑู ุขุฒููู ูุฏู:", round(cox_summary$waldtest[3], 3), "\n")
        cat("  p-value ูุฏู:", format.pval(cox_summary$waldtest[4], digits = 3), "\n\n")
        
        cat("๐ ุฌุฏูู ูุณุจุชโูุง ุฎุทุฑ:\n")
        results_df <- data.frame(
          Variable = rownames(cox_summary$coefficients),
          HR = round(cox_summary$coefficients[, 2], 3),
          CI_95 = paste0("[", 
                         round(cox_summary$conf.int[, 3], 3), "-", 
                         round(cox_summary$conf.int[, 4], 3), "]"),
          p_value = format.pval(cox_summary$coefficients[, 5], digits = 3)
        )
        print(results_df)
        
        cat("\n๐ ุจุฑุฑุณ ูพุดโูุฑุถ ุฎุทุฑุงุช ูุชูุงุณุจ:\n")
        ph_test <- cox.zph(cox_model)
        cat("  ุขุฒููู ุดุงูพุฑู ุจุฑุง ุฎุทุฑุงุช ูุชูุงุณุจ:\n")
        print(ph_test)
        
        cat("\n๐ก ุชูุณุฑ:\n")
        cat("  ุณู: ุจุง ูุฑ 10 ุณุงู ุงูุฒุงุด ุณูุ ุฎุทุฑ ูุฑฺฏ", 
            ifelse(cox_summary$coefficients["age", 2] > 1, "ุงูุฒุงุด", "ฺฉุงูุด"),
            "ูโุงุจุฏ (HR =", round(cox_summary$coefficients["age", 2], 3), ")\n")
        
        cat("  ุฏุฑูุงู: ุฏุฑูุงู ุฌุฏุฏ ูุณุจุช ุจู ุฏุฑูุงู ูุฏู",
            ifelse(cox_summary$coefficients["treatmentุฌุฏุฏ", 2] < 1, "ฺฉุงูุด", "ุงูุฒุงุด"),
            "ุฎุทุฑ ูุฑฺฏ ุฏุงุฑุฏ (HR =", round(cox_summary$coefficients["treatmentุฌุฏุฏ", 2], 3), ")\n")
      })
    })
    
    # ุฌุฏูู ุฎูุงุตู ุฑูุดโูุง ุชุญูู ุจูุง
    output$survival_methods_table <- renderTable({
      data.frame(
        "ุฑูุด" = c("ฺฉุงูพูุงู-ูุงุฑ", "ุขุฒููู ูฺฏุฑุงูฺฉ", "ุฑฺฏุฑุณูู ฺฉุงฺฉุณ", "ูุฏูโูุง ูพุงุฑุงูุชุฑฺฉ"),
        "ููุน" = c("ูุงูพุงุฑุงูุชุฑ", "ูุงูพุงุฑุงูุชุฑ", "ููู ูพุงุฑุงูุชุฑ", "ูพุงุฑุงูุชุฑ"),
        "ูุฏู" = c("ุชุฎูู ุชุงุจุน ุจูุง", "ููุงุณู ููุญูโูุง ุจูุง", "ุจุฑุฑุณ ุนูุงูู ุฎุทุฑ", "ูุฏูโุณุงุฒ ุชุงุจุน ุฎุทุฑ"),
        "ุฏุงุฏูโูุง ุณุงูุณูุฑ ุดุฏู" = c("ูพุดุชุจุงู ูโฺฉูุฏ", "ูพุดุชุจุงู ูโฺฉูุฏ", "ูพุดุชุจุงู ูโฺฉูุฏ", "ูพุดุชุจุงู ูโฺฉูุฏ"),
        "ูุชุบุฑูุง ูุณุชูู" = c("ูุฏุงุฑุฏ", "ูุฏุงุฑุฏ", "ฺูุฏ ูุชุบุฑู", "ฺูุฏ ูุชุบุฑู")
      )
    }, striped = TRUE, hover = TRUE, bordered = TRUE, align = 'c')
    
  })
}

# ุงุฌุฑุง ุจุฑูุงูู
shinyApp(ui = ui, server = server)
